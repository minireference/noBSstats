
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Section 5.1 — Introduction to Bayesian statistics &#8212; No Bullshit Guide to Statistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/notebooks/51_intro_to_Bayesian_stats';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="No Bullshit Guide to Statistics - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="No Bullshit Guide to Statistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    No Bullshit Guide to Statistics
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/10_DATA.html">Chapter 1 — Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/11_intro_to_data.html">Section 1.1 — Introduction to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/12_data_in_practice.html">Section 1.2 — Data in practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/13_descriptive_statistics.html">Section 1.3 — Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_13_descr_stats.html">Descriptive statistics exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/20_PROB.html">Chapter 2 — Probability theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/21_discrete_random_vars.html">Section 2.1 — Discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/22_multiple_random_vars.html">Section 2.2 — Multiple random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/23_inventory_discrete_dists.html">Section 2.3 — Inventory of discrete distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/24_continuous_random_vars.html">Section 2.4 — Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/25_multiple_continuous_random_vars.html">Section 2.5 — Multiple continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/26_inventory_continuous_dists.html">Section 2.6 — Inventory of continuous distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/27_simulations.html">Section 2.7 — Simulation and empirical distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/28_random_samples.html">Section 2.8 — Probability models for random samples</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/30_STATS.html">Chapter 3 — Classical statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/31_estimators.html">Section 3.1 — Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_31_estimtors.html">Exercises for Section 3.1 Estimates and estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/32_confidence_intervals.html">Section 3.2 — Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_32_confidence_intervals.html">Exercises for Section 3.2 Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/33_intro_to_NHST.html">Section 3.3 — Introduction to hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/34_analytical_approx.html">Section 3.4 — Hypothesis testing using analytical approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/35_two_sample_tests.html">Section 3.5 — Two-sample hypothesis tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/36_design.html">Section 3.6 — Statistical design and error analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/37_inventory_stats_tests.html">Section 3.7 — Inventory of statistical tests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/README.html">Statistical analysis examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/statistical_design.html">Statistical design examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/one_sample_z-test.html">One-sample z-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/one_sample_t-test.html">One-sample t-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/two_sample_t-test.html">Welch’s two-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/ANOVA.html">Analysis of variance (ANOVA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/two_sample_equivalence_test.html">Two-sample equivalence test</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/40_LINEAR_MODELS.html">Chapter 4 — Linear models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/41_simple_linear_regression.html">Section 4.1 — Simple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/42_multiple_linear_regression.html">Section 4.2 — Multiple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/43_interpreting_linear_models.html">Section 4.3 — Interpreting linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/44_regression_with_categorical_predictors.html">Section 4.4 — Regression with categorical predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/45_causal_inference.html">Section 4.5 — Model selection for causal inference</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/46_generalized_linear_models.html">Section 4.6 — Generalized linear models</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/50_BAYESIAN_STATS.html">Chapter 5 — Bayesian statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/51_intro_to_Bayesian_stats.html">Section 5.1 — Introduction to Bayesian statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/52_Bayesian_inference_computations.html">Section 5.2 — Bayesian inference computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/53_Bayesian_linear_models.html">Section 5.3 — Bayesian linear models</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/54_difference_between_means.html">Section 5.4 — Bayesian difference between means</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/55_hierarchical_models.html">Section 5.5 — Hierarchical models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/appendix.html">Appendix</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/python_tutorial.html">Appendix C — Python tutorial</a></li>












<li class="toctree-l2"><a class="reference internal" href="../../tutorials/pandas_tutorial.html">Appendix D — Pandas tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/seaborn_tutorial.html">Appendix E — Seaborn tutorial</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../tutorials/calculus_tutorial.html">Appendix F — Calculus tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../reading_group/info.html">noBSstats Reading Group</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../blogposts/index.html">Blog posts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/python_for_stats.html">Using Python for learning statistics Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/probability_models.html">Using Python for probability calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/sampling_distributions.html">Sampling distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/bootstrap.html">Bootstrap estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/simulation_hypothesis_tests.html">Hypothesis testing using simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/permutation_test.html">Permutation tests for comparing two groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/stats_procedures.html">Python libraries for doing statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/python_stats_libraries.html">Python libraries for doing statistics</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/minireference/noBSstats/main?urlpath=lab/tree/./docs/notebooks/51_intro_to_Bayesian_stats.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/minireference/noBSstats" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/minireference/noBSstats/issues/new?title=Issue%20on%20page%20%2Fdocs/notebooks/51_intro_to_Bayesian_stats.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/notebooks/51_intro_to_Bayesian_stats.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Section 5.1 — Introduction to Bayesian statistics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-model-and-likelihood-function">Data model and likelihood function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-distributions">Parameters distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-model">Bayesian model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-posterior-distribution">Calculating the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference-results">Bayesian inference results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-posterior">Visualizing the posterior</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-estimates">Point estimates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-credible-interval">Bayesian credible interval</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-predictions">Bayesian predictions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-hypothesis-testing">Bayesian hypothesis testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference">Bayesian inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-updating-of-posterior-probabilities">Bayesian updating of posterior probabilities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-approximation">Grid approximation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-estimating-the-probability-of-a-biased-coin">Example 1: estimating the probability of a biased coin</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-a-grid-of-possible-parameter-values">Step 1: define a grid of possible parameter values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-define-a-flat-prior-distribution">Step 2: define a flat prior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-the-likelihood">Step 3: compute the likelihood</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-the-numerator-in-bayes-formula">Step 4: calculate the numerator in Bayes’ formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-normalize-to-obtain-the-posterior-distribution">Step 5: normalize to obtain the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualizing the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-the-posterior">Summarize the posterior</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-mean">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-standard-deviation">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-median">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-quartiles">Posterior quartiles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-percentiles">Posterior percentiles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-mode">Posterior mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credible-interval">Credible interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-posterior-updates-over-time">Visualizing the posterior updates over time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-estimating-the-iq-score">Example 2: estimating the IQ score</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-a-grid-of-possible-values-of-the-mean">Step 1: define a grid of possible values of the mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-define-the-prior-for-the-unknown-mean">Step 2: define the prior for the unknown mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-the-likelihood-of-the-data">Step 3: compute the likelihood of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-4-calculate-the-numerator-in-bayes-rule-formula">Steps 4: calculate the numerator in Bayes’ rule formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-5-normalize-to-obtain-the-posterior-distribution">Steps 5: normalize to obtain the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Visualizing the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Summarize the posterior</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Posterior mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credible-interval-for-the-mean">Credible interval for the mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-approximation-details">Grid approximation details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-priors">Choosing priors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Bayesian predictions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicting-future-coin-tosses">Predicting future coin tosses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicting-iq-scores">Predicting IQ scores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Bayesian hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-credible-intervals-for-decisions">Using credible intervals for decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#region-of-practical-equivalence">Region of practical equivalence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test">Hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-model-comparison">Bayesian model comparison</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-factors">Bayes factors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test-1-using-a-point-null-and-cauchy-on-effect-size">Test 1: using a point null and Cauchy on effect size</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test-2-using-the-default-jeffrey-zellner-siow-jzs-prior">Test 2: using the default Jeffrey-Zellner-Siow (JZS) prior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-a-posteriori-estimates">Maximum a posteriori estimates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-bayesian-and-frequentist-approaches-to-statistical-inference">Comparing Bayesian and frequentist approaches to statistical inference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strengths-and-weaknesses-of-bayesian-approach">Strengths and weaknesses of Bayesian approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-from-the-posterior-bonus-topic">Sampling from the posterior (BONUS TOPIC)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Credible interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-campaign-conversions">Exercise 1: campaign conversions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-apply-bayes-rule-for-a-diagnostic-test">Exercise 2: apply Bayes rule for a diagnostic test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-algae">Exercise: algae</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="section-5-1-introduction-to-bayesian-statistics">
<h1>Section 5.1 — Introduction to Bayesian statistics<a class="headerlink" href="#section-5-1-introduction-to-bayesian-statistics" title="Link to this heading">#</a></h1>
<p>This notebook contains the code examples from <a class="reference internal" href="#"><span class="xref myst">Section 5.1 Introduction to Bayesian statistics</span></a> from the <strong>No Bullshit Guide to Statistics</strong>.</p>
<section id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure required Python modules are installed</span>
<span class="o">%</span><span class="k">pip</span> install --quiet numpy scipy seaborn statsmodels bambi ministats
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">26.0</span> -&gt; <span class=" -Color -Color-Green">26.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Python modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figures setup</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c1"># needed otherwise `sns.set_theme` doesn&#39;t work</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span>
    <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font.family&quot;</span><span class="p">:</span> <span class="s2">&quot;serif&quot;</span><span class="p">,</span>
        <span class="s2">&quot;font.serif&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Palatino&quot;</span><span class="p">,</span> <span class="s2">&quot;DejaVu Serif&quot;</span><span class="p">,</span> <span class="s2">&quot;serif&quot;</span><span class="p">],</span>
        <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)},</span>
<span class="p">)</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &quot;retina&quot;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple float __repr__  </span>
<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.25&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<section id="data-model-and-likelihood-function">
<h3>Data model and likelihood function<a class="headerlink" href="#data-model-and-likelihood-function" title="Link to this heading">#</a></h3>
</section>
<section id="parameters-distributions">
<h3>Parameters distributions<a class="headerlink" href="#parameters-distributions" title="Link to this heading">#</a></h3>
</section>
<section id="bayesian-model">
<h3>Bayesian model<a class="headerlink" href="#bayesian-model" title="Link to this heading">#</a></h3>
</section>
<section id="calculating-the-posterior-distribution">
<h3>Calculating the posterior distribution<a class="headerlink" href="#calculating-the-posterior-distribution" title="Link to this heading">#</a></h3>
</section>
<section id="bayesian-inference-results">
<h3>Bayesian inference results<a class="headerlink" href="#bayesian-inference-results" title="Link to this heading">#</a></h3>
<section id="visualizing-the-posterior">
<h4>Visualizing the posterior<a class="headerlink" href="#visualizing-the-posterior" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats.plots.figures</span><span class="w"> </span><span class="kn">import</span> <span class="n">posterior_visualization</span>
<span class="n">posterior_visualization</span><span class="p">(</span><span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/0d3c42eed4adc0b06aea1b7f605195b14071461eb11086c96c6becdf226a3b6f.png"><img alt="../../_images/0d3c42eed4adc0b06aea1b7f605195b14071461eb11086c96c6becdf226a3b6f.png" src="../../_images/0d3c42eed4adc0b06aea1b7f605195b14071461eb11086c96c6becdf226a3b6f.png" style="width: 537px; height: 254px;" />
</a>
</div>
</div>
</section>
<section id="point-estimates">
<h4>Point estimates<a class="headerlink" href="#point-estimates" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>posterior mean</p></li>
<li><p>posterior median</p></li>
<li><p>posterior mode</p></li>
</ul>
</section>
<section id="bayesian-credible-interval">
<h4>Bayesian credible interval<a class="headerlink" href="#bayesian-credible-interval" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((1-\alpha)\)</span> high density interval</p></li>
</ul>
</section>
<section id="bayesian-predictions">
<h4>Bayesian predictions<a class="headerlink" href="#bayesian-predictions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>draws form the posterior predictive distribution</p></li>
</ul>
</section>
<section id="bayesian-hypothesis-testing">
<h4>Bayesian hypothesis testing<a class="headerlink" href="#bayesian-hypothesis-testing" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
</section>
</section>
<section id="bayesian-inference">
<h2>Bayesian inference<a class="headerlink" href="#bayesian-inference" title="Link to this heading">#</a></h2>
<p>TODO: add explanations and formulas</p>
<section id="bayesian-updating-of-posterior-probabilities">
<h3>Bayesian updating of posterior probabilities<a class="headerlink" href="#bayesian-updating-of-posterior-probabilities" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats.plots.figures</span><span class="w"> </span><span class="kn">import</span> <span class="n">prior_times_likelihood_eq_posterior</span>
<span class="n">prior_times_likelihood_eq_posterior</span><span class="p">(</span><span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/654c898aaa8e1de1597270be61b03373da4582c47748785a8971cf12a375d68c.png"><img alt="../../_images/654c898aaa8e1de1597270be61b03373da4582c47748785a8971cf12a375d68c.png" src="../../_images/654c898aaa8e1de1597270be61b03373da4582c47748785a8971cf12a375d68c.png" style="width: 459px; height: 447px;" />
</a>
</div>
</div>
</section>
<section id="grid-approximation">
<h3>Grid approximation<a class="headerlink" href="#grid-approximation" title="Link to this heading">#</a></h3>
<p>TODO: add explanations and formulas</p>
<p>TODO: add steps</p>
<p>Pseudocode:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">prior_rv</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># specify the prior distribtion</span>
<span class="n">model</span> <span class="o">=</span> <span class="o">...</span>    <span class="c1"># specify the data model</span>

<span class="c1"># 1. Define the grid of possible parameter values</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="c1"># 2. Evaluate the prior distribution for all thetas</span>
<span class="n">prior</span> <span class="o">=</span> <span class="p">[</span><span class="n">prior_rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="c1"># 3. Compute the likelihood of the data for all thetas</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="c1"># 4. Calculate the numerator in Bayes&#39; formula</span>
<span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">prior</span><span class="p">)</span>

<span class="c1"># 5. Normalize to obtain the posterior distribution</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numerator</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats.plots.figures</span><span class="w"> </span><span class="kn">import</span> <span class="n">prior_times_likelihood_eq_posterior_grid</span>
<span class="n">prior_times_likelihood_eq_posterior_grid</span><span class="p">(</span><span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/dd3c6585aaa8c7282133dd4aa756a069536cf53f10d2ed5c50b2a5273554e646.png"><img alt="../../_images/dd3c6585aaa8c7282133dd4aa756a069536cf53f10d2ed5c50b2a5273554e646.png" src="../../_images/dd3c6585aaa8c7282133dd4aa756a069536cf53f10d2ed5c50b2a5273554e646.png" style="width: 460px; height: 452px;" />
</a>
</div>
</div>
</section>
</section>
<section id="example-1-estimating-the-probability-of-a-biased-coin">
<h2>Example 1: estimating the probability of a biased coin<a class="headerlink" href="#example-1-estimating-the-probability-of-a-biased-coin" title="Link to this heading">#</a></h2>
<p>Suppose we’re given a biased coin
and we want to estimate the probability the coin turns up heads.</p>
<section id="data">
<h3>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h3>
<p>We have a sample <span class="math notranslate nohighlight">\(\mathbf{c} = \texttt{ctosses}\)</span> that contains <span class="math notranslate nohighlight">\(n=50\)</span> observations (coin tosses) from the coin.
The outcome <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to heads,
while the outcome <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to tails.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctosses</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
           <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
           <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">sum</span><span class="p">(</span><span class="n">ctosses</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ctosses</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ctosses</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ctosses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(34, 50, 0.68)
</pre></div>
</div>
</div>
</div>
</section>
<section id="model">
<h3>Model<a class="headerlink" href="#model" title="Link to this heading">#</a></h3>
<p>The Bayesian model for the coin tosses is
describe by the Bernoulli distribution with a uniform prior on the parameter:</p>
<div class="math notranslate nohighlight">
\[
    C \sim \textrm{Bernoulli}(P),
    \qquad
    P \sim \mathcal{U}(0,1).
    \qquad
\]</div>
<p>To estimate the parameter <span class="math notranslate nohighlight">\(P\)</span>,
we’ll use the Bayesian inference
following the five-step grid approximation procedure.</p>
</section>
<section id="step-1-define-a-grid-of-possible-parameter-values">
<h3>Step 1: define a grid of possible parameter values<a class="headerlink" href="#step-1-define-a-grid-of-possible-parameter-values" title="Link to this heading">#</a></h3>
<p>We start by defining a grid for the  possible values for the parameter <span class="math notranslate nohighlight">\(P\)</span>.
We’ll cover the interval from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(1\)</span> using a grid with 100 steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ngrid1</span> <span class="o">=</span> <span class="mi">101</span>             <span class="c1"># number of points in the grid</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ngrid1</span><span class="p">)</span> <span class="c1"># [0, 0.01, ..., 1.0]</span>
<span class="n">ps</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.  , 0.01, 0.02, 0.03, 0.04])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-define-a-flat-prior-distribution">
<h3>Step 2: define a flat prior distribution<a class="headerlink" href="#step-2-define-a-flat-prior-distribution" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">uniform</span>
<span class="n">prior1</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<span class="n">prior1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 1., 1., 1., 1.])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-compute-the-likelihood">
<h3>Step 3: compute the likelihood<a class="headerlink" href="#step-3-compute-the-likelihood" title="Link to this heading">#</a></h3>
<p>Next we want to compute the likelihood of the data <span class="math notranslate nohighlight">\(\tt{ctosses} = \mathbf{c} = [c_1,c_2,\ldots,c_{50}]\)</span>
according to the model <span class="math notranslate nohighlight">\(f_{C|P}(c|p) = p^c(1-p)^{1-c}\)</span>.</p>
<p>Recall that the likelihood function is the product of the probabilities
for individual observations</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  L_{\mathbf{c}}(p) 
    &amp;= f_{C|P}(c_1|p) \, f_{C|P}(c_2|p)  \, \cdots  \, f_{C|P}(c_{50}|p)  \\
    &amp;= p^{c_1}(1-p)^{1-{c_1}}  \,  p^{c_2}(1-p)^{1-{c_2}} \cdots \, p^{c_{50}} (1-p)^{1-c_{50}}  \\
    &amp;= p^{\sum_i^n c_i} (1-p)^{n-\sum_i^n c_i} \\
    &amp;= p^{y} (1-p)^{n-y},
\end{align*}\]</div>
<p>where we have defined <span class="math notranslate nohighlight">\(y = \sum_i^n c_i\)</span> the total number of heads in the data <span class="math notranslate nohighlight">\(\tt{ctosses} = \mathbf{c}\)</span>.</p>
<p>We can use now use this formula to calculate the likelihood of the data
for all the values of the parameters <span class="math notranslate nohighlight">\(P\)</span> in the grid <code class="docutils literal notranslate"><span class="pre">ps</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ctosses</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ctosses</span><span class="p">)</span>
<span class="n">likelihood1</span> <span class="o">=</span> <span class="n">ps</span><span class="o">**</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">ps</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="n">likelihood1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00000000e+00, 3.39578753e-23, 8.88178420e-16, 1.31559767e-14,
       0.00000000e+00])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-calculate-the-numerator-in-bayes-formula">
<h3>Step 4: calculate the numerator in Bayes’ formula<a class="headerlink" href="#step-4-calculate-the-numerator-in-bayes-formula" title="Link to this heading">#</a></h3>
<p>Next we multiply the likelihood and the prior to obtain the numerator of the Bayes’ rule formula.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerator1</span> <span class="o">=</span> <span class="n">likelihood1</span> <span class="o">*</span> <span class="n">prior1</span>

<span class="n">numerator1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00000000e+00, 3.39578753e-23, 8.88178420e-16, 1.31559767e-14,
       0.00000000e+00])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-normalize-to-obtain-the-posterior-distribution">
<h3>Step 5: normalize to obtain the posterior distribution<a class="headerlink" href="#step-5-normalize-to-obtain-the-posterior-distribution" title="Link to this heading">#</a></h3>
<p>The final step is to make sure the posterior is a valid probability distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">posterior1</span> <span class="o">=</span> <span class="n">numerator1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numerator1</span><span class="p">)</span>

<span class="n">posterior1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00000000e+00, 8.52710007e-11, 2.23028862e-03, 3.30357328e-02,
       0.00000000e+00])
</pre></div>
</div>
</div>
</div>
<p>We can verify that the sum of the values in the array <code class="docutils literal notranslate"><span class="pre">posterior1</span></code> is <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">posterior1</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Visualizing the posterior<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">posterior1d</span> <span class="o">=</span> <span class="n">posterior1</span> <span class="o">/</span> <span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">posterior1d</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ps</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">prior1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/f043e7ad56504341864cdc5262219bdaab4ee671013ca65b87bfcbda0edc1718.png"><img alt="../../_images/f043e7ad56504341864cdc5262219bdaab4ee671013ca65b87bfcbda0edc1718.png" src="../../_images/f043e7ad56504341864cdc5262219bdaab4ee671013ca65b87bfcbda0edc1718.png" style="width: 426px; height: 274px;" />
</a>
</div>
</div>
</section>
<section id="summarize-the-posterior">
<h3>Summarize the posterior<a class="headerlink" href="#summarize-the-posterior" title="Link to this heading">#</a></h3>
<section id="posterior-mean">
<h4>Posterior mean<a class="headerlink" href="#posterior-mean" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postmu1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ps</span> <span class="o">*</span> <span class="n">posterior1</span><span class="p">)</span>
<span class="n">postmu1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.673076923076923
</pre></div>
</div>
</div>
</div>
</section>
<section id="posterior-standard-deviation">
<h4>Posterior standard deviation<a class="headerlink" href="#posterior-standard-deviation" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poststd1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">ps</span><span class="o">-</span><span class="n">postmu1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">posterior1</span><span class="p">))</span>
<span class="n">poststd1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.06443431329777005
</pre></div>
</div>
</div>
</div>
</section>
<section id="posterior-median">
<h4>Posterior median<a class="headerlink" href="#posterior-median" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumsum1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">posterior1</span><span class="p">)</span>
<span class="n">idxMed</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ps</span><span class="p">[</span><span class="n">idxMed</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.68
</pre></div>
</div>
</div>
</div>
</section>
<section id="posterior-quartiles">
<h4>Posterior quartiles<a class="headerlink" href="#posterior-quartiles" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idxQ1</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">idxQ2</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">idxQ3</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">ps</span><span class="p">[</span><span class="n">idxQ1</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="n">idxQ2</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="n">idxQ3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.63, 0.68, 0.72)
</pre></div>
</div>
</div>
</div>
</section>
<section id="posterior-percentiles">
<h4>Posterior percentiles<a class="headerlink" href="#posterior-percentiles" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idxP03</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.03</span><span class="p">)</span>
<span class="n">idxP97</span> <span class="o">=</span> <span class="n">cumsum1</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.97</span><span class="p">)</span>
<span class="n">ps</span><span class="p">[</span><span class="n">idxP03</span><span class="p">],</span> <span class="n">ps</span><span class="p">[</span><span class="n">idxP97</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.55, 0.79)
</pre></div>
</div>
</div>
</div>
</section>
<section id="posterior-mode">
<h4>Posterior mode<a class="headerlink" href="#posterior-mode" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">posterior1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.68
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="credible-interval">
<h3>Credible interval<a class="headerlink" href="#credible-interval" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">hdi_from_grid</span>
<span class="n">hdi_from_grid</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">posterior1</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.54, 0.76]
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-posterior-updates-over-time">
<h3>Visualizing the posterior updates over time<a class="headerlink" href="#visualizing-the-posterior-updates-over-time" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats.plots.figures</span><span class="w"> </span><span class="kn">import</span> <span class="n">panel_coin_posteriors</span>
<span class="n">panel_coin_posteriors</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/40634dc2ac93319ade4251b25a52656c0d7f510ffe88719bd1e06ed2f2352e58.png"><img alt="../../_images/40634dc2ac93319ade4251b25a52656c0d7f510ffe88719bd1e06ed2f2352e58.png" src="../../_images/40634dc2ac93319ade4251b25a52656c0d7f510ffe88719bd1e06ed2f2352e58.png" style="width: 528px; height: 542px;" />
</a>
</div>
</div>
</section>
</section>
<section id="example-2-estimating-the-iq-score">
<h2>Example 2: estimating the IQ score<a class="headerlink" href="#example-2-estimating-the-iq-score" title="Link to this heading">#</a></h2>
<p>Suppose we’re investigating the effect of a new smart drug.
We give the drug to a sample of <span class="math notranslate nohighlight">\(30\)</span> individuals who are representative of the population,
then make them take an IQ test.</p>
<section id="id2">
<h3>Data<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>We have a sample of <span class="math notranslate nohighlight">\(n=30\)</span> IQ measurements from people who took the smart drug.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iqs</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">82.6</span><span class="p">,</span> <span class="mf">105.5</span><span class="p">,</span>  <span class="mf">96.7</span><span class="p">,</span>  <span class="mf">84.0</span><span class="p">,</span> <span class="mf">127.2</span><span class="p">,</span>  <span class="mf">98.8</span><span class="p">,</span>  <span class="mf">94.3</span><span class="p">,</span>
       <span class="mf">122.1</span><span class="p">,</span>  <span class="mf">86.8</span><span class="p">,</span>  <span class="mf">86.1</span><span class="p">,</span> <span class="mf">107.9</span><span class="p">,</span> <span class="mf">118.9</span><span class="p">,</span> <span class="mf">116.5</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">,</span>
        <span class="mf">91.0</span><span class="p">,</span> <span class="mf">130.0</span><span class="p">,</span> <span class="mf">155.7</span><span class="p">,</span> <span class="mf">120.8</span><span class="p">,</span> <span class="mf">107.9</span><span class="p">,</span> <span class="mf">117.1</span><span class="p">,</span> <span class="mf">100.1</span><span class="p">,</span>
       <span class="mf">108.2</span><span class="p">,</span>  <span class="mf">99.8</span><span class="p">,</span> <span class="mf">103.6</span><span class="p">,</span> <span class="mf">108.1</span><span class="p">,</span> <span class="mf">110.3</span><span class="p">,</span> <span class="mf">101.8</span><span class="p">,</span> <span class="mf">131.7</span><span class="p">,</span>
       <span class="mf">103.8</span><span class="p">,</span> <span class="mf">116.4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>Model<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>We will use the following Bayesian model:</p>
<div class="math notranslate nohighlight">
\[
    X \sim \mathcal{N}(M, \sigma=15),
    \qquad
    M \sim \mathcal{N}(\mu_M=100,\sigma_M=40).
\]</div>
<p>We place a broad prior on the mean parameter <span class="math notranslate nohighlight">\(M\)</span>,
by choosing a large value for the standard deviation <span class="math notranslate nohighlight">\(\sigma_M\)</span>.
We assume the IQ scores come from a population with known standard deviation <span class="math notranslate nohighlight">\(\sigma = 15\)</span>.</p>
</section>
<section id="step-1-define-a-grid-of-possible-values-of-the-mean">
<h3>Step 1: define a grid of possible values of the mean<a class="headerlink" href="#step-1-define-a-grid-of-possible-values-of-the-mean" title="Link to this heading">#</a></h3>
<p>This time we’ll use a finer grid with 1000 steps.
The parameter space for the mean of a normal distribution is infinite <span class="math notranslate nohighlight">\((-\infty, \infty)\)</span>,
so we can’t define a grid that covers the whole parameter space.
Instead,
we’ll define a grid that cover only the most likely values for the mean,
which is a window of <span class="math notranslate nohighlight">\(\pm 20\)</span> around the mean of the wider population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ngrid2</span> <span class="o">=</span> <span class="mi">1001</span>  <span class="c1"># number of points in the grid</span>
<span class="n">mus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="n">ngrid2</span><span class="p">)</span>
<span class="n">mus</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([80.  , 80.04, 80.08, 80.12, 80.16])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-define-the-prior-for-the-unknown-mean">
<h3>Step 2: define the prior for the unknown mean<a class="headerlink" href="#step-2-define-the-prior-for-the-unknown-mean" title="Link to this heading">#</a></h3>
<p>We define a normal distribution centered at <span class="math notranslate nohighlight">\(\mu_M=100\)</span> with standard deviation <span class="math notranslate nohighlight">\(\sigma_M=40\)</span>,
then evaluate it for each point in the grid <code class="docutils literal notranslate"><span class="pre">mus</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="n">mu_M</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sigma_M</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">prior2</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu_M</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma_M</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mus</span><span class="p">)</span>

<span class="n">prior2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1001</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00880163, 0.00977607, 0.00992381, 0.00920675])
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-compute-the-likelihood-of-the-data">
<h3>Step 3: compute the likelihood of the data<a class="headerlink" href="#step-3-compute-the-likelihood-of-the-data" title="Link to this heading">#</a></h3>
<p>TODO: show formula</p>
<p>TODO: explain iterative calculation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># known population standard deviation</span>

<span class="n">likelihood2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ngrid2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iq</span> <span class="ow">in</span> <span class="n">iqs</span><span class="p">:</span>
    <span class="n">likelihood_iq</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mus</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iq</span><span class="p">)</span>
    <span class="n">likelihood2</span> <span class="o">=</span> <span class="n">likelihood2</span> <span class="o">*</span> <span class="n">likelihood_iq</span>

<span class="n">likelihood2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1001</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.23613569e-77, 1.80497559e-62, 1.20898934e-55, 3.71466415e-57])
</pre></div>
</div>
</div>
</div>
</section>
<section id="steps-4-calculate-the-numerator-in-bayes-rule-formula">
<h3>Steps 4: calculate the numerator in Bayes’ rule formula<a class="headerlink" href="#steps-4-calculate-the-numerator-in-bayes-rule-formula" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerator2</span> <span class="o">=</span> <span class="n">likelihood2</span> <span class="o">*</span> <span class="n">prior2</span>

<span class="n">numerator2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1001</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.08800129e-79, 1.76455630e-64, 1.19977849e-57, 3.41999972e-59])
</pre></div>
</div>
</div>
</div>
</section>
<section id="steps-5-normalize-to-obtain-the-posterior-distribution">
<h3>Steps 5: normalize to obtain the posterior distribution<a class="headerlink" href="#steps-5-normalize-to-obtain-the-posterior-distribution" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">posterior2</span> <span class="o">=</span> <span class="n">numerator2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numerator2</span><span class="p">)</span>

<span class="n">posterior2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1001</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2.02698373e-25, 3.28742893e-10, 2.23522850e-03, 6.37157683e-05])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Visualizing the posterior<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">posterior2d</span> <span class="o">=</span> <span class="n">posterior2</span> <span class="o">/</span> <span class="p">(</span><span class="n">mus</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mus</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mus</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">posterior2d</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;posterior&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mus</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">prior2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prior&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/eda4854ea458bb6239113116d7bcacf1e94c2399d54c03dd987f09cc79491090.png"><img alt="../../_images/eda4854ea458bb6239113116d7bcacf1e94c2399d54c03dd987f09cc79491090.png" src="../../_images/eda4854ea458bb6239113116d7bcacf1e94c2399d54c03dd987f09cc79491090.png" style="width: 446px; height: 274px;" />
</a>
</div>
</div>
</section>
<section id="id5">
<h3>Summarize the posterior<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<section id="id6">
<h4>Posterior mean<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postmu2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mus</span> <span class="o">*</span> <span class="n">posterior2</span><span class="p">)</span>
<span class="n">postmu2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107.78678422532585
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h4>Posterior standard deviation<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poststd2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">mus</span><span class="o">-</span><span class="n">postmu2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">posterior2</span><span class="p">))</span>
<span class="n">poststd2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.7321084402431834
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4>Posterior median<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumsum2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">posterior2</span><span class="p">)</span>
<span class="n">mus</span><span class="p">[</span><span class="n">cumsum2</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107.8
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4>Posterior mode<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mus</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">posterior2</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107.8
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="credible-interval-for-the-mean">
<h3>Credible interval for the mean<a class="headerlink" href="#credible-interval-for-the-mean" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">hdi_from_grid</span>
<span class="n">hdi_from_grid</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">posterior2</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[103.16, 112.16]
</pre></div>
</div>
</div>
</div>
<p>Let’s compare the Bayesian credible interval to the frequentist confidence interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ci_mean</span>
<span class="n">ci_mean</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[102.83429390645762, 112.81237276020906]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="explanations">
<h2>Explanations<a class="headerlink" href="#explanations" title="Link to this heading">#</a></h2>
<section id="grid-approximation-details">
<h3>Grid approximation details<a class="headerlink" href="#grid-approximation-details" title="Link to this heading">#</a></h3>
</section>
<section id="choosing-priors">
<h3>Choosing priors<a class="headerlink" href="#choosing-priors" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: move this code to `ministats.bayes`</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">hdi_from_grid</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_post_mean_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">prior_rv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ngrid</span><span class="o">=</span><span class="mi">10001</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">70</span><span class="p">,</span><span class="mi">130</span><span class="p">],</span>
                       <span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;hdi90&quot;</span><span class="p">]):</span>
    <span class="n">mus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlims</span><span class="p">,</span> <span class="n">ngrid</span><span class="p">)</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">prior_rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mus</span><span class="p">)</span>
    <span class="n">likelihoodsM</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mus</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">likelihoodsM</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>
    <span class="n">posterior</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numerator</span><span class="p">)</span> 

    <span class="c1"># compute stats</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="s2">&quot;mean&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">post_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mus</span> <span class="o">*</span> <span class="n">posterior</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;post mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">post_mean</span>
    <span class="k">if</span> <span class="s2">&quot;median&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
        <span class="n">post_median</span> <span class="o">=</span> <span class="n">mus</span><span class="p">[</span><span class="n">cumsum</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)]</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;post median&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">post_median</span>
    <span class="k">if</span> <span class="s2">&quot;mode&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">post_mode</span> <span class="o">=</span> <span class="n">mus</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">posterior</span><span class="p">)]</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;post mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">post_mode</span>
    <span class="k">if</span> <span class="s2">&quot;hdi90&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">hdi90</span> <span class="o">=</span> <span class="n">hdi_from_grid</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;hdi90&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">hdi90</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">hdi90</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
    <span class="k">if</span> <span class="s2">&quot;prob_lt_100&quot;</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">:</span>
        <span class="n">idx100</span> <span class="o">=</span> <span class="n">mus</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">prob_lt_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">posterior</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx100</span><span class="p">])</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;prob_lt_100&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob_lt_100</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># frequentist summary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ci_mean</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">iqs</span><span class="p">),</span> <span class="n">ci_mean</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(107.82333333333334, [102.83429390645762, 112.81237276020906])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: move this code to `ministats.book.figures`</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_pdf</span>

<span class="n">priors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="c1"># varying mu_M</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>  <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="c1"># varying sigma_M</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_label</span><span class="p">(</span><span class="n">prior</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prior</span><span class="o">.</span><span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">])</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prior</span><span class="o">.</span><span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;$\mathcal</span><span class="si">{N}</span><span class="s2">(&quot;</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">+</span> <span class="s2">&quot;)$&quot;</span>


<span class="n">linestyles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="s2">&quot;dotted&quot;</span><span class="p">,</span> <span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]</span>
<span class="n">xlims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span><span class="mi">120</span><span class="p">]</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:(</span><span class="mf">6.5</span><span class="p">,</span><span class="mf">2.6</span><span class="p">)}):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">prior</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">priors</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="n">linestyles</span><span class="p">):</span>
        <span class="n">plot_pdf</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">get_label</span><span class="p">(</span><span class="n">prior</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">prior</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">priors</span><span class="p">[</span><span class="mi">7</span><span class="p">:],</span> <span class="n">linestyles</span><span class="p">):</span>
        <span class="n">plot_pdf</span><span class="p">(</span><span class="n">prior</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">get_label</span><span class="p">(</span><span class="n">prior</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_M$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(a) Diffuse priors&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu$&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(b) Concentrated priors&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/51402b286aeb9b719f1e29f160282239a913a33c109e82a6bb41d01201567ddc.png"><img alt="../../_images/51402b286aeb9b719f1e29f160282239a913a33c109e82a6bb41d01201567ddc.png" src="../../_images/51402b286aeb9b719f1e29f160282239a913a33c109e82a6bb41d01201567ddc.png" style="width: 583px; height: 281px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: move this code to `ministats.book.tables`</span>

<span class="n">results_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">prior</span> <span class="ow">in</span> <span class="n">priors</span><span class="p">:</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">get_post_mean_stats</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">prior_rv</span><span class="o">=</span><span class="n">prior</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">prior</span><span class="o">.</span><span class="n">kwds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hdi90&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hdi90&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;hdi90&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)]</span>
    <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
    <span class="n">results_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results_list</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="s2">&quot;post mean&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;post median&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;post mode&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;prob_lt_100&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="n">results</span>
<span class="c1"># print(results.to_latex(index=False,formatters=[lambda x: &quot;$&quot; + str(x) + &quot;$&quot;]*7))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>scale</th>
      <th>post mean</th>
      <th>post median</th>
      <th>post mode</th>
      <th>hdi90</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>40</td>
      <td>107.79</td>
      <td>107.79</td>
      <td>107.79</td>
      <td>[103.19, 112.19]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80</td>
      <td>40</td>
      <td>107.69</td>
      <td>107.69</td>
      <td>107.69</td>
      <td>[103.1, 112.09]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50</td>
      <td>40</td>
      <td>107.55</td>
      <td>107.55</td>
      <td>107.55</td>
      <td>[102.96, 111.95]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>40</td>
      <td>107.32</td>
      <td>107.32</td>
      <td>107.32</td>
      <td>[102.72, 111.72]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100</td>
      <td>30</td>
      <td>107.76</td>
      <td>107.76</td>
      <td>107.76</td>
      <td>[103.19, 112.16]</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100</td>
      <td>20</td>
      <td>107.68</td>
      <td>107.68</td>
      <td>107.68</td>
      <td>[103.16, 112.08]</td>
    </tr>
    <tr>
      <th>6</th>
      <td>100</td>
      <td>10</td>
      <td>107.28</td>
      <td>107.28</td>
      <td>107.28</td>
      <td>[102.86, 111.56]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>100</td>
      <td>5</td>
      <td>106.02</td>
      <td>106.02</td>
      <td>106.02</td>
      <td>[102.05, 109.95]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>100</td>
      <td>3</td>
      <td>104.27</td>
      <td>104.27</td>
      <td>104.27</td>
      <td>[100.92, 107.58]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>100</td>
      <td>1</td>
      <td>100.92</td>
      <td>100.92</td>
      <td>100.92</td>
      <td>[99.32, 102.41]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="id10">
<h2>Bayesian predictions<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<section id="predicting-future-coin-tosses">
<h3>Predicting future coin tosses<a class="headerlink" href="#predicting-future-coin-tosses" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bernoulli</span>

<span class="n">ctoss_preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">p_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posterior1</span><span class="p">)</span>
    <span class="n">ctoss_pred</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_post</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ctoss_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctoss_pred</span><span class="p">)</span>
<span class="n">ctoss_preds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1]
</pre></div>
</div>
</div>
</div>
</section>
<section id="predicting-iq-scores">
<h3>Predicting IQ scores<a class="headerlink" href="#predicting-iq-scores" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># known population standard deviation</span>

<span class="n">iq_preds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">mu_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posterior2</span><span class="p">)</span>
    <span class="n">iq_pred</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu_post</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">iq_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iq_pred</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">iq_preds</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 89.64, 110.31, 112.65, 121.25,  92.55, 132.49,  98.97])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id11">
<h2>Bayesian hypothesis testing<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>Suppose we want to evaluate whether the IQ data measurements <code class="docutils literal notranslate"><span class="pre">iqs</span></code>
comes from a population with a mean <span class="math notranslate nohighlight">\(\mu_0=100\)</span> or not,
which corresponds to the null hypothesis (the smart drug was not effective).</p>
<section id="using-credible-intervals-for-decisions">
<h3>Using credible intervals for decisions<a class="headerlink" href="#using-credible-intervals-for-decisions" title="Link to this heading">#</a></h3>
<p>Consider the null hypothesis <span class="math notranslate nohighlight">\(H_0: \mu=100\)</span>.
We can informally reject this hypothesis,
since the value <span class="math notranslate nohighlight">\(\mu=100\)</span> is outside the 90% credible interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdi95</span> <span class="o">=</span> <span class="n">hdi_from_grid</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">posterior2</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">hdi95</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[102.32, 113.03999999999999]
</pre></div>
</div>
</div>
</div>
</section>
<section id="region-of-practical-equivalence">
<h3>Region of practical equivalence<a class="headerlink" href="#region-of-practical-equivalence" title="Link to this heading">#</a></h3>
<p>We can also compute the total probability of in the posterior that falls within
the region of practical equivalence (ROPE) <span class="math notranslate nohighlight">\([97,103]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu97</span> <span class="o">=</span> <span class="n">mus</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="n">mu103</span> <span class="o">=</span> <span class="n">mus</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">posterior2</span><span class="p">[</span><span class="n">mu97</span><span class="p">:</span><span class="n">mu103</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.040481237454239115
</pre></div>
</div>
</div>
</div>
</section>
<section id="hypothesis-test">
<h3>Hypothesis test<a class="headerlink" href="#hypothesis-test" title="Link to this heading">#</a></h3>
<p>We see the probability of <span class="math notranslate nohighlight">\(\mu=100\)</span> or smaller is around <span class="math notranslate nohighlight">\(0.21\%\)</span>,
which gives us reason to reject <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<p>This conclusion is consistent with the conclusion of the frequentist one-sample <span class="math notranslate nohighlight">\(t\)</span>-test,
which leads us to reject <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ttest_1samp</span>
<span class="n">tt_res</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;greater&quot;</span><span class="p">)</span>
<span class="n">tt_res</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">tt_res</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.664408108831371, 0.006232014580899188)
</pre></div>
</div>
</div>
</div>
</section>
<section id="bayesian-model-comparison">
<h3>Bayesian model comparison<a class="headerlink" href="#bayesian-model-comparison" title="Link to this heading">#</a></h3>
<p>In Bayesian model comparison,
we want compare the <em>posterior probability distributions</em> of two models:</p>
<p>The null hypothesis is <span class="math notranslate nohighlight">\(H_0: \mu = \mu_0 = 100\)</span>
while the alternative hypothesis <span class="math notranslate nohighlight">\(H_1: \mu \neq 100\)</span>.
Actually,
we need to be more specific and show the full Bayesian model under each distribution:</p>
<p>Under H0</p>
<p>…</p>
<p>Under H1</p>
<p>…</p>
</section>
<section id="bayes-factors">
<h3>Bayes factors<a class="headerlink" href="#bayes-factors" title="Link to this heading">#</a></h3>
<p>TODO: show formulas</p>
<section id="test-1-using-a-point-null-and-cauchy-on-effect-size">
<h4>Test 1: using a point null and Cauchy on effect size<a class="headerlink" href="#test-1-using-a-point-null-and-cauchy-on-effect-size" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># under H0 = point-prior at mu=100</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="n">sigma</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># known population standard deviation</span>
<span class="n">mlikelihood_H0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iqs</span><span class="p">))</span>
<span class="n">mlikelihood_H0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.415023175654287e-57
</pre></div>
</div>
</div>
</div>
<p>We’ll set a prior on the effect size <span class="math notranslate nohighlight">\(\Delta = \mu / \sigma\)</span>,
using the Cauchy distribution (very fat tails).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">cauchy</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># scale for the Cauchy prior</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">cauchy</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">r</span><span class="p">),</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/fd92743b8488cd81481d8ba898955dab7f073b2d045ade70dcdb6530383de309.png"><img alt="../../_images/fd92743b8488cd81481d8ba898955dab7f073b2d045ade70dcdb6530383de309.png" src="../../_images/fd92743b8488cd81481d8ba898955dab7f073b2d045ade70dcdb6530383de309.png" style="width: 466px; height: 293px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>

<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># scale for the Cauchy prior</span>
<span class="n">prior_delta</span> <span class="o">=</span> <span class="n">cauchy</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
<span class="n">delta_max</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrand</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
    <span class="c1"># Convert delta into the mean under H1: mu = 100 + delta * sigma</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">sigma</span>
    <span class="c1"># Likelihood as the product of normal densities for each observation</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iqs</span><span class="p">))</span>
    <span class="n">prior</span> <span class="o">=</span> <span class="n">cauchy</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>

<span class="n">mlikelihood_HA</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="o">-</span><span class="n">delta_max</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mlikelihood_HA</span><span class="p">)</span>

<span class="n">simple_BF_A0</span> <span class="o">=</span> <span class="n">mlikelihood_HA</span> <span class="o">/</span> <span class="n">mlikelihood_H0</span>
<span class="n">simple_BF_A0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.6473613657219223e-56
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.735633897413964
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mugrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>

<span class="c1"># under HA = diffuse prior</span>
<span class="n">deltas</span> <span class="o">=</span> <span class="p">(</span><span class="n">mugrid</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>

<span class="n">prior_rv</span> <span class="o">=</span> <span class="n">cauchy</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">r</span><span class="p">)</span> 
<span class="n">prior</span> <span class="o">=</span> <span class="n">prior_rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">deltas</span><span class="p">)</span>
<span class="n">norm_const</span> <span class="o">=</span> <span class="n">prior_rv</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="n">prior_rv</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">prior</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm_const</span>

<span class="n">likelihood_HA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mugrid</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iqs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mlikelihood_HA_alt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">likelihood_HA</span> <span class="o">*</span> <span class="n">prior</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mlikelihood_HA_alt</span><span class="p">)</span>

<span class="n">simple_BF_A0_alt</span> <span class="o">=</span> <span class="n">mlikelihood_HA_alt</span> <span class="o">/</span> <span class="n">mlikelihood_H0</span>
<span class="n">simple_BF_A0_alt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.649465841847485e-56
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.7395202632840565
</pre></div>
</div>
</div>
</div>
</section>
<section id="test-2-using-the-default-jeffrey-zellner-siow-jzs-prior">
<h4>Test 2: using the default Jeffrey-Zellner-Siow (JZS) prior<a class="headerlink" href="#test-2-using-the-default-jeffrey-zellner-siow-jzs-prior" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
  H_0: \mu = 100,
  \qquad
  H_A: \frac{\mu - 100}{\sigma} \sim \textrm{Cauchy}(r),
  \sigma \sim \textrm{Jeffreys}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: move this code to `ministats.bayes`</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cauchy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>

<span class="c1"># finite integration limits to avoid `np.inf`</span>
<span class="n">simgma_max</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">delta_max</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Known mean under H0</span>
<span class="n">mu_0</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Scale parameter under H1</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">0.707</span>  <span class="c1"># scale for the Cauchy prior</span>


<span class="c1"># Define the marginal likelihood under H0 using Jeffreys prior for sigma</span>
<span class="k">def</span><span class="w"> </span><span class="nf">marginal_likelihood_H0</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Marginal likelihood under H0 with Jeffreys prior for sigma.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">integrand</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
        <span class="c1"># Likelihood as the product of normal densities for each observation</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu_0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">))</span>
        <span class="c1"># ALT.</span>
        <span class="c1"># likelihood = np.prod([norm.pdf(iq, loc=mu_0, scale=sigma) for iq in iqs])</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sigma</span>  <span class="c1"># Jeffrey&#39;s prior for sigma</span>
        <span class="k">return</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>

    <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">simgma_max</span><span class="p">)</span> <span class="c1"># limit=1000)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">m0</span> <span class="o">=</span> <span class="n">marginal_likelihood_H0</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">)</span>
<span class="c1"># print(m0)</span>


<span class="c1"># Define the marginal likelihood under H1, integrating over delta and sigma</span>
<span class="k">def</span><span class="w"> </span><span class="nf">marginal_likelihood_HA</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Marginal likelihood under H1 integrating over delta and sigma.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">integrand</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="c1"># Convert delta into the mean under H1: mu = mu_0 + delta * sigma</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_0</span> <span class="o">+</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">sigma</span>
        <span class="c1"># Likelihood as the product of normal densities for each observation</span>
        <span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">))</span>
        <span class="c1"># ALT.</span>
        <span class="c1"># likelihood = np.prod([norm.pdf(iq, loc=mu, scale=sigma) for iq in iqs])</span>
        <span class="n">prior_delta</span> <span class="o">=</span> <span class="n">cauchy</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
        <span class="n">prior_sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sigma</span>  <span class="c1"># Jeffrey&#39;s prior for sigma</span>
        <span class="k">return</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior_delta</span> <span class="o">*</span> <span class="n">prior_sigma</span>

    <span class="c1"># Inner integral sigma for a given delta</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">integrate_delta</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">integrand</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">simgma_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Outer integral over delta</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrate_delta</span><span class="p">,</span> <span class="o">-</span><span class="n">delta_max</span><span class="p">,</span> <span class="n">delta_max</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">mA</span> <span class="o">=</span> <span class="n">marginal_likelihood_HA</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">mu_0</span><span class="p">)</span>
<span class="c1"># print(mA)</span>

<span class="c1"># Compute the Bayes factor</span>
<span class="n">BF_A0</span> <span class="o">=</span> <span class="n">mA</span> <span class="o">/</span> <span class="n">m0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bayes Factor (BF_A0): </span><span class="si">{</span><span class="n">BF_A0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bayes Factor (BF_A0): 3.7201507341577424
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bayes factor (based on JZS prior)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pingouin</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pg</span>
<span class="n">pg</span><span class="o">.</span><span class="n">ttest</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;T-test&quot;</span><span class="p">,</span><span class="s2">&quot;BF10&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;3.74&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ALT. Bayes factor (based on JZS prior)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iqs</span><span class="p">)</span>
<span class="n">tstat</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">iqs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">pg</span><span class="o">.</span><span class="n">bayesfactor_ttest</span><span class="p">(</span><span class="n">tstat</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.7397058298821895
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: sensitivity analysis</span>
<span class="c1"># plot BF for multiple values of r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare to the frequentist result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ttest_1samp</span>
<span class="n">ttest_1samp</span><span class="p">(</span><span class="n">iqs</span><span class="p">,</span> <span class="n">popmean</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=2.664408108831371, pvalue=0.012464029161798377, df=29)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h2>
<section id="maximum-a-posteriori-estimates">
<h3>Maximum a posteriori estimates<a class="headerlink" href="#maximum-a-posteriori-estimates" title="Link to this heading">#</a></h3>
</section>
<section id="comparing-bayesian-and-frequentist-approaches-to-statistical-inference">
<h3>Comparing Bayesian and frequentist approaches to statistical inference<a class="headerlink" href="#comparing-bayesian-and-frequentist-approaches-to-statistical-inference" title="Link to this heading">#</a></h3>
</section>
<section id="strengths-and-weaknesses-of-bayesian-approach">
<h3>Strengths and weaknesses of Bayesian approach<a class="headerlink" href="#strengths-and-weaknesses-of-bayesian-approach" title="Link to this heading">#</a></h3>
</section>
<section id="sampling-from-the-posterior-bonus-topic">
<h3>Sampling from the posterior (BONUS TOPIC)<a class="headerlink" href="#sampling-from-the-posterior-bonus-topic" title="Link to this heading">#</a></h3>
<p>We’ll now show how to analyze the Bayesian analysis
when the posterior distribution
is available in the form of samples.
This will be the form of analysis in all the future sections of the chapter,
so I thought I can give you a little preview.</p>
<p>We start by generating some samples from the posterior distribution
we obtained in Example 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">postM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">posterior2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">postM</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/5440ff06d0035c8a0c36ff5081264fedd7596951346feff7f8c291763e8f7735.png"><img alt="../../_images/5440ff06d0035c8a0c36ff5081264fedd7596951346feff7f8c291763e8f7735.png" src="../../_images/5440ff06d0035c8a0c36ff5081264fedd7596951346feff7f8c291763e8f7735.png" style="width: 465px; height: 274px;" />
</a>
</div>
</div>
<section id="id12">
<h4>Posterior mean<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<p>To compute the mean of the posterior,
we compute the mean  of the samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">postMmu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">postM</span><span class="p">)</span>
<span class="n">postMmu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107.73182
</pre></div>
</div>
</div>
</div>
<p>In the next seciton,
we’ll also learn about the ArviZ library,
which is a Swiss Army knife for for summarizing, visualizing, and plotting the Bayesian analysis results.
For example,
we can obtain the mean using the <code class="docutils literal notranslate"><span class="pre">summary</span></code> function from the ArviZ library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">arviz</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">az</span>
<span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">postM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;stats&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>107.732</td>
      <td>2.712</td>
      <td>102.76</td>
      <td>112.84</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The summary also includes the posterior standard deviation
and the limits of a “94% high density interval” that contains 94% of the posterior probability density.</p>
</section>
<section id="id13">
<h4>Posterior standard deviation<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<p>To compute the standard deviation of the posterior,
we compute the standard deviation of the samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">postM</span><span class="o">-</span><span class="n">postMmu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">postM</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.712109726320084
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h4>Posterior median<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<p>To compute the median of the posterior,
we compute the median of the samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">postM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>107.72
</pre></div>
</div>
</div>
</div>
<p>We can also obtain median using the ArviZ <code class="docutils literal notranslate"><span class="pre">summary</span></code> function,
if we specify the <code class="docutils literal notranslate"><span class="pre">stat_focus</span></code> option.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">postM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;stats&quot;</span><span class="p">,</span> <span class="n">stat_focus</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median</th>
      <th>mad</th>
      <th>eti_3%</th>
      <th>eti_97%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>107.72</td>
      <td>1.8</td>
      <td>102.68</td>
      <td>112.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id15">
<h4>Credible interval<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">hdi_from_samples</span>
<span class="n">hdi_from_samples</span><span class="p">(</span><span class="n">postM</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[103.28, 112.16]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">postM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;stats&quot;</span><span class="p">,</span> <span class="n">hdi_prob</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_5%</th>
      <th>hdi_95%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>107.732</td>
      <td>2.712</td>
      <td>103.28</td>
      <td>112.16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-1-campaign-conversions">
<h3>Exercise 1: campaign conversions<a class="headerlink" href="#exercise-1-campaign-conversions" title="Link to this heading">#</a></h3>
<p>See <a class="reference internal" href="#./explorations/bayesianprobabilitiesworkshop/Exercise%201.ipynb"><span class="xref myst">explorations/bayesianprobabilitiesworkshop/Exercise%201.ipynb</span></a></p>
<p>TODO: check this</p>
</section>
<section id="exercise-2-apply-bayes-rule-for-a-diagnostic-test">
<h3>Exercise 2: apply Bayes rule for a diagnostic test<a class="headerlink" href="#exercise-2-apply-bayes-rule-for-a-diagnostic-test" title="Link to this heading">#</a></h3>
<p>You have designed a new test for detecting lung cancer that has the following characteristics:</p>
<ul class="simple">
<li><p>Test gives a positive result <span class="math notranslate nohighlight">\(98\%\)</span> of the time when lung cancer is present.</p></li>
<li><p>Test gives a negative result <span class="math notranslate nohighlight">\(96\%\)</span> of the time when no lung cancer is present.</p></li>
</ul>
<p>You also know that that in the general population,
there is approximately one case of lung cancer per 1000 individuals.</p>
<p>Use Bayes rule to calculate the probability that a person who gets a positive test result has cancer,
and interpret the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data </span>
<span class="n">pC</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># prevalence </span>

<span class="n">pPgC</span> <span class="o">=</span> <span class="mf">0.98</span>   <span class="c1"># sensitivity</span>
<span class="n">pNgC</span> <span class="o">=</span> <span class="mf">0.02</span>   <span class="c1"># false-negatives</span>

<span class="n">pNgNC</span> <span class="o">=</span> <span class="mf">0.96</span>  <span class="c1"># specificity</span>
<span class="n">pPgNC</span> <span class="o">=</span> <span class="mf">0.04</span>  <span class="c1"># false-positives</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="c1"># Pr(P) = Pr(P|C)*Pr(C) + Pr(P|NC) * Pr(NC)</span>
<span class="n">pP</span>      <span class="o">=</span> <span class="n">pPgC</span>   <span class="o">*</span> <span class="n">pC</span>   <span class="o">+</span> <span class="n">pPgNC</span>    <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pC</span><span class="p">)</span>

<span class="c1"># Pr(C|P) = Pr(P|C) * Pr(C) / Pr(P)</span>
<span class="n">pCgP</span>      <span class="o">=</span> <span class="n">pPgC</span>    <span class="o">*</span> <span class="n">pC</span>    <span class="o">/</span> <span class="n">pP</span>
<span class="n">pCgP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02393746946751343
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">-</span> <span class="n">pCgP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9760625305324866
</pre></div>
</div>
</div>
</div>
<p>The above calculation tells us 97.6% of people who test positive don’t actually have cancer.
We shouldn’t be screening to the whole population, since that would lead to too many people getting scared for nothing.
See the visualization tool at <a class="reference external" href="https://sophieehill.shinyapps.io/base-rate-viz/">https://sophieehill.shinyapps.io/base-rate-viz/</a> to learn more about the base rate fallacy.</p>
</section>
<section id="exercise-algae">
<h3>Exercise: algae<a class="headerlink" href="#exercise-algae" title="Link to this heading">#</a></h3>
<p>see <a class="reference internal" href="#./explorations/BDA_course/assignment2/assignment2.qmd"><span class="xref myst">assignment2</span></a> from the BDA course</p>
<p>TODO</p>
</section>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">#</a></h2>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstats",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-model-and-likelihood-function">Data model and likelihood function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-distributions">Parameters distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-model">Bayesian model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-posterior-distribution">Calculating the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference-results">Bayesian inference results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-posterior">Visualizing the posterior</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-estimates">Point estimates</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-credible-interval">Bayesian credible interval</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-predictions">Bayesian predictions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-hypothesis-testing">Bayesian hypothesis testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference">Bayesian inference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-updating-of-posterior-probabilities">Bayesian updating of posterior probabilities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-approximation">Grid approximation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-estimating-the-probability-of-a-biased-coin">Example 1: estimating the probability of a biased coin</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-a-grid-of-possible-parameter-values">Step 1: define a grid of possible parameter values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-define-a-flat-prior-distribution">Step 2: define a flat prior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-the-likelihood">Step 3: compute the likelihood</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-calculate-the-numerator-in-bayes-formula">Step 4: calculate the numerator in Bayes’ formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-normalize-to-obtain-the-posterior-distribution">Step 5: normalize to obtain the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualizing the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-the-posterior">Summarize the posterior</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-mean">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-standard-deviation">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-median">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-quartiles">Posterior quartiles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-percentiles">Posterior percentiles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#posterior-mode">Posterior mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credible-interval">Credible interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-posterior-updates-over-time">Visualizing the posterior updates over time</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-estimating-the-iq-score">Example 2: estimating the IQ score</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-a-grid-of-possible-values-of-the-mean">Step 1: define a grid of possible values of the mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-define-the-prior-for-the-unknown-mean">Step 2: define the prior for the unknown mean</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compute-the-likelihood-of-the-data">Step 3: compute the likelihood of the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-4-calculate-the-numerator-in-bayes-rule-formula">Steps 4: calculate the numerator in Bayes’ rule formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-5-normalize-to-obtain-the-posterior-distribution">Steps 5: normalize to obtain the posterior distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Visualizing the posterior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Summarize the posterior</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Posterior mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#credible-interval-for-the-mean">Credible interval for the mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-approximation-details">Grid approximation details</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-priors">Choosing priors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Bayesian predictions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicting-future-coin-tosses">Predicting future coin tosses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicting-iq-scores">Predicting IQ scores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Bayesian hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-credible-intervals-for-decisions">Using credible intervals for decisions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#region-of-practical-equivalence">Region of practical equivalence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis-test">Hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-model-comparison">Bayesian model comparison</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayes-factors">Bayes factors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test-1-using-a-point-null-and-cauchy-on-effect-size">Test 1: using a point null and Cauchy on effect size</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#test-2-using-the-default-jeffrey-zellner-siow-jzs-prior">Test 2: using the default Jeffrey-Zellner-Siow (JZS) prior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-a-posteriori-estimates">Maximum a posteriori estimates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-bayesian-and-frequentist-approaches-to-statistical-inference">Comparing Bayesian and frequentist approaches to statistical inference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strengths-and-weaknesses-of-bayesian-approach">Strengths and weaknesses of Bayesian approach</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-from-the-posterior-bonus-topic">Sampling from the posterior (BONUS TOPIC)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Posterior mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Posterior standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Posterior median</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Credible interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-campaign-conversions">Exercise 1: campaign conversions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-apply-bayes-rule-for-a-diagnostic-test">Exercise 2: apply Bayes rule for a diagnostic test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-algae">Exercise: algae</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ivan Savov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>