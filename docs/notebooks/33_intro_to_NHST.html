
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Section 3.3 — Introduction to hypothesis testing &#8212; No Bullshit Guide to Statistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/notebooks/33_intro_to_NHST';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="No Bullshit Guide to Statistics - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="No Bullshit Guide to Statistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    No Bullshit Guide to Statistics
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/10_DATA.html">Chapter 1 — Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/11_intro_to_data.html">Section 1.1 — Introduction to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/12_data_in_practice.html">Section 1.2 — Data in practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/13_descriptive_statistics.html">Section 1.3 — Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_13_descr_stats.html">Descriptive statistics exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/20_PROB.html">Chapter 2 — Probability theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/21_discrete_random_vars.html">Section 2.1 — Discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/22_multiple_random_vars.html">Section 2.2 — Multiple random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/23_inventory_discrete_dists.html">Section 2.3 — Inventory of discrete distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/24_continuous_random_vars.html">Section 2.4 — Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/25_multiple_continuous_random_vars.html">Section 2.5 — Multiple continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/26_inventory_continuous_dists.html">Section 2.6 — Inventory of continuous distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/27_simulations.html">Section 2.7 — Simulation and empirical distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/28_random_samples.html">Section 2.8 — Probability models for random samples</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/30_STATS.html">Chapter 3 — Classical statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/31_estimators.html">Section 3.1 — Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_31_estimtors.html">Exercises for Section 3.1 Estimates and estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/32_confidence_intervals.html">Section 3.2 — Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exercises/exercises_32_confidence_intervals.html">Exercises for Section 3.2 Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/33_intro_to_NHST.html">Section 3.3 — Introduction to hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/34_analytical_approx.html">Section 3.4 — Hypothesis testing using analytical approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/35_two_sample_tests.html">Section 3.5 — Two-sample hypothesis tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/36_design.html">Section 3.6 — Statistical design and error analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/37_inventory_stats_tests.html">Section 3.7 — Inventory of statistical tests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/README.html">Statistical analysis examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/statistical_design.html">Statistical design examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/one_sample_z-test.html">One-sample z-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/one_sample_t-test.html">One-sample t-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/two_sample_t-test.html">Welch’s two-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/ANOVA.html">Analysis of variance (ANOVA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/two_sample_equivalence_test.html">Two-sample equivalence test</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/40_LINEAR_MODELS.html">Chapter 4 — Linear models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/41_simple_linear_regression.html">Section 4.1 — Simple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/42_multiple_linear_regression.html">Section 4.2 — Multiple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/43_interpreting_linear_models.html">Section 4.3 — Interpreting linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/44_regression_with_categorical_predictors.html">Section 4.4 — Regression with categorical predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/45_causal_inference.html">Section 4.5 — Model selection for causal inference</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/46_generalized_linear_models.html">Section 4.6 — Generalized linear models</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/50_BAYESIAN_STATS.html">Chapter 5 — Bayesian statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/51_intro_to_Bayesian_stats.html">Section 5.1 — Introduction to Bayesian statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/52_Bayesian_inference_computations.html">Section 5.2 — Bayesian inference computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/53_Bayesian_linear_models.html">Section 5.3 — Bayesian linear models</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/54_difference_between_means.html">Section 5.4 — Bayesian difference between means</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/55_hierarchical_models.html">Section 5.5 — Hierarchical models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/appendix.html">Appendix</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/python_tutorial.html">Appendix C — Python tutorial</a></li>












<li class="toctree-l2"><a class="reference internal" href="../../tutorials/pandas_tutorial.html">Appendix D — Pandas tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/seaborn_tutorial.html">Appendix E — Seaborn tutorial</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../tutorials/calculus_tutorial.html">Appendix F — Calculus tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../reading_group/info.html">noBSstats Reading Group</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../blogposts/index.html">Blog posts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/python_for_stats.html">Using Python for learning statistics Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/probability_models.html">Using Python for probability calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/sampling_distributions.html">Sampling distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/bootstrap.html">Bootstrap estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/simulation_hypothesis_tests.html">Hypothesis testing using simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/permutation_test.html">Permutation tests for comparing two groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/stats_procedures.html">Python libraries for doing statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blogposts/python_stats_libraries.html">Python libraries for doing statistics</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/minireference/noBSstats/main?urlpath=lab/tree/./docs/notebooks/33_intro_to_NHST.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/minireference/noBSstats" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/minireference/noBSstats/issues/new?title=Issue%20on%20page%20%2Fdocs/notebooks/33_intro_to_NHST.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/notebooks/33_intro_to_NHST.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Section 3.3 — Introduction to hypothesis testing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-hypothesis-testing">What is hypothesis testing?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypotheses">Hypotheses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-statistic">Test statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-test-statistic-under-h-0">Sampling distribution of the test statistic under <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-p-value">The p-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logic-of-hypothesis-testing">The logic of hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-the-hypothesis-testing-procedure">Overview of the hypothesis testing procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#court-trial-analogy">Court trial analogy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-result-of-a-hypothesis-test">Interpreting the result of a hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-size-estimates">Effect size estimates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-tests">Simulation tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-the-mean">Test for the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kombucha-bottling-process">Kombucha bottling process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computer-model-for-the-kombucha-volumes-under-h-0">Computer model for the kombucha volumes under <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-under-the-null">Sampling distribution of the mean under the null</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1s-test-for-the-mean-of-batch-04">Example 1S: test for the mean of Batch 04</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-under-the-null-hypothesis">Sampling distribution of the mean under the null hypothesis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Effect size estimates</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2s-test-for-the-mean-of-batch-01">Example 2S: test for the mean of Batch 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-the-variance">Test for the variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-variance-under-the-null">Sampling distribution of the variance under the null</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3s-test-for-the-variance-of-batch-02">Example 3S: test for the variance of Batch 02</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4s-test-for-the-variance-of-batch-08">Example 4S: test for the variance of Batch 08</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Effect size estimates</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-and-two-sided-tests">One-sided and two-sided tests</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-the-tails-of-a-distribution">Selecting the tails of a distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-p-value-calculation-example">One-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sided-p-value-calculation-example">Two-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-hypothesis-testing-procedure">Summary of the hypothesis testing procedure</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardized-effect-size">Standardized effect size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="section-3-3-introduction-to-hypothesis-testing">
<h1>Section 3.3 — Introduction to hypothesis testing<a class="headerlink" href="#section-3-3-introduction-to-hypothesis-testing" title="Link to this heading">#</a></h1>
<p>This notebook contains the code examples from <a class="reference internal" href="#"><span class="xref myst"><strong>Section 3.3 Introduction to hypothesis testing</strong></span></a> of the <strong>No Bullshit Guide to Statistics</strong>.</p>
<p>I highly recommend that you use the notebook interactively.
I’ve intentionally left empty code cells throughout the notebook,
which you can use to try some commands on your own.</p>
<section id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure required Python modules are installed</span>
<span class="o">%</span><span class="k">pip</span> install --quiet numpy scipy seaborn pandas ministats
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">26.0</span> -&gt; <span class=" -Color -Color-Green">26.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load Python modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot helper functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">nicebins</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figures setup</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>  <span class="c1"># needed otherwise `sns.set_theme` doesn&#39;t work</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span>
    <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font.family&quot;</span><span class="p">:</span> <span class="s2">&quot;serif&quot;</span><span class="p">,</span>
        <span class="s2">&quot;font.serif&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Palatino&quot;</span><span class="p">,</span> <span class="s2">&quot;DejaVu Serif&quot;</span><span class="p">,</span> <span class="s2">&quot;serif&quot;</span><span class="p">],</span>
        <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)},</span>
<span class="p">)</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple float __repr__  </span>
<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.25&#39;</span><span class="p">)</span>

<span class="c1"># set random seed for repeatability</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download datasets/ directory if necessary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ensure_datasets</span>
<span class="n">ensure_datasets</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datasets/ directory already exists.
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\def\stderr#1{\mathbf{se}_{#1}}\)</span>
<span class="math notranslate nohighlight">\(\def\stderrhat#1{\hat{\mathbf{se}}_{#1}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Mean}{\textbf{Mean}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Var}{\textbf{Var}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Std}{\textbf{Std}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Freq}{\textbf{Freq}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\RelFreq}{\textbf{RelFreq}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DMeans}{\textbf{DMeans}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Prop}{\textbf{Prop}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DProps}{\textbf{DProps}}\)</span></p>
<div class="math notranslate nohighlight">
\[
\newcommand{\CI}[1]{\textbf{CI}_{#1}}
\newcommand{\CIL}[1]{\textbf{L}_{#1}}
\newcommand{\CIU}[1]{\textbf{U}_{#1}}
\newcommand{\ci}[1]{\textbf{ci}_{#1}}
\newcommand{\cil}[1]{\textbf{l}_{#1}}
\newcommand{\ciu}[1]{\textbf{u}_{#1}}
\]</div>
<p>(this cell contains the macro definitions like <span class="math notranslate nohighlight">\(\stderr{\overline{\mathbf{x}}}\)</span>, <span class="math notranslate nohighlight">\(\stderrhat{}\)</span>, <span class="math notranslate nohighlight">\(\Mean\)</span>, …)</p>
</section>
<section id="what-is-hypothesis-testing">
<h2>What is hypothesis testing?<a class="headerlink" href="#what-is-hypothesis-testing" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>An approach to formulating research questions as <strong>yes-no decisions</strong> and a <strong>procedure for making these decisions</strong>.</p></li>
<li><p>Hypothesis testing is a standardized procedure for doing statistical analysis
(also uses stats jargon that makes everything look more convincing ;)</p></li>
</ul>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<section id="hypotheses">
<h3>Hypotheses<a class="headerlink" href="#hypotheses" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We formulate research question as two <strong>competing hypotheses</strong>:</p>
<ul>
<li><p><strong>Null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span></strong> = no effect.</p></li>
<li><p><strong>Alternative hypothesis <span class="math notranslate nohighlight">\(H_A\)</span></strong> = an effect exists.</p></li>
</ul>
</li>
</ul>
</section>
<section id="test-statistic">
<h3>Test statistic<a class="headerlink" href="#test-statistic" title="Link to this heading">#</a></h3>
<p>An estimator relevant for differentiating <span class="math notranslate nohighlight">\(H_0\)</span> from <span class="math notranslate nohighlight">\(H_A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">xbar</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">sumsqdevs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">xi</span><span class="o">-</span><span class="n">xbar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sumsqdevs</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sampling-distribution-of-the-test-statistic-under-h-0">
<h3>Sampling distribution of the test statistic under <span class="math notranslate nohighlight">\(H_0\)</span><a class="headerlink" href="#sampling-distribution-of-the-test-statistic-under-h-0" title="Link to this heading">#</a></h3>
</section>
<section id="the-p-value">
<h3>The p-value<a class="headerlink" href="#the-p-value" title="Link to this heading">#</a></h3>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-value is the probability of observing statistic (or more extreme) under the null hypothesis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thetas0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="n">obstheta</span> <span class="o">=</span> <span class="mi">4</span>             <span class="c1"># observed value (computed from sample)</span>
<span class="n">th0</span> <span class="o">=</span> <span class="mi">3</span>                  <span class="c1"># parameter under null</span>
<span class="n">obsdev</span> <span class="o">=</span> <span class="n">obstheta</span> <span class="o">-</span> <span class="n">th0</span>  <span class="c1"># obs deviation from null</span>

<span class="c1"># select the values in the tails of `thetas0`</span>
<span class="n">tails</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">thetas0</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="n">th0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">obsdev</span><span class="p">]</span>
<span class="c1">#######################################################</span>

<span class="c1"># compute the proportion in the tails</span>
<span class="c1"># = prob of observing &quot;obs or more extreme&quot; value under H0</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">thetas0</span><span class="p">)</span>
<span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6
</pre></div>
</div>
</div>
</div>
<p>The deviation from the parameter <code class="docutils literal notranslate"><span class="pre">theta0</span></code> of 60% of the values in the list <code class="docutils literal notranslate"><span class="pre">thetas0</span></code>
are equal to or more extreme than the deviation of the observed test statistic <span class="math notranslate nohighlight">\(\hat{\theta}_{\mathbf{x}} = \tt{obs}\)</span>
form the parameter <span class="math notranslate nohighlight">\(\theta_0 = \tt{th0}\)</span>.</p>
</section>
</section>
<section id="the-logic-of-hypothesis-testing">
<h2>The logic of hypothesis testing<a class="headerlink" href="#the-logic-of-hypothesis-testing" title="Link to this heading">#</a></h2>
<section id="overview-of-the-hypothesis-testing-procedure">
<h3>Overview of the hypothesis testing procedure<a class="headerlink" href="#overview-of-the-hypothesis-testing-procedure" title="Link to this heading">#</a></h3>
<p>Here is the high-level overview of the hypothesis testing procedure:</p>
<ul class="simple">
<li><p><strong>inputs</strong>: sample statistics computed from the observed data</p></li>
<li><p><strong>outputs</strong>: a decision that is one of: “reject the null hypothesis” or “fail to reject the null hypothesis”</p></li>
</ul>
<p><img alt="hypothesis testing overview" src="../../_images/intro_to_hypothesis_testing.png" /></p>
<p>In this notebook, we’ll use simulation to obtain the sampling distributions of the test statistic under the null hypothesis.</p>
</section>
<section id="court-trial-analogy">
<h3>Court trial analogy<a class="headerlink" href="#court-trial-analogy" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>defendant innocent &lt;-&gt; null hypothesis</p></li>
<li><p>found guilty &lt;-&gt; reject null</p></li>
<li><p>acquitted &lt;-&gt; fail to reject the null</p></li>
</ul>
</section>
<section id="interpreting-the-result-of-a-hypothesis-test">
<h3>Interpreting the result of a hypothesis test<a class="headerlink" href="#interpreting-the-result-of-a-hypothesis-test" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The implication of rejecting the null hypothesis is that there must be a difference between
the population from which the sample was taken <span class="math notranslate nohighlight">\(X \sim \mathcal{N}(\mu,\sigma)\)</span>
and the theoretical model <span class="math notranslate nohighlight">\(X_0 \sim \mathcal{N}(\mu_{X_0},\sigma_{X_0})\)</span>.</p>
<ul>
<li><p>Note that rejecting null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> is not the same as “proving” the alternative hypothesis <span class="math notranslate nohighlight">\(H_A\)</span> is true;
we have just shown that the data is unlikely to occur by chance under the null hypothesis.</p></li>
<li><p>Using statistics jargon, when we reject the hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> we say we’ve observed a “statistically significant” result,
which sounds a lot more impressive than it actually is.
The hypothesis testing procedure is just a simple check we perform to rule out the “occurred by chance” possibility.</p></li>
</ul>
</li>
<li><p>The implication of failing to reject the null hypothesis is that the observed sample could have occurred by chance under <span class="math notranslate nohighlight">\(H_0\)</span>,
so there is no need to search for an alternative hypothesis.
Note that “failing to reject <span class="math notranslate nohighlight">\(H_0\)</span>” is not the same as “proving” the null hypothesis.</p></li>
</ul>
<p>I know all this sounds super complicated and roundabout (an it is!),
but you will get a hang of it with practice.</p>
</section>
<section id="effect-size-estimates">
<h3>Effect size estimates<a class="headerlink" href="#effect-size-estimates" title="Link to this heading">#</a></h3>
<p>The <strong>effect size</strong> <span class="math notranslate nohighlight">\(\Delta\)</span> measures the <em>magnitude</em> of the deviation of the observed statistic
from the expected theoretical value.
For example,
in a test that compare the sample mean <span class="math notranslate nohighlight">\(\overline{\mathbf{x}}\)</span> to a theoretical mean <span class="math notranslate nohighlight">\(\mu_{X_0}\)</span>,
we can use <span class="math notranslate nohighlight">\(\Delta = \mu - \mu_{X_0}\)</span> to measure the deviation of the unknown mean <span class="math notranslate nohighlight">\(\mu\)</span> from the theoretical mean <span class="math notranslate nohighlight">\(\mu_{X_0}\)</span>.
We can obtain an effect size estimate by computing <span class="math notranslate nohighlight">\(\widehat{\Delta} = \overline{\mathbf{x}} - \mu_{X_0}\)</span>.</p>
<p>Another way to report effect size is to construct a <strong>confidence interval</strong>,
which takes into account the variability of the data.
A confidence interval tells us a range of values where we believe the true value of <span class="math notranslate nohighlight">\(\Delta\)</span> falls.
The functions <code class="docutils literal notranslate"><span class="pre">ci_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">ci_var</span></code> from the <code class="docutils literal notranslate"><span class="pre">ministats</span></code> module can help us with confidence interval calculations.</p>
</section>
</section>
<section id="simulation-tests">
<h2>Simulation tests<a class="headerlink" href="#simulation-tests" title="Link to this heading">#</a></h2>
<p>Let’s start with a description of the problem.
We want to compare a sample of observations from an unknown population to a <strong>fully specified theoretical model</strong>.</p>
<p>TODO: import from text</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gen_sampling_dist</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">estfunc</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate `N` samples of size `n` from the random variable `rv` to</span>
<span class="sd">    generate the sampling distribution of the estimator `estfunc`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">estimates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">estimate</span> <span class="o">=</span> <span class="n">estfunc</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">estimates</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="test-for-the-mean">
<h2>Test for the mean<a class="headerlink" href="#test-for-the-mean" title="Link to this heading">#</a></h2>
<p>We’ll now discuss hypothesis tests based on the sample mean.
We’re interested in distinguishing between the competing hypotheses:</p>
<div class="math notranslate nohighlight">
\[
    H_A: \mu \neq \mu_{X_0}
    \qquad \text{and} \qquad
    H_0: \mu = \mu_{X_0},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the mean of the unknown population <span class="math notranslate nohighlight">\(X \sim \mathcal{N}(\mu,\sigma)\)</span>
from which the sample <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> was taken,
and <span class="math notranslate nohighlight">\(\mu_{X_0}\)</span> is the mean of the theoretical model <span class="math notranslate nohighlight">\(X_0 \sim \mathcal{N}(\mu_{X_0}, \sigma_{X_0})\)</span>.</p>
<section id="kombucha-bottling-process">
<h3>Kombucha bottling process<a class="headerlink" href="#kombucha-bottling-process" title="Link to this heading">#</a></h3>
<p>We’ll use the kombucha scenario for all the examples in this section.
Recall, the probability distirbution of the kombucha volume is described by
the theoretical model <span class="math notranslate nohighlight">\(K_0 \sim \mathcal{N}(\mu_{K_0} = 1000, \sigma_{K_0}=10)\)</span>
when the production line is working as expected.</p>
<p>Since <span class="math notranslate nohighlight">\(\mu_{K_0}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{K_0}\)</span> are known,
we can use simulation to obtain the sampling distribution of any test statistic.</p>
</section>
<section id="computer-model-for-the-kombucha-volumes-under-h-0">
<h3>Computer model for the kombucha volumes under <span class="math notranslate nohighlight">\(H_0\)</span><a class="headerlink" href="#computer-model-for-the-kombucha-volumes-under-h-0" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># theoretical model for the kombucha volumes</span>
<span class="n">muK0</span> <span class="o">=</span> <span class="mi">1000</span>   <span class="c1"># theoretical mean</span>
<span class="n">sigmaK0</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># theoretical standard deviation</span>

<span class="n">rvK0</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">muK0</span><span class="p">,</span> <span class="n">sigmaK0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s look at a random sample of size <span class="math notranslate nohighlight">\(n=40\)</span> from the distribution under the null hypothesis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rvK0</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1004.97,  998.62, 1006.48, 1015.23,  997.66,  997.66, 1015.79,
       1007.67,  995.31, 1005.43,  995.37,  995.34, 1002.42,  980.87,
        982.75,  994.38,  989.87, 1003.14,  990.92,  985.88, 1014.66,
        997.74, 1000.68,  985.75,  994.56, 1001.11,  988.49, 1003.76,
        993.99,  997.08,  993.98, 1018.52,  999.87,  989.42, 1008.23,
        987.79, 1002.09,  980.4 ,  986.72, 1001.97])
</pre></div>
</div>
</div>
</div>
<p>We can obtain the sampling distribution of the mean by repeatedly generating samples like this,
and computing the mean from each of them.</p>
</section>
<section id="sampling-distribution-of-the-mean-under-the-null">
<h3>Sampling distribution of the mean under the null<a class="headerlink" href="#sampling-distribution-of-the-mean-under-the-null" title="Link to this heading">#</a></h3>
<p>We can generate the sampling distribution of the mean <span class="math notranslate nohighlight">\(\overline{\mathbf{K}}_0\)</span>
by running a simulation using the helper function <code class="docutils literal notranslate"><span class="pre">gen_sampling_dist</span></code>.
We supply three parameters for the simulation:</p>
<ol class="arabic simple">
<li><p>the computer model under <span class="math notranslate nohighlight">\(H_0\)</span></p></li>
<li><p>the estimator function</p></li>
<li><p>the sample size</p></li>
</ol>
<p>In our case, 1. is <code class="docutils literal notranslate"><span class="pre">rvK0</span></code>, 2. is the function <code class="docutils literal notranslate"><span class="pre">mean</span></code>, and 3. <code class="docutils literal notranslate"><span class="pre">n=40</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_sampling_dist</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kbars40</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars40</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/f7b776b9d8b2290d478383a22b3079ae2441341983d2c6ec97f1e8d842a9505c.png"><img alt="../../_images/f7b776b9d8b2290d478383a22b3079ae2441341983d2c6ec97f1e8d842a9505c.png" src="../../_images/f7b776b9d8b2290d478383a22b3079ae2441341983d2c6ec97f1e8d842a9505c.png" style="width: 616px; height: 197px;" />
</a>
</div>
</div>
<p>The sampling distribution <span class="math notranslate nohighlight">\(\overline{\mathbf{K}}_0 = \tt{kbars40}\)</span>
tells us the variability of the sample means we can expect to observe when <span class="math notranslate nohighlight">\(H_0\)</span> is true.</p>
</section>
<section id="example-1s-test-for-the-mean-of-batch-04">
<h3>Example 1S: test for the mean of Batch 04<a class="headerlink" href="#example-1s-test-for-the-mean-of-batch-04" title="Link to this heading">#</a></h3>
<p>We want to check whether Batch~04 is “regular” or “irregular” by comparing the mean volume of this batch <span class="math notranslate nohighlight">\(\mu\)</span>
to the mean of the theoretical model <span class="math notranslate nohighlight">\(\mu_{K_0} = 1000\)</span>;ml.
We formulate the following competing hypotheses:</p>
<div class="math notranslate nohighlight">
\[
    H_A: \mu \neq \mu_{K_0}
    \qquad \text{and} \qquad
    H_0: \mu = \mu_{K_0}.
\]</div>
<p>In words,
the null hypothesis describes a regular batch,
where the mean of the batch is equal to the mean of the model <span class="math notranslate nohighlight">\(\mu_{K_0}=1000\)</span>.
The two-sided alternative hypothesis states that the mean volume of Batch~04 differs from the expected mean <span class="math notranslate nohighlight">\(\mu_{K_0}\)</span>,
and it includes both positive or negative deviations.</p>
<p>Let’s start by loading the sample <span class="math notranslate nohighlight">\(\mathbf{k}_{04}\)</span> from Batch 04 of the <code class="docutils literal notranslate"><span class="pre">kombucha</span></code> dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch04</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ksample04</span> <span class="o">=</span> <span class="n">batch04</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ksample04</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observed mean</span>
<span class="n">obsmean04</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ksample04</span><span class="p">)</span>
<span class="n">obsmean04</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1003.8335
</pre></div>
</div>
</div>
</div>
<p>The mean volume calculated from the sample <code class="docutils literal notranslate"><span class="pre">ksample04</span></code> is <span class="math notranslate nohighlight">\(3.83\)</span> ml higher than the expected mean <span class="math notranslate nohighlight">\(\mu_{K_0} = 1000\)</span> ml.
Is this a big difference or not?
How likely is such deviation to occur by chance under the null hypothesis?</p>
<section id="sampling-distribution-of-the-mean-under-the-null-hypothesis">
<h4>Sampling distribution of the mean under the null hypothesis<a class="headerlink" href="#sampling-distribution-of-the-mean-under-the-null-hypothesis" title="Link to this heading">#</a></h4>
<p>To answer the above question,
we need to know the sampling distribution of the mean
for samples of size <span class="math notranslate nohighlight">\(n=40\)</span> under the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> (which we just learned how to do above).</p>
<p>Let’s run the simulation based on the using the function <code class="docutils literal notranslate"><span class="pre">gen_sampling_dist</span></code> with parameters:</p>
<ol class="arabic simple">
<li><p>probability model <code class="docutils literal notranslate"><span class="pre">rvK0</span></code> <span class="math notranslate nohighlight">\(= K_0 \sim \mathcal{N}(\mu_{K_0}=1000,\sigma_{K_0}=10)\)</span></p></li>
<li><p>the estimator function <code class="docutils literal notranslate"><span class="pre">mean</span></code></p></li>
<li><p>the sample size <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">len(ksample04)</span> <span class="pre">=</span> <span class="pre">40</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_sampling_dist</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kbars40</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To calculate the <span class="math notranslate nohighlight">\(p\)</span>-value,
we want to count how many values of sampling distribution <code class="docutils literal notranslate"><span class="pre">kbars40</span></code>
are equal or more extreme than the observed value <span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04} =\)</span> <code class="docutils literal notranslate"><span class="pre">obsmean04</span></code> = 1003.8335.</p>
<p>In this context,
“<span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04}\)</span> or more extreme” means all values whose <em>deviation</em> from the mean <span class="math notranslate nohighlight">\(\mu_{K_0} = 1000\)</span>
is equal to or more extreme than the deviation of the observed mean <span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04}\)</span> from <span class="math notranslate nohighlight">\(\mu_{K_0}\)</span>.</p>
<p>Let’s start by computing the observed deviation <span class="math notranslate nohighlight">\(|\overline{\mathbf{k}}_{04} - \mu_{K_0}|\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsdev04</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obsmean04</span> <span class="o">-</span> <span class="n">muK0</span><span class="p">)</span>
<span class="n">obsdev04</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.833499999999958
</pre></div>
</div>
</div>
</div>
<p>Next we use the list-comprehension syntax to go through the list <code class="docutils literal notranslate"><span class="pre">kbars40</span></code>
and select only the values <code class="docutils literal notranslate"><span class="pre">v</span></code> whose absolute deviation from the mean <code class="docutils literal notranslate"><span class="pre">abs(v-muK0)</span></code>
is equal to or greater than the observe deviation <code class="docutils literal notranslate"><span class="pre">obsdev04</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tails</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kbars40</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="n">muK0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">obsdev04</span><span class="p">]</span>
<span class="n">tails</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1004.786610717458, 995.7701787502498, 995.8232443556451]
</pre></div>
</div>
</div>
</div>
<p>The list <code class="docutils literal notranslate"><span class="pre">tails</span></code> contains the subset of the simulated means
that satisfy the “<span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04}\)</span> or more extreme” condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149
</pre></div>
</div>
</div>
</div>
<p>Out of the total of <span class="math notranslate nohighlight">\(N=10000\)</span> simulated samples under <span class="math notranslate nohighlight">\(H_0\)</span>,
only 149 satisfy this condition “<span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04}\)</span> or more extreme.”
That’s not a lot!</p>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-value is computed as  he number of observations in the tails,
divided by the total number of simulated observations.</p>
<p>TODO: mention proportion</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pvalue04</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kbars40</span><span class="p">)</span>
<span class="n">pvalue04</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0149
</pre></div>
</div>
</div>
</div>
<p>We can visualize the <span class="math notranslate nohighlight">\(p\)</span>-value calculation by plotting a histogram of sampling distribution <span class="math notranslate nohighlight">\(\overline{\mathbf{K}}_0\)</span>
and highlighting the parts of the histogram that satisfy the “<span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04}\)</span> or more extreme” condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the sampling distribution as a histogram</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars40</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># plot red line for the observed mean</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">obsmean04</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># plot the values that are equal or more extreme in red</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">tails</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/33789596fe14608c11d411a3079794d0e5f66253ac35751e0a96b05d5355052c.png"><img alt="../../_images/33789596fe14608c11d411a3079794d0e5f66253ac35751e0a96b05d5355052c.png" src="../../_images/33789596fe14608c11d411a3079794d0e5f66253ac35751e0a96b05d5355052c.png" style="width: 616px; height: 197px;" />
</a>
</div>
</div>
<p>Note the <span class="math notranslate nohighlight">\(p\)</span>-value calculation includes simulated observations in the left tail of the distribution:
<span class="math notranslate nohighlight">\(\{ \overline{\mathbf{K}}_0 \leq 996.17 \}\)</span>.
This is because the alternative hypothesis is stated as <span class="math notranslate nohighlight">\(\mu \neq \mu_{K_0}\)</span>,
so we must consider both positive and negative deviations.</p>
<p>We can now make the decision by comparing the <span class="math notranslate nohighlight">\(p\)</span>-value to the pre-determined threshold <span class="math notranslate nohighlight">\(\alpha\)</span>,
which is conventionally chosen <span class="math notranslate nohighlight">\(\alpha=0.05\)</span> (1 in 20).
The <span class="math notranslate nohighlight">\(p\)</span>-value is 0.015,
which means <span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04} = 1003.83\)</span> has only a 1.5% chance of occurring under the null hypothesis.
The <span class="math notranslate nohighlight">\(p\)</span>-value 0.015 tells us the observed mean <code class="docutils literal notranslate"><span class="pre">obsmean04</span></code> = 1003.8335
is very unlikely to occur by chance under <span class="math notranslate nohighlight">\(H_0\)</span>,
so our decision is to “reject the null hypothesis.”
In other words, Batch 04 is irregular.</p>
</section>
<section id="id1">
<h4>Effect size estimates<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>We were able to detect that Batch 04 differs from the expected distribution,
but how big is the deviation?
We can use the deviation from the expected mean <span class="math notranslate nohighlight">\(\widehat{\Delta} = \overline{\mathbf{k}}_{04} - \mu_{K_0}\)</span>
as an estimate of the effect size in this situation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">ksample04</span><span class="p">)</span> <span class="o">-</span> <span class="n">muK0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.833499999999958
</pre></div>
</div>
</div>
</div>
<p>The point estimate <span class="math notranslate nohighlight">\(\widehat{\Delta} = \overline{\mathbf{k}}_{04} - \mu_{K_0} = 3.83\)</span>
tells us how much the mean of the sample differs from the expected population mean <span class="math notranslate nohighlight">\(\mu_{K_0}\)</span>,
but it doesn’t tell us the uncertainty in this estimate.</p>
<p>Let’s calculate the 90% bootstrap confidence interval for the effect size  <span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^*\)</span>. First let’s obtain a 90% obtain a confidence interval <span class="math notranslate nohighlight">\(\ci{\mu,0.9}^*\)</span> for the unknown population mean <span class="math notranslate nohighlight">\(\mu\)</span>.
We can do this by calling the function <code class="docutils literal notranslate"><span class="pre">ci_mean</span></code> that we defined in Section 3.2
with the options <code class="docutils literal notranslate"><span class="pre">alpha=0.1</span></code> and <code class="docutils literal notranslate"><span class="pre">method=&quot;b&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ci_mean</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
<span class="n">cimu04</span> <span class="o">=</span> <span class="n">ci_mean</span><span class="p">(</span><span class="n">ksample04</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">cimu04</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1001.7537499999999, 1005.8020250000002]
</pre></div>
</div>
</div>
</div>
<p>We can now convert the confidence interval <span class="math notranslate nohighlight">\(\ci{\mu,0.9}^* =\)</span> <code class="docutils literal notranslate"><span class="pre">cimu04</span></code>
to a confidence interval for the effect size by
subtracting the theoretical mean from both limits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">cimu04</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">muK0</span><span class="p">,</span> <span class="n">cimu04</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">muK0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.7537499999998545, 5.802025000000185]
</pre></div>
</div>
</div>
</div>
<p>The confidence interval <span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^* = [1.75, 5.80]\)</span> tells us a range of plausible values for the true effect size (how irregular Batch 04 is) could be anywhere between 1.75ml and 5.8ml.
This is much more interesting to know,
since it tells us a whole range of plausible values.
The interval estimate <span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^* = [1.75, 5.80]\)</span> takes into account the variability of the samples we used in the calculation.</p>
</section>
</section>
<section id="example-2s-test-for-the-mean-of-batch-01">
<h3>Example 2S: test for the mean of Batch 01<a class="headerlink" href="#example-2s-test-for-the-mean-of-batch-01" title="Link to this heading">#</a></h3>
<p>Let’s repeat simulation test procedure on the sample <span class="math notranslate nohighlight">\(\mathbf{k}_{01}\)</span> which comes from Batch 01.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">batch01</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ksample01</span> <span class="o">=</span> <span class="n">batch01</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ksample01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsmean01</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ksample01</span><span class="p">)</span>
<span class="n">obsmean01</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>999.10375
</pre></div>
</div>
</div>
</div>
<p>We generate the sampling distribution of the mean for samples of size <span class="math notranslate nohighlight">\(n=40\)</span> under the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span> by running a simulation using the function <code class="docutils literal notranslate"><span class="pre">gen_sampling_dist</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kbars40</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we computed the observed deviation <code class="docutils literal notranslate"><span class="pre">obsdev01</span></code> <span class="math notranslate nohighlight">\(=|\overline{\mathbf{k}}_{01} - \mu_{K_0}|\)</span>,
then select the values in <code class="docutils literal notranslate"><span class="pre">kbars40</span></code> whose deviation from <span class="math notranslate nohighlight">\(\mu_{K_0}\)</span> is greater than the observed deviation,
and finally compute the <span class="math notranslate nohighlight">\(p\)</span>-value as the proportion of values in the tails.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsdev01</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obsmean01</span> <span class="o">-</span> <span class="n">muK0</span><span class="p">)</span>
<span class="n">tails</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kbars40</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="n">muK0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">obsdev01</span><span class="p">]</span>
<span class="n">pvalue01</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kbars40</span><span class="p">)</span>
<span class="n">pvalue01</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5711
</pre></div>
</div>
</div>
</div>
<p>The large <span class="math notranslate nohighlight">\(p\)</span>-value tells us that the observed mean <span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{01} = 999.10\)</span> is not unlikely under <span class="math notranslate nohighlight">\(H_0\)</span>.
Using the terminology of hypothesis testing,
we say the outcome of the hypothesis test is that we <em>failed to reject</em> <span class="math notranslate nohighlight">\(H_0: \mu = \mu_{K_0}\)</span>.
We have not seen any evidence that suggests that the mean of the population from
which sample <code class="docutils literal notranslate"><span class="pre">ksample01</span></code> was taken from differs from the mean of the theoretical model <span class="math notranslate nohighlight">\(K_0\)</span>.</p>
<p>In other words, Batch 01 is regular. Ship it!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">nicebins</span><span class="p">(</span><span class="n">kbars40</span><span class="p">,</span> <span class="n">obsmean01</span><span class="p">)</span>

<span class="c1"># plot the sampling distribution as a histogram</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars40</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

<span class="c1"># plot red line for the observed statistic</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">obsmean01</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># plot the values that are equal or more extreme in red</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">tails</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/4405c603b24f0e78977713450225186aaa54a6f2f7bcdeb5affa3db9006e6398.png"><img alt="../../_images/4405c603b24f0e78977713450225186aaa54a6f2f7bcdeb5affa3db9006e6398.png" src="../../_images/4405c603b24f0e78977713450225186aaa54a6f2f7bcdeb5affa3db9006e6398.png" style="width: 616px; height: 197px;" />
</a>
</div>
</div>
</section>
</section>
<section id="test-for-the-variance">
<h2>Test for the variance<a class="headerlink" href="#test-for-the-variance" title="Link to this heading">#</a></h2>
<section id="sampling-distribution-of-the-variance-under-the-null">
<h3>Sampling distribution of the variance under the null<a class="headerlink" href="#sampling-distribution-of-the-variance-under-the-null" title="Link to this heading">#</a></h3>
<p>We can generate the the sampling distribution of the variance <span class="math notranslate nohighlight">\(S^2_{\mathbf{K}_0}\)</span>
by calling the helper function <code class="docutils literal notranslate"><span class="pre">gen_sampling_dist</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_sampling_dist</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/1c160d754507bf942b27a1ff56638d3ae0442bbe4245586b7e1660c306d0a60e.png"><img alt="../../_images/1c160d754507bf942b27a1ff56638d3ae0442bbe4245586b7e1660c306d0a60e.png" src="../../_images/1c160d754507bf942b27a1ff56638d3ae0442bbe4245586b7e1660c306d0a60e.png" style="width: 616px; height: 197px;" />
</a>
</div>
</div>
</section>
<section id="example-3s-test-for-the-variance-of-batch-02">
<h3>Example 3S: test for the variance of Batch 02<a class="headerlink" href="#example-3s-test-for-the-variance-of-batch-02" title="Link to this heading">#</a></h3>
<p>The sample of volume measurements <span class="math notranslate nohighlight">\(\mathbf{k}_{02}\)</span> from the Batch 02 of the kombucha bottling plant comes from an unknown population with variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>,
which we can estimate by computing the sample variance <span class="math notranslate nohighlight">\(s^2_{\mathbf{k}_{02}}\)</span>.</p>
<p>We want to check whether Batch 02 is a “regular” or “irregular” by comparing the variance of this batch, <span class="math notranslate nohighlight">\(\sigma^2\)</span>, to the variance of the theoretical model <span class="math notranslate nohighlight">\(\sigma_{K_0}^2= 100\)</span>.
Specifically,
we’re interested in detecting the case when the variance is higher than expected:</p>
<div class="math notranslate nohighlight">
\[
    H_A: \sigma^2 &gt; \sigma_{K_0}^2
    \qquad \text{and} \qquad
    H_0: \sigma^2 \leq \sigma_{K_0}^2.
\]</div>
<p>Note the alternative hypothesis uses the “greater than” inequality,
since we don’t mind batches with low variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch02</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ksample02</span> <span class="o">=</span> <span class="n">batch02</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ksample02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsvar02</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">ksample02</span><span class="p">)</span>
<span class="n">obsvar02</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>124.31760105263136
</pre></div>
</div>
</div>
</div>
<p>We’ll now generate the sampling distribution of the variance for sample of size <span class="math notranslate nohighlight">\(n=20\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right_tail</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kvars20</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">obsvar02</span><span class="p">]</span>
<span class="n">pvalue02</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_tail</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kvars20</span><span class="p">)</span>
<span class="n">pvalue02</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2132
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-value is greater than the cutoff value <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>,
so our decision is “fail to reject <span class="math notranslate nohighlight">\(H_0\)</span>.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># choose common bins for the histograms</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">nicebins</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">obsvar02</span><span class="p">)</span>

<span class="c1"># plot sampling distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

<span class="c1"># plot red line for the observed statistic</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">obsvar02</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># plot the values that are equal or more extreme in red</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">right_tail</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/f6793ad11dfd2fe0ded3a78caff7fc97a4c1eff2b0fa583368506105c2431d01.png"><img alt="../../_images/f6793ad11dfd2fe0ded3a78caff7fc97a4c1eff2b0fa583368506105c2431d01.png" src="../../_images/f6793ad11dfd2fe0ded3a78caff7fc97a4c1eff2b0fa583368506105c2431d01.png" style="width: 616px; height: 197px;" />
</a>
</div>
</div>
</section>
<section id="example-4s-test-for-the-variance-of-batch-08">
<h3>Example 4S: test for the variance of Batch 08<a class="headerlink" href="#example-4s-test-for-the-variance-of-batch-08" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch08</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
<span class="n">ksample08</span> <span class="o">=</span> <span class="n">batch08</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">ksample08</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsvar08</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">ksample08</span><span class="p">)</span>
<span class="n">obsvar08</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>169.9979220512824
</pre></div>
</div>
</div>
</div>
<p>We’ll now generate the sampling distribution of the variance for sample of size <span class="math notranslate nohighlight">\(n=40\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">kvars40</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">right_tail</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kvars40</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">obsvar08</span><span class="p">]</span>
<span class="n">pvalue08</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_tail</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kvars40</span><span class="p">)</span>
<span class="n">pvalue08</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0041
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-value is very small,
so our decision is to reject <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<section id="id2">
<h4>Effect size estimates<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>We found the variance in the volumes in this batch is higher than the expected variance.
Now let’s compute an estimate for the effect size <span class="math notranslate nohighlight">\(\widehat{\Delta} = s^2_{\mathbf{k}_{08}} / \sigma_{K_0}^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="n">ksample08</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigmaK0</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.699979220512824
</pre></div>
</div>
</div>
</div>
<p>This tells us the variance of <span class="math notranslate nohighlight">\(\mathbf{k}_{08}\)</span> is 70% higher in the theoretically expected variance <span class="math notranslate nohighlight">\(\sigma_{K_0}^2 = 100\)</span>.</p>
<p>The bootstrap confidence interval for the effect size
<span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^*\)</span> tells us a range of plausible values for the effect size.
We can obtain <span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^*\)</span> by first computing a 90% bootstrap confidence interval
for the variance <span class="math notranslate nohighlight">\(\ci{\sigma^2,0.9}^*\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ci_var</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
<span class="n">civar08_boot</span> <span class="o">=</span> <span class="n">ci_var</span><span class="p">(</span><span class="n">ksample08</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">civar08_boot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[117.37369362820536, 217.98659930448775]
</pre></div>
</div>
</div>
</div>
<p>We can obtain a confidence interval for
<span class="math notranslate nohighlight">\(\Delta = \sigma^2 / \sigma_{K_0}^2\)</span>
by dividing the limits of <span class="math notranslate nohighlight">\(\ci{\sigma^2,0.9}^*\)</span> by the theoretical variance <span class="math notranslate nohighlight">\(\sigma_{K_0}^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci_l</span> <span class="o">=</span> <span class="n">civar08_boot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">sigmaK0</span><span class="o">**</span><span class="mi">2</span>
<span class="n">ci_u</span> <span class="o">=</span> <span class="n">civar08_boot</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">sigmaK0</span><span class="o">**</span><span class="mi">2</span>
<span class="p">[</span><span class="n">ci_l</span><span class="p">,</span> <span class="n">ci_u</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.1737369362820536, 2.1798659930448774]
</pre></div>
</div>
</div>
</div>
<p>The interval <span class="math notranslate nohighlight">\(\ci{\Delta,0.9}^* = [1.17, 2.18]\)</span> tells us the observed sample variance
in Batch 08 is somewhere between 1.17 and 2.18 times the expected variance <span class="math notranslate nohighlight">\(\sigma_{K_0}^2\)</span> under the null hypothesis.</p>
</section>
</section>
</section>
<section id="explanations">
<h2>Explanations<a class="headerlink" href="#explanations" title="Link to this heading">#</a></h2>
<section id="one-sided-and-two-sided-tests">
<h3>One-sided and two-sided tests<a class="headerlink" href="#one-sided-and-two-sided-tests" title="Link to this heading">#</a></h3>
<section id="selecting-the-tails-of-a-distribution">
<h4>Selecting the tails of a distribution<a class="headerlink" href="#selecting-the-tails-of-a-distribution" title="Link to this heading">#</a></h4>
<p>The concept of statistics that are “equal or more extreme than <span class="math notranslate nohighlight">\(\hat{\theta}_{\mathbf{x}}\)</span>”
is essential to the logic of hypothesis testing.
We’ll need to perform this type of filtering any time we use numerical methods for hypothesis testing.</p>
<p>Let’s write a helper function that performs the selection of the tail values for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">tailvalues</span><span class="p">(</span><span class="n">valuesH0</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select the subset of the elements in list `valuesH0` that</span>
<span class="sd">    are equal or more extreme than the observed value `obs`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">alt</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;greater&quot;</span><span class="p">,</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">]</span>
    <span class="n">valuesH0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">valuesH0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;greater&quot;</span><span class="p">:</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">valuesH0</span><span class="p">[</span><span class="n">valuesH0</span> <span class="o">&gt;=</span> <span class="n">obs</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;less&quot;</span><span class="p">:</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">valuesH0</span><span class="p">[</span><span class="n">valuesH0</span> <span class="o">&lt;=</span> <span class="n">obs</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;two-sided&quot;</span><span class="p">:</span>
        <span class="n">meanH0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">valuesH0</span><span class="p">)</span>
        <span class="n">obsdev</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obs</span> <span class="o">-</span> <span class="n">meanH0</span><span class="p">)</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">valuesH0</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">valuesH0</span><span class="o">-</span><span class="n">meanH0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">obsdev</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tails</span>
</pre></div>
</div>
</div>
</div>
<p>You should be familiar with the three types of tail values selections:</p>
<ul class="simple">
<li><p>For right-tailed tests,
we call <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> with the option <code class="docutils literal notranslate"><span class="pre">alt=&quot;greater&quot;</span></code>,
which will select the subset of values in the list
<code class="docutils literal notranslate"><span class="pre">valuesH0</span></code> that are equal to or greater than the observed statistic <code class="docutils literal notranslate"><span class="pre">obs</span></code>.</p></li>
<li><p>Foe left-tailed test,
we call <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> with the option <code class="docutils literal notranslate"><span class="pre">alt=&quot;less&quot;</span></code>,
which selects the values that are equal to or less than the observed statistic <code class="docutils literal notranslate"><span class="pre">obs</span></code>.</p></li>
<li><p>For two-tailed tests,
we select values observations whose deviation from the mean <code class="docutils literal notranslate"><span class="pre">meanH0</span></code>
is equal to or greater than the observed deviation <code class="docutils literal notranslate"><span class="pre">obsdev</span></code>.</p></li>
</ul>
</section>
<section id="one-sided-p-value-calculation-example">
<h4>One-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example<a class="headerlink" href="#one-sided-p-value-calculation-example" title="Link to this heading">#</a></h4>
<p>We can verify that  the function <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> works as expected
by reproducing the <span class="math notranslate nohighlight">\(p\)</span>-value calculation from Example 3S.
Reusing the variables <code class="docutils literal notranslate"><span class="pre">n02=20</span></code> and <span class="math notranslate nohighlight">\(\tt{obsvar02} = s_{\mathbf{k}_{02}}^2 = 124.32\)</span> we calculated above,
we can obtain the <span class="math notranslate nohighlight">\(p\)</span>-value by calling the helper function <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> with the option <code class="docutils literal notranslate"><span class="pre">alt=&quot;greater&quot;</span></code>,then dividing by the total number of simulations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">tails</span> <span class="o">=</span> <span class="n">tailvalues</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">obsvar02</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&quot;greater&quot;</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kvars20</span><span class="p">)</span>
<span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2132
</pre></div>
</div>
</div>
</div>
<p>The result is identical to the <span class="math notranslate nohighlight">\(p\)</span>-value <span class="math notranslate nohighlight">\(\tt{pvalue02} = 0.2132\)</span> that we computed in Example 3S,
so we know the function <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> works as expected for <span class="math notranslate nohighlight">\(p\)</span>-value calculations of type <strong>(a)</strong>,
where we want to detect positive deviations from the expected distribution under <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
</section>
<section id="two-sided-p-value-calculation-example">
<h4>Two-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example<a class="headerlink" href="#two-sided-p-value-calculation-example" title="Link to this heading">#</a></h4>
<p>Reusing the values <code class="docutils literal notranslate"><span class="pre">n04=40</span></code> and <span class="math notranslate nohighlight">\(\tt{obsmean04} = \overline{\mathbf{x}}_{04} = 1003.83\)</span>
that we calculated earlier in Example 1S,
we can obtain the <span class="math notranslate nohighlight">\(p\)</span>-value by calling the function <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code>
with the option <code class="docutils literal notranslate"><span class="pre">alt=&quot;two-sided&quot;</span></code> then divide by the total number of simulations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kbars40</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK0</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">tails</span> <span class="o">=</span> <span class="n">tailvalues</span><span class="p">(</span><span class="n">kbars40</span><span class="p">,</span> <span class="n">obsmean04</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&quot;two-sided&quot;</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">kbars40</span><span class="p">)</span>
<span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015
</pre></div>
</div>
</div>
</div>
<p>The result is identical to the <span class="math notranslate nohighlight">\(p\)</span>-value that we obtained in Example 1S,
so we know the function <code class="docutils literal notranslate"><span class="pre">tailvalues</span></code> works as expected for <span class="math notranslate nohighlight">\(p\)</span>-value calculations of type <strong>(c)</strong>,
where we want to detect both positive and negative deviations from the expected distribution under <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
</section>
</section>
<section id="summary-of-the-hypothesis-testing-procedure">
<h3>Summary of the hypothesis testing procedure<a class="headerlink" href="#summary-of-the-hypothesis-testing-procedure" title="Link to this heading">#</a></h3>
<p>The steps of the hypothesis testing procedure are as follows:</p>
<ul class="simple">
<li><p>Step 1: Formulate two competing hypotheses <span class="math notranslate nohighlight">\(H_0\)</span> and <span class="math notranslate nohighlight">\(H_A\)</span>.</p></li>
<li><p>Step 2: Choose an estimator relevant for distinguishing between the two hypotheses.</p></li>
<li><p>Step 3: Compute the test statistic <span class="math notranslate nohighlight">\(\hat{\theta}_{\mathbf{x}}\)</span> from the sample <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p></li>
<li><p>Step 4: Obtain <span class="math notranslate nohighlight">\(\widehat{\Theta}_0\)</span>, the sampling distribution of the test statistic under the null hypothesis.</p></li>
<li><p>Step 5: Decide whether to <em>reject</em> or <em>fail to reject</em> the null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span>
based on the <span class="math notranslate nohighlight">\(p\)</span>-value computed from the observed test statistic <span class="math notranslate nohighlight">\(\hat{\theta}_{\mathbf{x}}\)</span>
under the sampling distribution <span class="math notranslate nohighlight">\(\widehat{\Theta}_0\)</span> assuming <span class="math notranslate nohighlight">\(H_0\)</span> is true.</p></li>
<li><p>Step 6: Report your decision and calculate effect size estimates.</p></li>
</ul>
</section>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h2>
<section id="standardized-effect-size">
<h3>Standardized effect size<a class="headerlink" href="#standardized-effect-size" title="Link to this heading">#</a></h3>
<p>It is sometimes useful to report the effect size using a “standardized” measure for effect sizes.
Cohen’s <span class="math notranslate nohighlight">\(d\)</span> is one such measure, and it is defined as the difference between the observed mean and an expected mean,
divided by the sample standard deviation:</p>
<div class="math notranslate nohighlight">
\[
  d = \frac{\overline{\mathbf{x}} - \mu_0}{ s_{\mathbf{x}} }.
\]</div>
<p>For example,
the sample <span class="math notranslate nohighlight">\(\mathbf{k}_{04}\)</span> from Batch 04 has mean <span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04} = 1003.83\)</span>,
which corresponds to a “raw” deviation of <span class="math notranslate nohighlight">\(3.83\)</span> from the expected value <span class="math notranslate nohighlight">\(\mu_{K_0}=1000\)</span>.
We divide the raw deviation (<span class="math notranslate nohighlight">\(\overline{\mathbf{k}}_{04} - \mu_{K_0}\)</span>) by the sample’s standard deviation <span class="math notranslate nohighlight">\(s_{\mathbf{k}_{04}}= 7.85\)</span>
to obtain Cohen’s <span class="math notranslate nohighlight">\(d\)</span> standardized effect size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std04</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ksample04</span><span class="p">))</span>
<span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">ksample04</span><span class="p">)</span> <span class="o">-</span> <span class="n">muK0</span><span class="p">)</span> <span class="o">/</span> <span class="n">std04</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4882087345321637
</pre></div>
</div>
</div>
</div>
<p>We can interpret the value of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> obtained using this <a class="reference external" href="https://en.wikipedia.org/wiki/Effect_size#Cohen's_d">table of reference values</a>,
which was published in (Cohen YYYY TODO) and continues to be used as a reference to this day.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Cohen’s d</p></th>
<th class="head"><p>Effect size</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.01</p></td>
<td><p>very small</p></td>
</tr>
<tr class="row-odd"><td><p>0.20</p></td>
<td><p>small</p></td>
</tr>
<tr class="row-even"><td><p>0.50</p></td>
<td><p>medium</p></td>
</tr>
<tr class="row-odd"><td><p>0.80</p></td>
<td><p>large</p></td>
</tr>
</tbody>
</table>
</div>
<p>The standardized effect size for kombucha Batch 04 is <span class="math notranslate nohighlight">\(d=0.488\)</span>,
which we quantify as “medium” effect size according to the table of reference values.</p>
<p>The following helper function shows how to compute the Cohen’s <span class="math notranslate nohighlight">\(d\)</span> for a given sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cohend</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mu0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cohen&#39;s d for one group compared to the theoretical mean `mu0`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obsmean</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">obsstd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsmean</span> <span class="o">-</span> <span class="n">mu0</span><span class="p">)</span> <span class="o">/</span> <span class="n">obsstd</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cohend</span><span class="p">(</span><span class="n">ksample04</span><span class="p">,</span> <span class="n">mu0</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4882087345321637
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>[TALK] <a class="reference external" href="https://www.youtube.com/watch?v=Iq9DzN6mvYA"><em>Statistics for Hackers</em></a> by Jake Vanderplas</p></li>
<li><p>[VIDEO] <a class="reference external" href="https://www.youtube.com/watch?v=S41zQEshs5k"><em>There’s Only One Test</em></a> by Allen B. Downey</p></li>
<li><p>[PAPER] <a class="reference external" href="https://minireference.com/blog/wp-content/uploads/2021/03/TheIntroductoryStatisticsCourse__Cobb.pdf"><em>The Introductory Statistics Course: A Ptolemaic Curriculum</em></a> by George W. Cobb</p></li>
<li><p>[PAPER] <a class="reference external" href="https://www.tandfonline.com/doi/full/10.1080/00031305.2015.1089789"><em>What Teachers Should Know About the Bootstrap: Resampling in the Undergraduate Statistics Curriculum</em></a> by Tim C. Hesterberg</p></li>
<li><p>[BOOK] <a class="reference external" href="https://greenteapress.com/wp/think-stats-2e/"><em>Think Stats 2e</em></a> by Allen B. Downey</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstats",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-hypothesis-testing">What is hypothesis testing?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypotheses">Hypotheses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-statistic">Test statistic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-test-statistic-under-h-0">Sampling distribution of the test statistic under <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-p-value">The p-value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logic-of-hypothesis-testing">The logic of hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-the-hypothesis-testing-procedure">Overview of the hypothesis testing procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#court-trial-analogy">Court trial analogy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-the-result-of-a-hypothesis-test">Interpreting the result of a hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-size-estimates">Effect size estimates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-tests">Simulation tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-the-mean">Test for the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kombucha-bottling-process">Kombucha bottling process</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computer-model-for-the-kombucha-volumes-under-h-0">Computer model for the kombucha volumes under <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-under-the-null">Sampling distribution of the mean under the null</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1s-test-for-the-mean-of-batch-04">Example 1S: test for the mean of Batch 04</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean-under-the-null-hypothesis">Sampling distribution of the mean under the null hypothesis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Effect size estimates</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2s-test-for-the-mean-of-batch-01">Example 2S: test for the mean of Batch 01</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-for-the-variance">Test for the variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-variance-under-the-null">Sampling distribution of the variance under the null</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3s-test-for-the-variance-of-batch-02">Example 3S: test for the variance of Batch 02</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4s-test-for-the-variance-of-batch-08">Example 4S: test for the variance of Batch 08</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Effect size estimates</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-and-two-sided-tests">One-sided and two-sided tests</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-the-tails-of-a-distribution">Selecting the tails of a distribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-p-value-calculation-example">One-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sided-p-value-calculation-example">Two-sided <span class="math notranslate nohighlight">\(p\)</span>-value calculation example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-hypothesis-testing-procedure">Summary of the hypothesis testing procedure</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardized-effect-size">Standardized effect size</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ivan Savov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>