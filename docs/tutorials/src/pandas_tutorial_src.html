
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Appendix D — Pandas tutorial &#8212; No Bullshit Guide to Statistics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/tutorials/src/pandas_tutorial_src';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="No Bullshit Guide to Statistics - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="No Bullshit Guide to Statistics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    No Bullshit Guide to Statistics
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../notebooks/10_DATA.html">Chapter 1 — Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/11_intro_to_data.html">Section 1.1 — Introduction to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/12_data_in_practice.html">Section 1.2 — Data in practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/13_descriptive_statistics.html">Section 1.3 — Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../exercises/exercises_13_descr_stats.html">Descriptive statistics exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../notebooks/20_PROB.html">Chapter 2 — Probability theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/21_discrete_random_vars.html">Section 2.1 — Discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/22_multiple_random_vars.html">Section 2.2 — Multiple random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/23_inventory_discrete_dists.html">Section 2.3 — Inventory of discrete distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/24_continuous_random_vars.html">Section 2.4 — Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/25_multiple_continuous_random_vars.html">Section 2.5 — Multiple continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/26_inventory_continuous_dists.html">Section 2.6 — Inventory of continuous distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/27_simulations.html">Section 2.7 — Simulation and empirical distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/28_random_samples.html">Section 2.8 — Probability models for random samples</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../notebooks/30_STATS.html">Chapter 3 — Classical statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/31_estimators.html">Section 3.1 — Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../exercises/exercises_31_estimtors.html">Exercises for Section 3.1 Estimates and estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/32_confidence_intervals.html">Section 3.2 — Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../exercises/exercises_32_confidence_intervals.html">Exercises for Section 3.2 Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/33_intro_to_NHST.html">Section 3.3 — Introduction to hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/34_analytical_approx.html">Section 3.4 — Hypothesis testing using analytical approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/35_two_sample_tests.html">Section 3.5 — Two-sample hypothesis tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/36_design.html">Section 3.6 — Statistical design and error analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/37_inventory_stats_tests.html">Section 3.7 — Inventory of statistical tests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../examples/README.html">Statistical analysis examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/statistical_design.html">Statistical design examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/one_sample_z-test.html">One-sample z-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/one_sample_t-test.html">One-sample t-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/two_sample_t-test.html">Welch’s two-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/ANOVA.html">Analysis of variance (ANOVA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples/two_sample_equivalence_test.html">Two-sample equivalence test</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../notebooks/40_LINEAR_MODELS.html">Chapter 4 — Linear models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/41_simple_linear_regression.html">Section 4.1 — Simple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/42_multiple_linear_regression.html">Section 4.2 — Multiple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/43_interpreting_linear_models.html">Section 4.3 — Interpreting linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/44_regression_with_categorical_predictors.html">Section 4.4 — Regression with categorical predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/45_causal_inference.html">Section 4.5 — Model selection for causal inference</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/46_generalized_linear_models.html">Section 4.6 — Generalized linear models</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../notebooks/50_BAYESIAN_STATS.html">Chapter 5 — Bayesian statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/51_intro_to_Bayesian_stats.html">Section 5.1 — Introduction to Bayesian statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/52_Bayesian_inference_computations.html">Section 5.2 — Bayesian inference computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/53_Bayesian_linear_models.html">Section 5.3 — Bayesian linear models</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/54_difference_between_means.html">Section 5.4 — Bayesian difference between means</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../notebooks/55_hierarchical_models.html">Section 5.5 — Hierarchical models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials/appendix.html">Appendix</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/python_tutorial.html">Appendix C — Python tutorial</a></li>












<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/pandas_tutorial.html">Appendix D — Pandas tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/seaborn_tutorial.html">Appendix E — Seaborn tutorial</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/calculus_tutorial.html">Appendix F — Calculus tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reading_group/info.html">noBSstats Reading Group</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../blogposts/index.html">Blog posts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/python_for_stats.html">Using Python for learning statistics Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/probability_models.html">Using Python for probability calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/sampling_distributions.html">Sampling distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/bootstrap.html">Bootstrap estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/simulation_hypothesis_tests.html">Hypothesis testing using simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/permutation_test.html">Permutation tests for comparing two groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/stats_procedures.html">Python libraries for doing statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../blogposts/python_stats_libraries.html">Python libraries for doing statistics</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/minireference/noBSstats/main?urlpath=lab/tree/./docs/tutorials/src/pandas_tutorial_src.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/minireference/noBSstats" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/minireference/noBSstats/issues/new?title=Issue%20on%20page%20%2Fdocs/tutorials/src/pandas_tutorial_src.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/docs/tutorials/src/pandas_tutorial_src.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Appendix D — Pandas tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-overview">Pandas overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-pandas-and-other-libraries">Installing Pandas and other libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-display-options">Setting display options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-datasets">Download datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames">Data frames</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-data-frame-from-a-csv-file">Creating a data frame from a CSV file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frame-properties">Data frame properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rows-index">Rows index</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#columns-index">Columns index</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-data-types-and-momory-usage">Shape, data types, and momory usage</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-and-selecting-values">Accessing and selecting values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-individual-values">Accessing individual values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-entire-rows">Selecting entire rows</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-entire-columns">Selecting entire columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-multiple-columns">Selecting multiple columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-only-certain-rows">Selecting only certain rows</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data-frames-from-python-objects">Creating data frames from Python objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames-exercises">Data frames exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-select-a-column">Exercise 1: Select a column</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-select-rows">Exercise 2: Select rows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-properties">Series properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-calculations">Series calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-pandas-series-from-python-lists">Creating Pandas series from Python lists</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-exercises">Series exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-grouping-and-aggregation">Sorting, grouping, and aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-and-ranking">Sorting and ranking</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ranking-values">Ranking values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-and-aggregation">Group by and aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-1-pandas-method-chaining">Sidenote 1: Pandas method chaining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-2-line-continuation-strategies">Sidenote 2: Line-continuation strategies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-values">Counting values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pivot-table-for-aggregation">Using <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> for aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-and-aggregation-exercises">Sorting and aggregation exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-transformations">Data transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-new-columns">Adding new columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoiding-in-place-modifications">Avoiding in-place modifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-assign-method">The <code class="docutils literal notranslate"><span class="pre">assign</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-apply-method">The <code class="docutils literal notranslate"><span class="pre">apply</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-rows-and-and-columns">Dropping rows and and columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns-and-values">Renaming columns and values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-data-frames">Reshaping data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy-data">Tidy data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#string-methods">String methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-data-frames">Merging data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenating-data-frames">Concatenating data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-type-conversions">Data type conversions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-and-dummy-coding-for-categorical-variables">One-hot and dummy coding for categorical variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose">Transpose</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-exercises">Transformation exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardize-categorical-values">Standardize categorical values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-cleaning-the-cats-data">Exercise 9: cleaning the cats data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-formatting-errors">Number formatting errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-values">Dealing with missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-duplicates">Removing duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-and-removing-outliers">Identifying and removing outliers</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-outliers-are-problematic">Why outliers are problematic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#criteria-for-identifying-outliers">Criteria for identifying outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-inspection-of-the-data">Visual inspection of the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tukey-outliers">Tukey outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-outliers-using-z-scores">Detecting outliers using z-scores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-outliers">Removing outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-exclude-outliers">When to exclude outliers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-data-cleaning">Summary of data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-exercises">Data cleaning exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-extraction">Data extraction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formats">Data formats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-files">CSV files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets-files">Spreadsheets files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tsv-files">TSV files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#json-files">JSON files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-in-html-files">Tables in HTML files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite-database-files">SQLite database files</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-extraction-exercises">Data extraction exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">Case studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-apples-dataset">Collecting the apples dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-electricity-prices-dataset">Collecting the electricity prices dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-students-dataset">Collecting the students dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-kombucha-dataset">Collecting the kombucha dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-doctors-dataset">Collecting the doctors dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-players-dataset">Generating the players dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatives-to-pandas">Alternatives to Pandas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#music-videos">Music videos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-concepts">General concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cheatsheets">Cheatsheets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorials">Tutorials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#articles">Articles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#books">Books</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="appendix-d-pandas-tutorial">
<h1>Appendix D — Pandas tutorial<a class="headerlink" href="#appendix-d-pandas-tutorial" title="Link to this heading">#</a></h1>
<p>The Python library Pandas is a versatile toolbox for working with tabular data.
Pandas is often used for data loading from different sources,
data cleaning, data transformations, statistical analysis,
and many other data management tasks.
This tutorial will introduce you to the central Pandas functionality
with a specific focus on the data manipulation tasks used in statistics.</p>
<p>Click the binder button <a class="reference external" href="https://mybinder.org/v2/gh/minireference/noBSstats/HEAD?labpath=tutorials/pandas_tutorial.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a>
or this link <a class="reference external" href="https://bit.ly/46gBen4"><code class="docutils literal notranslate"><span class="pre">bit.ly/46gBen4</span></code></a>
to play with the tutorial notebook interactively.</p>
<!--  ALT. so you can follow along and try the data loading and transformations commands on your own. -->
<!-- 
which is like a Swiss army knife for data management tasks.

DECISIONS:
- Sept 12: no more use of the custom function `head`
--><section id="pandas-overview">
<h2>Pandas overview<a class="headerlink" href="#pandas-overview" title="Link to this heading">#</a></h2>
<p>The Pandas library provide many helper functions
for data management tasks and statistical calculations.
Pandas functionality is organized around <em>data frame</em> objects,
which are containers objects for tabular data.
A Pandas data frame is roughly equivalent to a spreadsheet
that contains data values organized into rows and columns.
Similar to spreadsheet software,
a Pandas data frame provides functions for computing sums, averages, sorting, filtering values, etc.</p>
<p>The goal of this tutorial
is to reach you to use Pandas for practical data management tasks.
Becoming good at data management
will give you the practical skills you need to apply statistics in real-world scenarios.
Indeed,
professional statisticians and data scientists
spend a large proportion of their time on data extraction,
data processing, and data cleaning tasks,
which are essential prerequisites consist of the significant part of the work for any statistical analysis.
Pandas is like a Swiss Army knife of data manipulations,
which makes it very useful for all these data manipulation tasks.</p>
<section id="learning-objectives">
<h3>Learning objectives<a class="headerlink" href="#learning-objectives" title="Link to this heading">#</a></h3>
<p>In this tutorial, I’m going to show you how to …</p>
<p>TODO import from <a class="reference external" href="https://docs.google.com/document/d/1fwep23-95U-w1QMPU31nOvUnUXE2X3s_Dbk5JuLlKAY/edit?tab=t.0#bookmark=kix.thmy71z7rfwq">gdoc</a></p>
</section>
</section>
<section id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Link to this heading">#</a></h2>
<p>Before we begin the tutorial,
we we must take care of some preliminary tasks
to prepare the notebook environment.
Feel free to skip this commands</p>
<section id="installing-pandas-and-other-libraries">
<h3>Installing Pandas and other libraries<a class="headerlink" href="#installing-pandas-and-other-libraries" title="Link to this heading">#</a></h3>
<p>We can install Python package <code class="docutils literal notranslate"><span class="pre">pandas</span></code> in the current environment using the <code class="docutils literal notranslate"><span class="pre">%pip</span></code> Jupyter magic command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --quiet pandas
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">26.0</span> -&gt; <span class=" -Color -Color-Green">26.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p>We’ll use the same command to install some additional Python packages
that we’ll need throughout the tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --quiet ministats lxml odfpy openpyxl xlrd sqlalchemy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">26.0</span> -&gt; <span class=" -Color -Color-Green">26.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ministats</span></code> package provides a helper function we’ll use to download datasets.
The <code class="docutils literal notranslate"><span class="pre">lxml</span></code>, <code class="docutils literal notranslate"><span class="pre">odfpy</span></code>, <code class="docutils literal notranslate"><span class="pre">openpyxl</span></code>, and <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> provide additional functionality
for loading data stored in various file formats.</p>
</section>
<section id="setting-display-options">
<h3>Setting display options<a class="headerlink" href="#setting-display-options" title="Link to this heading">#</a></h3>
<p>Next,
we run some commands to configure the display of figures
and number formatting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># high-resolution figures </span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simplified int and float __repr__</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.25&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="download-datasets">
<h3>Download datasets<a class="headerlink" href="#download-datasets" title="Link to this heading">#</a></h3>
<p>We use a helper function from the <code class="docutils literal notranslate"><span class="pre">ministats</span></code> library
to make sure the <code class="docutils literal notranslate"><span class="pre">datasets/</span></code> folder that accompanies this tutorial is present.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download datasets/ directory if necessary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">ensure_datasets</span>
<span class="n">ensure_datasets</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datasets/ directory already exists.
</pre></div>
</div>
</div>
</div>
<p>With all these preliminaries in place,
we can now get the Pandas show started!</p>
</section>
</section>
<section id="data-frames">
<h2>Data frames<a class="headerlink" href="#data-frames" title="Link to this heading">#</a></h2>
<p>Most of Pandas functionality is organized around the data frame objects (<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>),
which are containers for tabular data.
A Pandas data frame is analogous to a spreadsheet:
it provides functionality for storing, viewing, and transforming data
organized into rows and columns.</p>
<!-- Data frames also also provide lots of methods for doing calculations  -->
<p>If you understand how <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects work,
then you’ll know most of what you need to know about data management with Pandas,
so this is why we start the tutorial here.</p>
<!-- 
The technical terms we use to describe the Pandas objects and their properties.
\begin{itemize}

	\item	Pandas \emph{data frame} objects (\tt{pd.DataFrame}):
		the software representation of tabular data.
		Data frames are a common way to organize tabular data used in statistical software.
		The Pandas library provides the \texttt{DataFrame} class for representing tabular data.

		% Robyn said:  Do you think people might get mixed up with the definition of data table at the start?
		%			Maybe we should use data frame there too, for simplicity?

	\item	Pandas \emph{series} objects (\tt{pd.Series}):
		the software representation for the rows and columns in a data frame,
		see Figure~\ref{figure:anatomy-of-data-frame}.
		The columns of a data frame correspond to different \emph{variables},
		while the rows are the \emph{observations}.


\end{itemize}
--><section id="creating-a-data-frame-from-a-csv-file">
<h3>Creating a data frame from a CSV file<a class="headerlink" href="#creating-a-data-frame-from-a-csv-file" title="Link to this heading">#</a></h3>
<p>The most common way to create a data frame object
is to read data from a CSV (Comma-Separated-Values) file.
Let’s look at the raw contents of the sample data file <code class="docutils literal notranslate"><span class="pre">datasets/minimal.csv</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat<span class="w"> </span><span class="s2">&quot;datasets/minimal.csv&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x,y,team,level
1.0,2.0,a,3
1.5,1.0,a,2
2.0,1.5,a,1
2.5,2.0,b,3
3.0,1.5,b,3
</pre></div>
</div>
</div>
</div>
<p>The first line in the CSV file is called the <em>header</em> row
and contains the variables names: <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">team</span></code>, and <code class="docutils literal notranslate"><span class="pre">level</span></code>,
separated by commas.
The next five rows contain the data values separated by commas.</p>
<p>The data corresponds to five players in a computer game.
The columns <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> describe the position of the player,
the variable <code class="docutils literal notranslate"><span class="pre">team</span></code> indicates which team the player is part of,
and the column <code class="docutils literal notranslate"><span class="pre">level</span></code> specifies the character’s strength.</p>
<p>We want to load the data file <code class="docutils literal notranslate"><span class="pre">datasets/minimal.csv</span></code> into Pandas.
We start by importing the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library under the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>
then call the Pandas function <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code>,
which is used load data from CSV files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/minimal.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The import statement makes all the Pandas functions available under the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>,
which is the standard short-name used for Pandas in the data science community.
On the next line,
the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> reads the contents of the data file <code class="docutils literal notranslate"><span class="pre">datasets/minimal.csv</span></code>
and stores them into a data frame called <code class="docutils literal notranslate"><span class="pre">df</span></code>,
which we then display on the final line.</p>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> is fairly small,
so it makes sense to display it in full.
When working with larger data frames with thousands or millions of rows,
it will not be practical to print all their contents.
We can use the data frame method <code class="docutils literal notranslate"><span class="pre">.head(k)</span></code>
to prints the first <code class="docutils literal notranslate"><span class="pre">k</span></code> rows the data frame
to see what the data looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">df.tail(k)</span></code> to print the last <span class="math notranslate nohighlight">\(k\)</span> rows of the data frame,
or <code class="docutils literal notranslate"><span class="pre">df.sample(k)</span></code> to select <code class="docutils literal notranslate"><span class="pre">k</span></code> rows at random from the data frame.</p>
</section>
<section id="data-frame-properties">
<h3>Data frame properties<a class="headerlink" href="#data-frame-properties" title="Link to this heading">#</a></h3>
<p>We’ll use the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> for many of the examples in the remainder of this tutorial,
which is why we gave it a very short name.
Let’s explore the attributes and methods of the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.
First let’s use the Python function <code class="docutils literal notranslate"><span class="pre">type</span></code> to confirm that <code class="docutils literal notranslate"><span class="pre">df</span></code> is indeed a data frame object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<p>The above message tells us that the <code class="docutils literal notranslate"><span class="pre">df</span></code> object
is an instance of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> class.</p>
<p>Every data frame has the attributes <code class="docutils literal notranslate"><span class="pre">index</span></code> and <code class="docutils literal notranslate"><span class="pre">columns</span></code>,
as illustrated in the following figure:</p>
<p><img alt="Anatomy of the data frame ." src="../../../_images/anatomy-of-minimal-df.png" />
<em>Figure 1</em>. The anatomy is the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> with annotations for its different parts.</p>
<section id="rows-index">
<h4>Rows index<a class="headerlink" href="#rows-index" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">index</span></code> of the data frame contains unique labels
that we use to refer to the rows of the data frame.
The row-index labels in data frames
are analogous to the row numbers used in spreadsheets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=5, step=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4]
</pre></div>
</div>
</div>
</div>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> uses the “default” range index
that consists of a sequence integer labels: <code class="docutils literal notranslate"><span class="pre">[0,1,2,3,4]</span></code>.
More generally,
index values can be arbitrary labels:
text identifiers, dates, timestamps, etc.</p>
</section>
<section id="columns-index">
<h4>Columns index<a class="headerlink" href="#columns-index" title="Link to this heading">#</a></h4>
<p>The columns-index attribute <code class="docutils literal notranslate"><span class="pre">.columns</span></code> tells us the names of the columns (variables) in the data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;x&#39;, &#39;y&#39;, &#39;team&#39;, &#39;level&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>These column names were automatically determined based on header row in the CSV file.
Column names usually consist of short textual identifiers for the variable (Python strings).
Spaces and special characters are allowed in column names,
so we could have used names like <code class="docutils literal notranslate"><span class="pre">&quot;x</span> <span class="pre">position&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;level</span> <span class="pre">(1</span> <span class="pre">to</span> <span class="pre">3)&quot;</span></code> if we wanted to.
However,
long column names make data manipulation code more difficult to read,
so they are discouraged.</p>
</section>
<section id="shape-data-types-and-momory-usage">
<h4>Shape, data types, and momory usage<a class="headerlink" href="#shape-data-types-and-momory-usage" title="Link to this heading">#</a></h4>
<p>Another important property of the data frame is its shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5, 4)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">shape</span></code> of the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> is <span class="math notranslate nohighlight">\(5 \times 4\)</span>,
which means it has five rows and four columns.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.dtypes</span></code> (data types) attribute
tells us what <code class="docutils literal notranslate"><span class="pre">type</span></code> of data is stored in each of the columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x        float64
y        float64
team      object
level      int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We see that the columns <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> contain floating point numbers,
the column <code class="docutils literal notranslate"><span class="pre">team</span></code> can contain arbitrary Python objects (in this case Python strings),
and the column <code class="docutils literal notranslate"><span class="pre">level</span></code> contains integers.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">.info()</span></code> provides additional information about the data frame object <code class="docutils literal notranslate"><span class="pre">df</span></code>,
including missing values (null values) and the total memory usage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5 entries, 0 to 4
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   x       5 non-null      float64
 1   y       5 non-null      float64
 2   team    5 non-null      object 
 3   level   5 non-null      int64  
dtypes: float64(2), int64(1), object(1)
memory usage: 538.0 bytes
</pre></div>
</div>
</div>
</div>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> takes up 502 bytes of memory, which is not a lot.
You don’t have to worry about memory usage for any of the datasets we’ll analyze in this book,
since they are all small- and medium-sized.</p>
<!-- You might have to think about memory usage if you work on larger datasets like logs or databases. --></section>
</section>
<section id="accessing-and-selecting-values">
<h3>Accessing and selecting values<a class="headerlink" href="#accessing-and-selecting-values" title="Link to this heading">#</a></h3>
<p>We use the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> attribute to access rows, columns, and individual values within data frames.</p>
<section id="accessing-individual-values">
<h4>Accessing individual values<a class="headerlink" href="#accessing-individual-values" title="Link to this heading">#</a></h4>
<p>We use the syntax <code class="docutils literal notranslate"><span class="pre">df.loc[&lt;row&gt;,&lt;col&gt;]</span></code>
to select the value with row label <code class="docutils literal notranslate"><span class="pre">&lt;row&gt;</span></code>
and column label <code class="docutils literal notranslate"><span class="pre">&lt;col&gt;</span></code> in the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.
For example,
to extract the value of the variable <code class="docutils literal notranslate"><span class="pre">y</span></code>
for the third row, we use:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5
</pre></div>
</div>
</div>
</div>
<p>Note the row label <code class="docutils literal notranslate"><span class="pre">2</span></code>
is a particular value within the rows-index <code class="docutils literal notranslate"><span class="pre">df.index</span></code>
and not the sequential row number:
the row label just happens to be same as the row number in this case.</p>
</section>
<section id="selecting-entire-rows">
<h4>Selecting entire rows<a class="headerlink" href="#selecting-entire-rows" title="Link to this heading">#</a></h4>
<p>To select rows from a data frame,
we use <code class="docutils literal notranslate"><span class="pre">df.loc[&lt;row&gt;,:]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">&lt;row&gt;</span></code> is the rows-index label
and <code class="docutils literal notranslate"><span class="pre">:</span></code> is shorthand for “all columns.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span>
<span class="n">row2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x        2.0
y        1.5
team       a
level      1
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>The rows of a data frame are Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects,
which are one-dimensional containers for data values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">row2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p>We’ll defer the discussion on <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects until the next section.
For now,
I just want you to know that series have an index property,
which tells you the labels you must use to access the values in the series.
The index of the series <code class="docutils literal notranslate"><span class="pre">row2</span></code> is the same as the columns index of the data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row2</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;x&#39;, &#39;y&#39;, &#39;team&#39;, &#39;level&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can access individual elements using these index labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row2</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5
</pre></div>
</div>
</div>
</div>
<p>If you need iterate through all the rows of the data frame,
you can use the <code class="docutils literal notranslate"><span class="pre">df.iterrows()</span></code> method as part of a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop.
For example, <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">idx,</span> <span class="pre">row</span> <span class="pre">in</span> <span class="pre">df.iterrows()</span></code>.</p>
</section>
<section id="selecting-entire-columns">
<h4>Selecting entire columns<a class="headerlink" href="#selecting-entire-columns" title="Link to this heading">#</a></h4>
<p>We use the syntax <code class="docutils literal notranslate"><span class="pre">df[&lt;col&gt;]</span></code> to select the column <code class="docutils literal notranslate"><span class="pre">&lt;col&gt;</span></code> from a data frame.
For example,
here is how to select the column <code class="docutils literal notranslate"><span class="pre">y</span></code> from the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">ys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    1.0
2    1.5
3    2.0
4    1.5
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The column <code class="docutils literal notranslate"><span class="pre">ys</span></code> is a Pandas series
and its index is the same as the data frame index <code class="docutils literal notranslate"><span class="pre">df.index</span> <span class="pre">=</span> <span class="pre">[0,1,2,3,4]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=5, step=1)
</pre></div>
</div>
</div>
</div>
<p>We can select individual values within the series <code class="docutils literal notranslate"><span class="pre">ys</span></code>
using the index labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5
</pre></div>
</div>
</div>
</div>
<p>The column-selector syntax <code class="docutils literal notranslate"><span class="pre">df[&lt;col&gt;]</span></code>
is shorthand for the expression <code class="docutils literal notranslate"><span class="pre">df.loc[:,&lt;col&gt;]</span></code>,
which means “select all the rows for the column <code class="docutils literal notranslate"><span class="pre">&lt;col&gt;</span></code>.”
We can verify that <code class="docutils literal notranslate"><span class="pre">df[&quot;y&quot;]</span></code> equals <code class="docutils literal notranslate"><span class="pre">df.loc[:,&quot;y&quot;]</span></code> using the <code class="docutils literal notranslate"><span class="pre">.equals()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>If you need iterate through all the columns of the data frame,
you can use the <code class="docutils literal notranslate"><span class="pre">df.items()</span></code> method in  a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop.
For example, <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">name,</span> <span class="pre">col</span> <span class="pre">in</span> <span class="pre">df.items()</span></code>.</p>
</section>
<section id="selecting-multiple-columns">
<h4>Selecting multiple columns<a class="headerlink" href="#selecting-multiple-columns" title="Link to this heading">#</a></h4>
<p>We can extract multiple columns from a data frame
by passing a list of column names inside the square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a new data frame object
that contains only the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> columns from the original <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
</section>
<section id="selecting-only-certain-rows">
<h4>Selecting only certain rows<a class="headerlink" href="#selecting-only-certain-rows" title="Link to this heading">#</a></h4>
<p>A common task when working with data frames is to select the rows that fit one or more criteria.
We usually carry out this selection procedure in two steps:</p>
<ul class="simple">
<li><p>Build a boolean “selection mask”
that contains the value <code class="docutils literal notranslate"><span class="pre">True</span></code> for the rows we want to keep,
and the value <code class="docutils literal notranslate"><span class="pre">False</span></code> for the rows we want to filter out.</p></li>
<li><p>Select the subset of rows from the data frame using the mask.
The result is a new data frame
that contains only the rows that correspond to the <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the selection mask.</p></li>
</ul>
<p>For example,
to select the rows from the data frame that are part of team <code class="docutils literal notranslate"><span class="pre">b</span></code>,
we first build the selection mask.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span>
<span class="n">mask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
3     True
4     True
Name: team, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>The rows that match the criterion “<code class="docutils literal notranslate"><span class="pre">team</span></code> column equal to <code class="docutils literal notranslate"><span class="pre">b</span></code>”
correspond to the <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the mask,
while the remaining values are <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>We can now select the desired subset by placing the mask inside the square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a new data frame that contains only the rows that correspond to the <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the <code class="docutils literal notranslate"><span class="pre">mask</span></code> series.</p>
<p>We often combine the two steps we described above
into a single expression <code class="docutils literal notranslate"><span class="pre">df[df[&quot;team&quot;]==&quot;b&quot;]</span></code>.
This combined expression is a little hard to read at first,
since it contains two pairs of square brackets and two occurrences of the data frame name <code class="docutils literal notranslate"><span class="pre">df</span></code>,
but you’ll get used to it,
since you’ll see selection expressions many times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use the Python bitwise boolean operators <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> (AND), <code class="docutils literal notranslate"><span class="pre">|</span></code> (OR) and <code class="docutils literal notranslate"><span class="pre">~</span></code> (NOT)
to build selection masks with multiple criteria.
For example,
to select the rows with <code class="docutils literal notranslate"><span class="pre">team</span></code> is <code class="docutils literal notranslate"><span class="pre">b</span></code> where the <code class="docutils literal notranslate"><span class="pre">x</span></code> value is greater or equal to 3,
we would use the following expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The selection mask consists of two terms <code class="docutils literal notranslate"><span class="pre">(df[&quot;team&quot;]==&quot;b&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">(df[&quot;x&quot;]&gt;=3)</span></code>
that are combined with the bitwise AND operator <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>.
Note the use of extra parentheses to ensure the masks for the two conditions are computed first before the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operation is applied.</p>
<p>If we want to select multiple values of a variable,
we can use the <code class="docutils literal notranslate"><span class="pre">.isin()</span></code> method and specify a list of values to compare with.
For example,
to build a mask that select all the observations that have <code class="docutils literal notranslate"><span class="pre">level</span></code> equal to <code class="docutils literal notranslate"><span class="pre">2</span></code> or <code class="docutils literal notranslate"><span class="pre">3</span></code>,
we can use the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     True
1     True
2    False
3     True
4     True
Name: level, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>We see the above mask correctly selects all observations except the one at index <code class="docutils literal notranslate"><span class="pre">2</span></code>,
which has <code class="docutils literal notranslate"><span class="pre">level</span></code> equal to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</section>
</section>
<section id="creating-data-frames-from-python-objects">
<h3>Creating data frames from Python objects<a class="headerlink" href="#creating-data-frames-from-python-objects" title="Link to this heading">#</a></h3>
<p>We sometimes obtain data in the form of regular Python objects like lists and dictionaries.
If we want to use Pandas functionality to work with this data,
we’ll need to “package” it as a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> object first.</p>
<p>One way to create a data frame object
is to load a Python dictionary whose keys are the column names,
and whose values are lists of the data in each column.
The code below shows how to create a data frame <code class="docutils literal notranslate"><span class="pre">df2</span></code>
by initializing a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> object from a columns dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dict_of_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
    <span class="s2">&quot;team&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
    <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict_of_columns</span><span class="p">)</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">df2</span></code>
is identical to the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> that we loaded from the CSV file earlier.
We can confirm this by calling the <code class="docutils literal notranslate"><span class="pre">.equals()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>We can also create a data frame from a list of observation records.
Each record (row) corresponds to the data of one observation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_records</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;team&quot;</span><span class="p">,</span> <span class="s2">&quot;level&quot;</span><span class="p">]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_of_records</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>When using the list-of-records approach,
Pandas can’t determine the names of the columns automatically,
so we pass in the list of column names as the <code class="docutils literal notranslate"><span class="pre">columns</span></code> argument.
The data frame <code class="docutils literal notranslate"><span class="pre">df3</span></code> created from the lists of records
is identical to the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> that saw earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>A third way to create a data frame is to pass in a list of dictionary objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_of_dicts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">team</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_of_dicts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once again,
the data frame <code class="docutils literal notranslate"><span class="pre">df4</span></code> we obtain in this way
is identical to the original <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-frames-exercises">
<h3>Data frames exercises<a class="headerlink" href="#data-frames-exercises" title="Link to this heading">#</a></h3>
<p>I invite you to try solving the following exercises
before continuing with the rest of the tutorial.</p>
<!-- In this section,
we illustrated the most common data frame manipulation techniques you might need.
but the Pandas library provides a lot more functionality.
If you were able to follow the code examples above
and are able to complete the exercises below,
then you're ready to continue with the rest of the book.
Deep knowledge of Pandas is not required for this book,
but it's super useful skill to develop for working with data in real-world projects. --><section id="exercise-1-select-a-column">
<h4>Exercise 1: Select a column<a class="headerlink" href="#exercise-1-select-a-column" title="Link to this heading">#</a></h4>
<p>Select the column that contains the variable <code class="docutils literal notranslate"><span class="pre">x</span></code> from the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instructions: write your Pandas code in this cell</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@titlesolution Exercise 1 select-xs-from-df</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.0
1    1.5
2    2.0
3    2.5
4    3.0
Name: x, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2-select-rows">
<h4>Exercise 2: Select rows<a class="headerlink" href="#exercise-2-select-rows" title="Link to this heading">#</a></h4>
<p>Select the rows from the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> that correspond to the players on team <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instructions: write your Pandas code in this cell</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@titlesolution Exercise 2 select-rows-from-df</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="series">
<h2>Series<a class="headerlink" href="#series" title="Link to this heading">#</a></h2>
<p>Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects are list-like containers of values.
The rows and the and the columns of a data frame are series objects.
Let’s extract the column <code class="docutils literal notranslate"><span class="pre">y</span></code> from the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>
and use it to illustrate the properties of methods of series objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">ys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    1.0
2    1.5
3    2.0
4    1.5
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The numbers printed on the left are the series <code class="docutils literal notranslate"><span class="pre">index</span></code>.
The numbers printed on the right are the <code class="docutils literal notranslate"><span class="pre">values</span></code> in the series.
The last line shows the series name and the data type of the values.
We can call the <code class="docutils literal notranslate"><span class="pre">.info()</span></code> method on the series <code class="docutils literal notranslate"><span class="pre">ys</span></code>
to display detailed information about it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
RangeIndex: 5 entries, 0 to 4
Series name: y
Non-Null Count  Dtype  
--------------  -----  
5 non-null      float64
dtypes: float64(1)
memory usage: 168.0 bytes
</pre></div>
</div>
</div>
</div>
<section id="series-properties">
<h3>Series properties<a class="headerlink" href="#series-properties" title="Link to this heading">#</a></h3>
<p>The series index tells us the labels we must use to access the values in the series.
The series <code class="docutils literal notranslate"><span class="pre">ys</span></code> has the same index as the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=5, step=1)
</pre></div>
</div>
</div>
</div>
<p>We can access the individual elements of the series
by specifying an index label inside square brackets.
The first element in the series is at index <code class="docutils literal notranslate"><span class="pre">0</span></code>,
so we access it as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<p>We can select a range of elements from the series
using the slice notation inside the square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.0
1    1.0
2    1.5
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The slice notation <code class="docutils literal notranslate"><span class="pre">0:3</span></code> refers to the list of indices <code class="docutils literal notranslate"><span class="pre">[0,1,2]</span></code>.
The result of <code class="docutils literal notranslate"><span class="pre">ys[0:3]</span></code> is a new series
that contains a subset of the original series
that contains the first three elements of <code class="docutils literal notranslate"><span class="pre">ys</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">values</span></code> attributes returns all the values stored in the series as a NumPy array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2. , 1. , 1.5, 2. , 1.5])
</pre></div>
</div>
</div>
</div>
</section>
<section id="series-calculations">
<h3>Series calculations<a class="headerlink" href="#series-calculations" title="Link to this heading">#</a></h3>
<p>Series have methods for performing common calculations.
For example,
the method <code class="docutils literal notranslate"><span class="pre">.count()</span></code> counts the number of values in the series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> counts the number of times each value occurs in the series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y
2.0    2
1.5    2
1.0    1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>You can perform arithmetic operations like <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>, <code class="docutils literal notranslate"><span class="pre">**</span></code> with series.
For example,
we can calculate the squared y-value plus 1 for each player
using the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    5.00
1    2.00
2    3.25
3    5.00
4    3.25
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can also apply arbitrary <code class="docutils literal notranslate"><span class="pre">numpy</span></code> functions to series.
For example,
here is how we can compute the square root of the y-values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.414214
1    1.000000
2    1.224745
3    1.414214
4    1.224745
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">.sum()</span></code> computes the sum of the values in the series.</p>
<!-- TODO: mention this is the same as SUM(\...) in Excel --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.0
</pre></div>
</div>
</div>
</div>
<p>We can calculate the arithmetic mean <span class="math notranslate nohighlight">\(\overline{y} = \frac{1}{5}\sum y_i\)</span>
of the values in the series <code class="docutils literal notranslate"><span class="pre">ys</span></code> by calling its <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># == ys.sum() / ys.count()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6
</pre></div>
</div>
</div>
</div>
<p>Series have numerous other methods for computing <em>summary statistics</em>
like <code class="docutils literal notranslate"><span class="pre">.min()</span></code>, <code class="docutils literal notranslate"><span class="pre">.max()</span></code>, <code class="docutils literal notranslate"><span class="pre">.median()</span></code>, <code class="docutils literal notranslate"><span class="pre">.std()</span></code>, etc.
The following table lists commonly used statistics method available on series.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method name</p></th>
<th class="head"><p>Descriptions</p></th>
<th class="head text-center"><p>Series</p></th>
<th class="head text-center"><p>DataFrame</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></td>
<td><p>count of non-null values</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code></p></td>
<td><p>mean (average)</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">median()</span></code></p></td>
<td><p>median</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std()</span></code></p></td>
<td><p>standard deviation</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">var()</span></code></p></td>
<td><p>variance</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">skew()</span></code></p></td>
<td><p>skewness</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kurt()</span></code></p></td>
<td><p>kurtosis</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min()</span></code></p></td>
<td><p>minimum value</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max()</span></code></p></td>
<td><p>maximum value</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">idxmin()</span></code></p></td>
<td><p>index label of the minimum</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">idxmax()</span></code></p></td>
<td><p>index label of the maximum</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quantile(q)</span></code></p></td>
<td><p>quantile function</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mode()</span></code></p></td>
<td><p>mode</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code></p></td>
<td><p>sum</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prod()</span></code></p></td>
<td><p>product</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">corr()</span></code></p></td>
<td><p>correlation</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cov()</span></code></p></td>
<td><p>covariance</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rank()</span></code></p></td>
<td><p>ranks</p></td>
<td class="text-center"><p>✓</p></td>
<td class="text-center"><p>✓</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.quantile(q)</span></code> method can be used to compute quartiles (use <code class="docutils literal notranslate"><span class="pre">q</span></code> multiple of 0.25)
and percentiles (use <code class="docutils literal notranslate"><span class="pre">q</span></code> multiple of 0.01).</p>
<p>The same methods are actually available on Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects.
For example,
we can compute the mean of all the numeric columns in the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>
by calling its <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x        2.0
y        1.6
level    2.4
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We used the option <code class="docutils literal notranslate"><span class="pre">numeric_only=True</span></code> to avoid computing the mean of the <code class="docutils literal notranslate"><span class="pre">team</span></code> column,
which is not numeric.
The results show the mean of the <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">level</span></code> columns packaged as a Pandas series.</p>
<p>Pandas also provides two methods
that allow us to compute several statistics at once.
Use the <code class="docutils literal notranslate"><span class="pre">.aggregate(&lt;list&gt;)</span></code> method to compute
multiple statistics specified as a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    5.0
sum      8.0
mean     1.6
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> computes a descriptive summary
that consists the standard descriptive statistics including
the mean,
the standard deviation,
and the five-number summary (min, Q1, Q2, Q2, max).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ys</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    5.00000
mean     1.60000
std      0.41833
min      1.00000
25%      1.50000
50%      1.50000
75%      2.00000
max      2.00000
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-pandas-series-from-python-lists">
<h3>Creating Pandas series from Python lists<a class="headerlink" href="#creating-pandas-series-from-python-lists" title="Link to this heading">#</a></h3>
<p>We sometimes create Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects from Python lists in order to benefit
all the calculation and aggregation methods available for series objects.
For example,
the code below creates a Pandas series
from a Python list of three numbers then computes their mean,
variance, and standard deviation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     5
1    10
2    15
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mean    10.0
var     25.0
std      5.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="series-exercises">
<h3>Series exercises<a class="headerlink" href="#series-exercises" title="Link to this heading">#</a></h3>
<section id="exercise-3">
<h4>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
<section id="exercise-4">
<h4>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
</section>
</section>
<section id="sorting-grouping-and-aggregation">
<h2>Sorting, grouping, and aggregation<a class="headerlink" href="#sorting-grouping-and-aggregation" title="Link to this heading">#</a></h2>
<section id="sorting-and-ranking">
<h3>Sorting and ranking<a class="headerlink" href="#sorting-and-ranking" title="Link to this heading">#</a></h3>
<p>We can sort the rows of the data frame based on the values of the column <code class="docutils literal notranslate"><span class="pre">&lt;col&gt;</span></code>
by calling the method <code class="docutils literal notranslate"><span class="pre">.sort_values(&lt;col&gt;)</span></code>.
For example,
here is how we can sort the data frame by <code class="docutils literal notranslate"><span class="pre">df</span></code> by the <code class="docutils literal notranslate"><span class="pre">team</span></code> column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The default behaviour of <code class="docutils literal notranslate"><span class="pre">.sort_values()</span></code> is to sort the values in ascending order.
We can use the option <code class="docutils literal notranslate"><span class="pre">ascending=False</span></code> to sort values in descending order.</p>
<p>Note the index in the sorted data frame is now out of order.
since the rows order is now based on the <code class="docutils literal notranslate"><span class="pre">level</span></code> column,
and not based on their index labels.
If we want the re-index the data frame,
we can call the method <code class="docutils literal notranslate"><span class="pre">.reset_index(drop=True)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can sort by multiple columns using the syntax <code class="docutils literal notranslate"><span class="pre">.sort_values([&quot;&lt;col1&gt;&quot;,&quot;&lt;col2&gt;&quot;])</span></code>,
which will sort the rows based the values of the column <code class="docutils literal notranslate"><span class="pre">&lt;col1&gt;</span></code> first then by <code class="docutils literal notranslate"><span class="pre">&lt;col2&gt;</span></code>.
For example,
to sort the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> by <code class="docutils literal notranslate"><span class="pre">y</span></code> then by <code class="docutils literal notranslate"><span class="pre">x</span></code>,
we would use the code <code class="docutils literal notranslate"><span class="pre">df.sort_values([&quot;y&quot;,&quot;x&quot;])</span></code>.</p>
<section id="ranking-values">
<h4>Ranking values<a class="headerlink" href="#ranking-values" title="Link to this heading">#</a></h4>
<p>We can obtain the sort-order of values in a data frame
by calling the <code class="docutils literal notranslate"><span class="pre">.rank()</span></code> method.
The <em>rank</em> of an element in a series tells us the position it appears in when the list is sorted.
Here is how to obtain the ranks of the <code class="docutils literal notranslate"><span class="pre">y</span></code>-values in the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    4.5
1    1.0
2    2.5
3    4.5
4    2.5
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This result tells us that value at index <code class="docutils literal notranslate"><span class="pre">1</span></code> is the smallest (first rank in ascending order).
The value <code class="docutils literal notranslate"><span class="pre">1.5</span></code> appears both at index <code class="docutils literal notranslate"><span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">4</span></code> so we have a tie.
The default method for dealing with ties,
is to assign the average of the two ranks to both values:
we assign the rank <code class="docutils literal notranslate"><span class="pre">2.5</span></code> to both of them (the average between second and third rank).
The last two values are also tied,
so we assign rank <code class="docutils literal notranslate"><span class="pre">4.5</span></code> to both of them.
You can obtain different way to handle ties
by passing the <code class="docutils literal notranslate"><span class="pre">method</span></code> option when calling <code class="docutils literal notranslate"><span class="pre">.rank()</span></code>.</p>
</section>
</section>
<section id="group-by-and-aggregation">
<h3>Group by and aggregation<a class="headerlink" href="#group-by-and-aggregation" title="Link to this heading">#</a></h3>
<p>A common calculation we need to perform in statistics
is to compare different <em>groups</em> of observations,
where the grouping is determined by the values in one of the columns.
The Pandas method <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> is used for this purpose.
For example,
we can group the observations in the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> by the value of the <code class="docutils literal notranslate"><span class="pre">team</span></code> variable using the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fef6a7fe020&gt;
</pre></div>
</div>
</div>
</div>
<p>The result of calling the <code class="docutils literal notranslate"><span class="pre">.groupby(&quot;team&quot;)</span></code> method is a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object
that contains the subsets of the data frame,
which correspond to the different values of the <code class="docutils literal notranslate"><span class="pre">team</span></code> variable.
The <code class="docutils literal notranslate"><span class="pre">.groupby(&quot;mean&quot;)</span></code> method starts
a parallel computation on the two subsets of rows:
the rows of the players from team <code class="docutils literal notranslate"><span class="pre">a</span></code> (<code class="docutils literal notranslate"><span class="pre">df[df[&quot;team&quot;]==&quot;a&quot;]</span></code>)
and rows of the players from team <code class="docutils literal notranslate"><span class="pre">b</span></code> (<code class="docutils literal notranslate"><span class="pre">df[df[&quot;team&quot;]==&quot;b&quot;]</span></code>).</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object to do further selection of variables and perform computations.
For example,
to compute the mean value of the <code class="docutils literal notranslate"><span class="pre">x</span></code> variable within the two groups,
we run the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>team
a    1.50
b    1.75
Name: y, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The result is a series containing the mean for the two groups.
The first row contains the value <code class="docutils literal notranslate"><span class="pre">df[df[&quot;team&quot;]==&quot;a&quot;][&quot;y&quot;].mean()</span></code>.
The second row’s value is <code class="docutils literal notranslate"><span class="pre">df[df[&quot;team&quot;]==&quot;b&quot;][&quot;y&quot;].mean()</span></code>.
Note the result is a series indexed by the values of the <code class="docutils literal notranslate"><span class="pre">team</span></code> variable (the team labels <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>).</p>
<p>We often call the <code class="docutils literal notranslate"><span class="pre">.aggregate()</span></code> method after the <code class="docutils literal notranslate"><span class="pre">goupyby()</span></code> method
to compute multiple statistics for the two groups.
For example,
to compute the count, the sum, and the mean value in each group
we use the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>3</td>
      <td>4.5</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2</td>
      <td>3.5</td>
      <td>1.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a data frame
whose rows correspond to values of the group-by variable <code class="docutils literal notranslate"><span class="pre">team</span></code>,
and whose columns are the statistics we wanted to calculate.</p>
</section>
<section id="sidenote-1-pandas-method-chaining">
<h3>Sidenote 1: Pandas method chaining<a class="headerlink" href="#sidenote-1-pandas-method-chaining" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> example we saw in the previous section
illustrates the “method chaining” pattern,
which is used often in Pandas calculations.
We can “chain” together any number of Pandas methods
to perform complicated data selection and aggregation operations.</p>
<p>We start with the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>,
call its <code class="docutils literal notranslate"><span class="pre">.goupyby()</span></code> method,
select the <code class="docutils literal notranslate"><span class="pre">y</span></code> column using the square brackets <code class="docutils literal notranslate"><span class="pre">[&quot;y&quot;]</span></code>,
then call the method <code class="docutils literal notranslate"><span class="pre">.aggregate()</span></code> on the result.
This is “chain” includes contains two methods,
but it is common to chain together three or more methods.
This ability to carry out data manipulations using a sequence of simple method applications
is one of the main benefits of using Pandas for data processing.
Method chaining operations work because Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>,
and <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> objects all offer the same methods,
so the output of one calculation can be fed into the next.</p>
</section>
<section id="sidenote-2-line-continuation-strategies">
<h3>Sidenote 2: Line-continuation strategies<a class="headerlink" href="#sidenote-2-line-continuation-strategies" title="Link to this heading">#</a></h3>
<p>When using method chaining,
the command chains tend to become very long
and often don’t fit on a single line of input.
We can split Pandas expressions on multiple lines
using the Python line-continuation character <code class="docutils literal notranslate"><span class="pre">\</span></code> (backslash),
as shown in the code example below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> \
  <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>count</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>4.5</td>
      <td>3</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3.5</td>
      <td>2</td>
      <td>1.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result of this code cell
is identical to the result we saw above,
however writing the code on two lines using the line-continuation character <code class="docutils literal notranslate"><span class="pre">\</span></code>
makes the operations are easier to read.
It is customary (but not required)
to indent the second line by a few spaces so the dots line up.
The indentation gives a visual appearance of a “bullet list”
of operation we apply to a data frame.</p>
<p>Another way to get the benefits of multi-line commands
is to wrap the entire expression in parentheses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span>
  <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">)[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
  <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sum</th>
      <th>count</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>4.5</td>
      <td>3</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3.5</td>
      <td>2</td>
      <td>1.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is identical to the result we obtained earlier.
This works because we’re allowed to wrap any Python expression in parentheses without changing its value.
We do this wrapping
because newlines are ignored inside parentheses,
so we’re allowed to break the expression onto multiple lines
without the need to add the character <code class="docutils literal notranslate"><span class="pre">\</span></code> at the end of each line.</p>
<p>Don’t worry too much about the line-continuation and parentheses tricks for multi-line expressions.
Most of the Pandas expressions you’ll see in this tutorial will fit on a single line,
but I wanted to show you some multi-line expressions,
so you won’t be wondering what is going on if you see it.</p>
</section>
<section id="counting-values">
<h3>Counting values<a class="headerlink" href="#counting-values" title="Link to this heading">#</a></h3>
<p>We’re often interested in the counts (frequencies)
of different values that occur in a particular column.
The <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> can do this counting for us.
For example,
here is how we can count the number of players on each team.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>team
a    3
b    2
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The is sometimes called a one-way table
or a frequency table.</p>
<p>We can also count combinations of values,
which is called a two-way table.
We can obtain a two-way table y calling the Pandas function <code class="docutils literal notranslate"><span class="pre">pd.crosstab</span></code>
and specifying which variable we want to use for the <code class="docutils literal notranslate"><span class="pre">index</span></code>
and which variable we want to use as the <code class="docutils literal notranslate"><span class="pre">columns</span></code> of the resulting table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">],</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>level</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>See Section 1.3.4 in the book,
for additional examples of the <code class="docutils literal notranslate"><span class="pre">pd.crosstab</span></code> function,
including different use cases of the options <code class="docutils literal notranslate"><span class="pre">margin</span></code> and <code class="docutils literal notranslate"><span class="pre">normalize</span></code>.</p>
</section>
<section id="using-pivot-table-for-aggregation">
<h3>Using <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> for aggregation<a class="headerlink" href="#using-pivot-table-for-aggregation" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.pivot_table(...)</span></code> method produces a spreadsheet-style pivot table
that shows aggregated values, grouped into rows and columns that correspond to categorical columns in the data.
To produce the pivot table must specify:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code>: the column to be aggregated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aggfunc</span></code>: the function used to aggregate the values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>: the variable to group by for the pivot table rows</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columns</span></code>: the variable to group by for the pivot table columns</p></li>
</ul>
<p>For example,
the following code produces a pivot table
that display the average <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinates,
for different teams (rows) and different levels (columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
               <span class="n">index</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">,</span>
               <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>level</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>team</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>2.00</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sorting-and-aggregation-exercises">
<h3>Sorting and aggregation exercises<a class="headerlink" href="#sorting-and-aggregation-exercises" title="Link to this heading">#</a></h3>
<section id="exercise-5">
<h4>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
<section id="exercise-6">
<h4>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h4>
<p>TODO</p>
<p><a name="Data-transformations"></a></p>
</section>
</section>
</section>
<section id="data-transformations">
<h2>Data transformations<a class="headerlink" href="#data-transformations" title="Link to this heading">#</a></h2>
<p>Pandas provides dozens of methods for modifying the shape,
the index, the columns, and the data types of data frames.
Below is a list of common data transformations
that you’re likely to encounter when  preparing datasets for statistical analysis.</p>
<ul class="simple">
<li><p><strong>Renaming</strong> the column names of a data frame.</p></li>
<li><p><strong>Reshaping and restructuring</strong> the way the data is organized.</p></li>
<li><p><strong>Imputation</strong>: filling in missing values based on the surrounding data or a fixed constant.</p></li>
<li><p><strong>Merging</strong> data from multiple sources.</p></li>
<li><p><strong>Filtering</strong> to select the subset of the data we’re interested in.</p></li>
<li><p><strong>Splitting up</strong> columns that contain multiple values.</p></li>
<li><p><strong>Data cleaning</strong> procedures for identifying and correcting bad data.
Data cleaning procedures include dealing with missing values, outliers,
coding errors, duplicate observations, and other inconsistencies in the data.</p></li>
</ul>
<p>In this section,
we’ll show examples of the most common data frame transformations,
and defer the data cleaning and outlier detection topics until the next section.</p>
<section id="adding-new-columns">
<h3>Adding new columns<a class="headerlink" href="#adding-new-columns" title="Link to this heading">#</a></h3>
<p>We can add a new column to a data frame
by assigning data to a new column name as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_with_xy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_with_xy</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
<span class="n">df_with_xy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
      <th>xy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The first line makes a copy of the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>
and saves it as a new variable called <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>.
The second line computes the product of the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> columns from the original <code class="docutils literal notranslate"><span class="pre">df</span></code>
and assigns the result to a new column named <code class="docutils literal notranslate"><span class="pre">xy</span></code> in <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>.
We then display the modified data frame <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>
to show the presence the additional column.</p>
</section>
<section id="avoiding-in-place-modifications">
<h3>Avoiding in-place modifications<a class="headerlink" href="#avoiding-in-place-modifications" title="Link to this heading">#</a></h3>
<p>The code example above follows best practices for variable naming:
it uses a different variable name for the modified data frame.
The new variable name <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>
makes it clear this is a modified data frame
and not the same as the original <code class="docutils literal notranslate"><span class="pre">df</span></code>,
which remains unchanged.
Following this naming convention
makes your code easier to reason about
and avoids many kinds of confusion.
This convention is particularly important in notebook environments,
where code cells can be executed out of order.</p>
<p>Suppose we didn’t follow the convention,
and instead added the column <code class="docutils literal notranslate"><span class="pre">xy</span></code> to the original <code class="docutils literal notranslate"><span class="pre">df</span></code>.
In other words,
we’re modifying the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> without changing its name.
In this case,
we would need to keep track of which “version” of <code class="docutils literal notranslate"><span class="pre">df</span></code>
we’re working with in each code cell.
In all the earlier code cells,
the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> had columns <code class="docutils literal notranslate"><span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;y&quot;,</span> <span class="pre">&quot;team&quot;,</span> <span class="pre">&quot;level&quot;]</span></code>,
while later on <code class="docutils literal notranslate"><span class="pre">df</span></code> has columns <code class="docutils literal notranslate"><span class="pre">[&quot;x&quot;,</span> <span class="pre">&quot;y&quot;,</span> <span class="pre">&quot;team&quot;,</span> <span class="pre">&quot;level&quot;,</span> <span class="pre">&quot;xy&quot;]</span></code>.
Keeping track of different “versions” of <code class="docutils literal notranslate"><span class="pre">df</span></code> adds unnecessary cognitive load,
so it’s best if we can avoid it:
use different names for different objects!</p>
<p>The good news is that most of the Pandas transformation methods
do not modify data frames,
but instead return a new data frame,
so you don’t have to manually do the <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> operation.
You just have to remember to save the transformed version of the data frame as a new variable.</p>
<!--
This in-place modification can lead to confusion,
since they force us to keep track of the history of operations we performed on `df`. --></section>
<section id="the-assign-method">
<h3>The <code class="docutils literal notranslate"><span class="pre">assign</span></code> method<a class="headerlink" href="#the-assign-method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method is another way to add new columns to a data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_with_xy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">xy</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method returns a new data frame without modifying the original <code class="docutils literal notranslate"><span class="pre">df</span></code>.
We save the result to a new variable <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>,
so the end result
is the same as the data frame <code class="docutils literal notranslate"><span class="pre">df_with_xy</span></code>
that we obtained earlier using the copy-then-modify approach.</p>
<p>The main reason for using the <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> method
is because it allows us to perform multiple transformations at once
by using the method chaining pattern.
The following example shows how we can perform four different transformation
to the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> in a single statement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">xy</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span> \
  <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> \
  <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">team</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
      <th>xy</th>
      <th>z</th>
      <th>r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>A</td>
      <td>3</td>
      <td>2.0</td>
      <td>1</td>
      <td>2.236068</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>A</td>
      <td>2</td>
      <td>1.5</td>
      <td>1</td>
      <td>1.802776</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>A</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>B</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.201562</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>B</td>
      <td>3</td>
      <td>4.5</td>
      <td>1</td>
      <td>3.354102</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The effect of the first <code class="docutils literal notranslate"><span class="pre">.assign()</span></code> operation
is to add the new column <code class="docutils literal notranslate"><span class="pre">xy</span></code> that contains the product of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> values.
The second operation adds a new constant column <code class="docutils literal notranslate"><span class="pre">z</span></code> equal to <code class="docutils literal notranslate"><span class="pre">1</span></code>.
The third operation adds the column <code class="docutils literal notranslate"><span class="pre">r</span></code>
computed from the formula <span class="math notranslate nohighlight">\(r = \sqrt{x^2 + y^2}\)</span>,
which is the distance between the point with coordinates <span class="math notranslate nohighlight">\((x,y)\)</span> and the origin.
Note we used the function <code class="docutils literal notranslate"><span class="pre">np.sqrt</span></code> from the NumPy module
to perform the square root operation.
The last assignment operation
transforms the values in the <code class="docutils literal notranslate"><span class="pre">team</span></code> column to uppercase.</p>
</section>
<section id="the-apply-method">
<h3>The <code class="docutils literal notranslate"><span class="pre">apply</span></code> method<a class="headerlink" href="#the-apply-method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.apply()</span></code> method allows you to apply a function
to every row or every column in the data frame.
The following example shows how
we can perform four transformations
by applying a function on each row of the data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">four_ops</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">row</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">row</span>

<span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">four_ops</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
      <th>xy</th>
      <th>z</th>
      <th>r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>A</td>
      <td>3</td>
      <td>2.0</td>
      <td>1</td>
      <td>2.236068</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>A</td>
      <td>2</td>
      <td>1.5</td>
      <td>1</td>
      <td>1.802776</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>A</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>B</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.201562</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>B</td>
      <td>3</td>
      <td>4.5</td>
      <td>1</td>
      <td>3.354102</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="dropping-rows-and-and-columns">
<h3>Dropping rows and and columns<a class="headerlink" href="#dropping-rows-and-and-columns" title="Link to this heading">#</a></h3>
<p>Pandas provides several methods for removing rows and columns of a data frame.
For example,
to drop the first (index 0), third (index 2), and fifth (index 4) rows of the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>
we can use the <code class="docutils literal notranslate"><span class="pre">.drop()</span></code> method and pass in the list of indices to remove as the <code class="docutils literal notranslate"><span class="pre">index</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a new data frame
that contains only the second row (index <code class="docutils literal notranslate"><span class="pre">1</span></code>)
and the fourth row (index <code class="docutils literal notranslate"><span class="pre">3</span></code>).</p>
<p>To remove columns from a data frame,
use <code class="docutils literal notranslate"><span class="pre">.drop()</span></code> method with the <code class="docutils literal notranslate"><span class="pre">columns</span></code> option.
Here is the code to delete the column <code class="docutils literal notranslate"><span class="pre">level</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a new data frame that no longer has the <code class="docutils literal notranslate"><span class="pre">level</span></code> column.
An alternative way to obtain the same result
is to select the three columns
that we want to keep using the code <code class="docutils literal notranslate"><span class="pre">df[[&quot;x&quot;,</span> <span class="pre">&quot;y&quot;,</span> <span class="pre">&quot;team&quot;]]</span></code>.</p>
<p>Pandas also provides the methods <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> for removing rows that contain missing values
and <code class="docutils literal notranslate"><span class="pre">.drop_duplicates()</span></code> for removing rows that contain duplicate data.
We’ll learn more about these methods in the section on data cleaning later on.</p>
</section>
<section id="renaming-columns-and-values">
<h3>Renaming columns and values<a class="headerlink" href="#renaming-columns-and-values" title="Link to this heading">#</a></h3>
<p>To change the column names of a data frame,
we can use the <code class="docutils literal notranslate"><span class="pre">.rename()</span></code> method and pass in to the <code class="docutils literal notranslate"><span class="pre">columns</span></code> argument
a Python dictionary of the replacements we want to make.
For example,
the code below renames the columns names <code class="docutils literal notranslate"><span class="pre">team</span></code> and <code class="docutils literal notranslate"><span class="pre">level</span></code> to uppercase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;TEAM&quot;</span><span class="p">,</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;LEVEL&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>TEAM</th>
      <th>LEVEL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dictionary <code class="docutils literal notranslate"><span class="pre">{&quot;team&quot;:&quot;TEAM&quot;,</span> <span class="pre">&quot;level&quot;:&quot;LEVEL&quot;}</span></code> specifies the <code class="docutils literal notranslate"><span class="pre">old:new</span></code> replacement pairs
for the column names.</p>
<p>To rename the values in the data frame,
we can use the <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> method,
passing in a Python dictionary of replacements
that we want to perform on the values in each column.
For example,
here is the code for replacing the values in the <code class="docutils literal notranslate"><span class="pre">team</span></code> column to uppercase letters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">team_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="s2">&quot;B&quot;</span><span class="p">}</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;team&quot;</span><span class="p">:</span><span class="n">team_mapping</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>A</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>B</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>B</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The dictionary <code class="docutils literal notranslate"><span class="pre">{&quot;a&quot;:&quot;A&quot;,</span> <span class="pre">&quot;b&quot;:&quot;B&quot;}</span></code> specifies the <code class="docutils literal notranslate"><span class="pre">old:new</span></code> replacement pairs
specifies the <code class="docutils literal notranslate"><span class="pre">old:new</span></code> replacement pairs for the values.</p>
</section>
<section id="reshaping-data-frames">
<h3>Reshaping data frames<a class="headerlink" href="#reshaping-data-frames" title="Link to this heading">#</a></h3>
<p>One of the most common transformations we need to do with data frames,
is to convert them from “wide” format to “long” format.
Data tables in “wide” format contain multiple observations in each row,
with the column headers conveying some information about the observations in the different columns.
The code example below shows a sample data frame with the viewership numbers for a TV show
organized by season (rows) and by episode (columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">views_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Season 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Season 2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Episode 1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
    <span class="s2">&quot;Episode 2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">],</span>
    <span class="s2">&quot;Episode 3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">tvwide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">views_data</span><span class="p">)</span>
<span class="n">tvwide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>Episode 1</th>
      <th>Episode 2</th>
      <th>Episode 3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Season 1</td>
      <td>1000</td>
      <td>2000</td>
      <td>3000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Season 2</td>
      <td>10000</td>
      <td>20000</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This organizational structure is very commonly used
for data entered manually into in a spreadsheet,
since it’s easy for humans to interpret values based on the columns they appear in.
However,
working with datasets complicates data selection, grouping, and filtering operations.
Data scientists and statisticians prefer to work with “long” format datasets,
where each row corresponds to a single observation,
and each column corresponds to a single variable,
like the <code class="docutils literal notranslate"><span class="pre">minimal</span></code> dataset we discussed earlier.</p>
<p>The Pandas operation for converting “wide” data to “long” data is called <code class="docutils literal notranslate"><span class="pre">melt</span></code>,
which is an analogy to melting a wide block of ice into a vertical stream of water.
The method <code class="docutils literal notranslate"><span class="pre">.melt()</span></code> requires several arguments
to specify how to treat each of the columns in the input data frame,
and the names we want to assign to the columns in the output data frame.
Let’s look at the code example first,
and explain the arguments after.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tvlong</span> <span class="o">=</span> <span class="n">tvwide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">],</span>
                     <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;episode&quot;</span><span class="p">,</span>
                     <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;views&quot;</span><span class="p">)</span>
<span class="n">tvlong</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>episode</th>
      <th>views</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Season 1</td>
      <td>Episode 1</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Season 2</td>
      <td>Episode 1</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season 1</td>
      <td>Episode 2</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Season 2</td>
      <td>Episode 2</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Season 1</td>
      <td>Episode 3</td>
      <td>3000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Season 2</td>
      <td>Episode 3</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">id_vars</span></code> specifies the column that contain identifier variables for each row,
which is the column <code class="docutils literal notranslate"><span class="pre">season</span></code> in the data frame <code class="docutils literal notranslate"><span class="pre">tvwide</span></code>.
All other columns are treated as “value variables”
that identify the properties of all the values in that column.
In the above example,
the values variables are the columns <code class="docutils literal notranslate"><span class="pre">Episode</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">Episode</span> <span class="pre">2</span></code>, and <code class="docutils literal notranslate"><span class="pre">Episode</span> <span class="pre">3</span></code>.
The argument <code class="docutils literal notranslate"><span class="pre">var_name</span></code> allows us to choose the name for the variable
that is represented in the different columns,
which we set to the descriptive name <code class="docutils literal notranslate"><span class="pre">episode</span></code>.
Finally,
the <code class="docutils literal notranslate"><span class="pre">value_name</span></code> argument determines name of the value column in the melted data frame,
which we set to <code class="docutils literal notranslate"><span class="pre">views</span></code> since this what the numbers represent.</p>
<p>The result <code class="docutils literal notranslate"><span class="pre">tvlong</span></code> has six rows,
one for each observation in the original data frame <code class="docutils literal notranslate"><span class="pre">tvwide</span></code>.
Each row in <code class="docutils literal notranslate"><span class="pre">tvlong</span></code> corresponds to one episode of the TV show,
and each column corresponds to a different variable for that episode
(the season, the episode, and the number of views).</p>
<p>The rows in the data frame <code class="docutils literal notranslate"><span class="pre">tvlong</span></code>
have are ordered strangely after the melt operation.
It would make more sense
for the all the <code class="docutils literal notranslate"><span class="pre">Season</span> <span class="pre">1</span></code> episodes to appear first,
followed by <code class="docutils literal notranslate"><span class="pre">Season</span> <span class="pre">2</span></code>.
We can fix the sort order
by calling the <code class="docutils literal notranslate"><span class="pre">.sort_values()</span></code> method
and specifying the column names by which we want the data to be sorted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tvlong</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">,</span> <span class="s2">&quot;episode&quot;</span><span class="p">])</span> \
      <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>episode</th>
      <th>views</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Season 1</td>
      <td>Episode 1</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Season 1</td>
      <td>Episode 2</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Season 1</td>
      <td>Episode 3</td>
      <td>3000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Season 2</td>
      <td>Episode 1</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Season 2</td>
      <td>Episode 2</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Season 2</td>
      <td>Episode 3</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The data is now sorted by season first then by episode,
which is the natural order for this data.
The also called the method <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code>
to re-index the rows using the sequential numbering
according to the new sort order.</p>
</section>
<section id="tidy-data">
<h3>Tidy data<a class="headerlink" href="#tidy-data" title="Link to this heading">#</a></h3>
<p>The concept of <em>tidy data</em> is a convention for structuring datasets
that makes them easy to work with.
A tidy dataset has the following characteristics:</p>
<ol class="arabic simple">
<li><p>Each column contains the values for one variable.</p></li>
<li><p>Each row contains the values for one observation.</p></li>
<li><p>Each data cell contains a single value.</p></li>
</ol>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">tvlong</span></code> we saw in the previous has all three characteristics:
each column contains a different variable,
each row contains the data for one episode,
and each cell contains one piece of information.
In contrast,
the data frame <code class="docutils literal notranslate"><span class="pre">tvwide</span></code> is not tidy data,
since each row contains the information from three episodes.</p>
<p>An example of a cell that contains multiple values
would be the case where age and gender are stored together,
where the code <code class="docutils literal notranslate"><span class="pre">32F</span></code> would indicate a 32 year old female.
This is not tidy and will complicate all selection and filtering procedures.
It would be preferable to store age and sex as two separate columns,
and put the values <code class="docutils literal notranslate"><span class="pre">32</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span></code> in the corresponding columns.</p>
<p>The <em>tidy data</em> convention for organizing datasets
makes it easy to select subsets of the data based on values of different columns,
and perform arbitrary transformations, groupings, and aggregations.
For example,
the data frame <code class="docutils literal notranslate"><span class="pre">tvlong</span></code> allows us filter and group views
based on any combination of the <code class="docutils literal notranslate"><span class="pre">season</span></code> and <code class="docutils literal notranslate"><span class="pre">episode</span></code> variables.</p>
<!-- which are the bread an butter for any statistical analysis -->
<p>Another reason for working with <em>tidy data</em>
is that it makes data visualization easier.
We can create advanced Seaborn plots by simply mapping
column names to different attributes of the graphs
like x- and y-positions, colors, sizes, and marker types.
We’ll learn more about this in the <a class="reference internal" href="#./seaborn_tutorial.ipynb"><span class="xref myst"><strong>Seaborn tutorial</strong></span></a> (Appendix E).</p>
<p>Perhaps the biggest reason behind the popularity of the <em>tidy data</em> convention
is that it standardizes the formatting of datasets.
When starting to work on a new tidy dataset,
you don’t waste any time trying to understand how the data is structured,
since you know all the variables are in different columns,
and each row corresponds to a different observation.</p>
<blockquote>
<div><p>“Tidy datasets are all alike, but every messy dataset is messy in its own way.” —Hadley Wickham</p>
</div></blockquote>
<p>Indeed,
whenever encountering datasets that are don’t have the <em>tidy data</em> characteristics,
data scientist will first spend the tidying it up.</p>
</section>
<section id="string-methods">
<h3>String methods<a class="headerlink" href="#string-methods" title="Link to this heading">#</a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">.str</span></code> prefix to access string manipulation methods like
<code class="docutils literal notranslate"><span class="pre">.str.split()</span></code>, <code class="docutils literal notranslate"><span class="pre">.str.startswith()</span></code>, <code class="docutils literal notranslate"><span class="pre">.str.strip()</span></code>, etc.
Any operation that you can perform on a Python string,
you can also perform on Pandas series by calling the appropriate <code class="docutils literal notranslate"><span class="pre">str</span></code>-method.
For example,
suppose we have a data frame <code class="docutils literal notranslate"><span class="pre">ppl_df</span></code>
with a column <code class="docutils literal notranslate"><span class="pre">agesex</span></code> that contain the age and sex information as a single string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ppl_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;names&quot;</span><span class="p">:</span>  <span class="p">[</span><span class="s2">&quot;Jane&quot;</span><span class="p">,</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Jill&quot;</span><span class="p">],</span>
    <span class="s2">&quot;agesex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;32F&quot;</span><span class="p">,</span>  <span class="s2">&quot;20M&quot;</span><span class="p">,</span>  <span class="s2">&quot;21F&quot;</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">ppl_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>agesex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jane</td>
      <td>32F</td>
    </tr>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>20M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jill</td>
      <td>21F</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can split the <code class="docutils literal notranslate"><span class="pre">agesex</span></code> column into separate <code class="docutils literal notranslate"><span class="pre">age</span></code> with <code class="docutils literal notranslate"><span class="pre">sex</span></code> columns
using the following code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ages</span> <span class="o">=</span> <span class="n">ppl_df</span><span class="p">[</span><span class="s2">&quot;agesex&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">sexes</span> <span class="o">=</span> <span class="n">ppl_df</span><span class="p">[</span><span class="s2">&quot;agesex&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ppl_df2</span> <span class="o">=</span> <span class="n">ppl_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;agesex&quot;</span><span class="p">])</span>
<span class="n">ppl_df2</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ages</span>
<span class="n">ppl_df2</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sexes</span>
<span class="n">ppl_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>names</th>
      <th>age</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jane</td>
      <td>32</td>
      <td>F</td>
    </tr>
    <tr>
      <th>1</th>
      <td>John</td>
      <td>20</td>
      <td>M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jill</td>
      <td>21</td>
      <td>F</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another way to extract the two values would
be to use the <code class="docutils literal notranslate"><span class="pre">.str.extract()</span></code> method
with a regular expression <code class="docutils literal notranslate"><span class="pre">.str.extract(&quot;(?P&lt;age&gt;\\d*)(?P&lt;sex&gt;[MF])&quot;)</span></code>.</p>
</section>
<section id="merging-data-frames">
<h3>Merging data frames<a class="headerlink" href="#merging-data-frames" title="Link to this heading">#</a></h3>
<p>We sometimes need to combine data from multiple data frames.
For example,
suppose we’re given a data frame <code class="docutils literal notranslate"><span class="pre">levels_info</span></code> with additional info about
the game characters’ life and power depending their level in the game.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># levels_info table (one row per level)</span>
<span class="n">levels_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;lvl&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s2">&quot;life&quot;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
    <span class="s2">&quot;power&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">20</span><span class="p">,</span>  <span class="mi">30</span><span class="p">],</span>
<span class="p">})</span>
<span class="n">levels_info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lvl</th>
      <th>life</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>100</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>200</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>300</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can add this information
to the players data frame <code class="docutils literal notranslate"><span class="pre">df</span></code>
by calling the method <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code>.
We link the information in the two data frames
by matching between the <code class="docutils literal notranslate"><span class="pre">level</span></code> column in <code class="docutils literal notranslate"><span class="pre">df</span></code>
and the <code class="docutils literal notranslate"><span class="pre">lvl</span></code> column in the <code class="docutils literal notranslate"><span class="pre">levels_info</span></code> data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">levels_info</span><span class="p">,</span>
         <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;level&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;lvl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
      <th>lvl</th>
      <th>life</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
      <td>3</td>
      <td>300</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
      <td>2</td>
      <td>200</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
      <td>1</td>
      <td>100</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
      <td>3</td>
      <td>300</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
      <td>3</td>
      <td>300</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Another method for combining data frames include <code class="docutils literal notranslate"><span class="pre">df.join()</span></code>
which uses the index to matches the rows based data frames.</p>
</section>
<section id="concatenating-data-frames">
<h3>Concatenating data frames<a class="headerlink" href="#concatenating-data-frames" title="Link to this heading">#</a></h3>
<p>Sometimes we need to extend a data frame by adding a new row of observations.
We can use the <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> function to concatenate two data frames,
as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">}])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">new_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>b</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="data-type-conversions">
<h3>Data type conversions<a class="headerlink" href="#data-type-conversions" title="Link to this heading">#</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">.astype</span></code> allows us to transform a column into a different data type.
For example,
the <code class="docutils literal notranslate"><span class="pre">level</span></code> column in the data frame <code class="docutils literal notranslate"><span class="pre">df</span></code> has data type <code class="docutils literal notranslate"><span class="pre">int64</span></code>,
which stores integers as 64 bits.
Using <code class="docutils literal notranslate"><span class="pre">int64</span></code> allows us to store very large values,
but this is excessive given the largest number we store in this column is <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
<p>If we convert the column <code class="docutils literal notranslate"><span class="pre">level</span></code> to data type <code class="docutils literal notranslate"><span class="pre">int8</span></code>,
it will take up eight times less space.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    3
1    2
2    1
3    3
4    3
Name: level, dtype: int8
</pre></div>
</div>
</div>
</div>
</section>
<section id="one-hot-and-dummy-coding-for-categorical-variables">
<h3>One-hot and dummy coding for categorical variables<a class="headerlink" href="#one-hot-and-dummy-coding-for-categorical-variables" title="Link to this heading">#</a></h3>
<p>We often need to convert categorical variables into numerical values
to use them in statistics and machine learning models.
The key idea is to represent the different values as separate columns
that contain indicator variables.
An <em>indicator variable</em> <span class="math notranslate nohighlight">\(\texttt{var}_{\texttt{val}}\)</span>
is a variable that is equal to <span class="math notranslate nohighlight">\(1\)</span>
when the categorical variable <code class="docutils literal notranslate"><span class="pre">var</span></code> has the value <code class="docutils literal notranslate"><span class="pre">val</span></code>,
else is equal to <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>The <em>one-hot encoding</em> of a categorical variable with <span class="math notranslate nohighlight">\(K\)</span> possible values
requires <span class="math notranslate nohighlight">\(K\)</span> different columns,
named after the value they encode.
The Pandas function <code class="docutils literal notranslate"><span class="pre">pd.get_dummies()</span></code> performs this encoding.
For example,
the one-hot encoding of the variable <code class="docutils literal notranslate"><span class="pre">team</span></code> looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">],</span>
               <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
               <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_a</th>
      <th>team_b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The column <code class="docutils literal notranslate"><span class="pre">team_a</span></code> contains indicator variable <span class="math notranslate nohighlight">\(\texttt{team}_{\texttt{a}}\)</span>,
which is <code class="docutils literal notranslate"><span class="pre">1</span></code> whenever the <code class="docutils literal notranslate"><span class="pre">team</span></code> variable has value <code class="docutils literal notranslate"><span class="pre">a</span></code>, and is <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
The column <code class="docutils literal notranslate"><span class="pre">team_b</span></code> contains the indicator variable <span class="math notranslate nohighlight">\(\texttt{team}_{\texttt{b}}\)</span>.
The name <em>one-hot encoding</em> comes from the observation there is only a single <code class="docutils literal notranslate"><span class="pre">1</span></code> per row.</p>
<p>A commonly used variant of the one-hot encoding scheme is <em>dummy coding</em>,
which treats the first value of a categorical variable as the “reference” value,
and uses indicator variables to represent the other levels.
When using <em>dummy coding</em>,
a categorical variable with <span class="math notranslate nohighlight">\(K\)</span> possible values
gets encoded into <span class="math notranslate nohighlight">\(K-1\)</span> columns.
Passing the option <code class="docutils literal notranslate"><span class="pre">drop_first</span></code> to the <code class="docutils literal notranslate"><span class="pre">pd.get_dummies()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;team&quot;</span><span class="p">],</span>
               <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
               <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;team&quot;</span><span class="p">,</span>
               <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team_b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The rows where <code class="docutils literal notranslate"><span class="pre">team_b</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code> indicate the variable <code class="docutils literal notranslate"><span class="pre">team</span></code> has its reference value,
which is <code class="docutils literal notranslate"><span class="pre">a</span></code>.
In statistics,
we use this dummy coding
when fitting linear regression models with categorical predictors,
which is discussed in <a class="reference internal" href="#../notebooks/44_regression_with_categorical_predictors.ipynb"><span class="xref myst">Section 4.4</span></a>.</p>
</section>
<section id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Link to this heading">#</a></h3>
<p>The <em>transpose</em> transformation flips a data frame through the diagonal,
turning the rows into columns, and columns into rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfT</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">dfT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>2.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>y</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.5</td>
      <td>2.0</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>team</th>
      <td>a</td>
      <td>a</td>
      <td>a</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <th>level</th>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>After the transpose operation,
the rows index <code class="docutils literal notranslate"><span class="pre">df.index</span></code> becomes the columns index <code class="docutils literal notranslate"><span class="pre">dfT.columns</span></code>,
while the columns index <code class="docutils literal notranslate"><span class="pre">df.columns</span></code>
becomes the rows index <code class="docutils literal notranslate"><span class="pre">dfT.index</span></code>.</p>
<p>I hope the above examples gave you some idea of the transformations
that we can apply to data frames.
Try solving the exercises to practice your new skills.</p>
</section>
<section id="transformation-exercises">
<h3>Transformation exercises<a class="headerlink" href="#transformation-exercises" title="Link to this heading">#</a></h3>
<section id="exercise-7">
<h4>Exercise 7<a class="headerlink" href="#exercise-7" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
<section id="exercise-8">
<h4>Exercise 8<a class="headerlink" href="#exercise-8" title="Link to this heading">#</a></h4>
<p>TODO</p>
<p><a name="Data-cleaning"></a></p>
</section>
</section>
</section>
<section id="data-cleaning">
<h2>Data cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h2>
<p>The term <em>data cleaning</em> describes the various procedures
that we do to prepare datasets for statistical analysis.
Data cleaning steps include fixing typos and coding errors,
removing duplicate observations, detecting outliers,
and correcting inconsistencies in the data.
These data cleaning steps are essential
for the validity of all the subsequent analysis you might perform on this data.
We need to make sure that the statistical calculations will not “choke” on the data,
or produce erroneous results.</p>
<p>We can conceptualize data cleaning as starting from a “raw” dataset
and transforming it into a “clean” dataset through a sequence
operations like renaming variables, replacing values, changing data types,
dropping duplicates, filtering outliers, etc.
Data cleaning is often the most time consuming part of any data job,
and it is definitely not glamorous work, but you must get used to it.
The only datasets that don’t require cleaning are the ones created for educational purposes.
Most real-world datasets you download from the internet or use at work
will needs some cleaning before they can be used.
Luckily,
Pandas provides lots of helper functions that make data cleaning a breeze.</p>
<section id="standardize-categorical-values">
<h3>Standardize categorical values<a class="headerlink" href="#standardize-categorical-values" title="Link to this heading">#</a></h3>
<p>A very common problem that occurs for categorical variables
is the use of multiple codes to represent the same concept.
Consider the following series containing what-type-of-pet-is-it data
in which “dog” is encoded using four different labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;Dog&quot;</span><span class="p">,</span> <span class="s2">&quot;doggo&quot;</span><span class="p">])</span>
<span class="n">pets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        D
1      dog
2      Dog
3    doggo
dtype: object
</pre></div>
</div>
</div>
</div>
<p>This type of inconsistent encoding will cause lots of trouble down the line.
For example,
performing a <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> operation on this variable will result in four different groups,
even though all these pets are dogs.</p>
<p>We can fix this encoding problem by standardizing on a single code for representing dogs
and replacing all other values with the standardized code,
as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dogsubs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;D&quot;</span><span class="p">:</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;Dog&quot;</span><span class="p">:</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;doggo&quot;</span><span class="p">:</span><span class="s2">&quot;dog&quot;</span><span class="p">}</span>
<span class="n">pets</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">dogsubs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    dog
1    dog
2    dog
3    dog
dtype: object
</pre></div>
</div>
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">.value_counts()</span></code> is helpful for detecting coding errors and inconsistencies.
Looking at the counts of how many times each value occurs can help us notice exceptional values,
near-duplicates, and other problems with categorical variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pets</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">dogsubs</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dog    4
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<section id="exercise-9-cleaning-the-cats-data">
<h4>Exercise 9: cleaning the cats data<a class="headerlink" href="#exercise-9-cleaning-the-cats-data" title="Link to this heading">#</a></h4>
<p>Write the code to standardize all the cat labels to be <code class="docutils literal notranslate"><span class="pre">cat</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instructions: clean the cat labels in the following series</span>
<span class="n">pets2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;Cat&quot;</span><span class="p">,</span> <span class="s2">&quot;CAT&quot;</span><span class="p">])</span>
<span class="n">pets2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    cat
1    dog
2    Cat
3    CAT
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@titlesolution Exercise 3 clean-cats</span>
<span class="n">catsubs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Cat&quot;</span><span class="p">:</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;CAT&quot;</span><span class="p">:</span><span class="s2">&quot;cat&quot;</span><span class="p">}</span>
<span class="n">pets2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">catsubs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    cat
1    dog
2    cat
3    cat
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="number-formatting-errors">
<h3>Number formatting errors<a class="headerlink" href="#number-formatting-errors" title="Link to this heading">#</a></h3>
<p>The text string <code class="docutils literal notranslate"><span class="pre">&quot;1.2&quot;</span></code> corresponds to the number <span class="math notranslate nohighlight">\(1.2\)</span> (a <code class="docutils literal notranslate"><span class="pre">float</span></code>).
We can do the conversion from text string to floating point number as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;1.2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.2
</pre></div>
</div>
</div>
</div>
<p>When loading data,
Pandas will automatically recognize numerical expression like this and load them into columns of type <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
<p>There are some common number formatting problems you need to watch out for.
Many languages use the comma is the decimal separator instead of a decimal point,
so the number 1.2 might be written as the text string <code class="docutils literal notranslate"><span class="pre">&quot;1,2&quot;</span></code>,
which will not be recognized as a <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;1,2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">96</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;1,2&quot;</span><span class="p">)</span>

<span class="ne">ValueError</span>: could not convert string to float: &#39;1,2&#39;
</pre></div>
</div>
</div>
</div>
<p>To fix this issue,
we replace the comma character in the string
with a period character as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;1,2&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1.2&#39;
</pre></div>
</div>
</div>
</div>
<p>Another example of a problematic numeric value is <code class="docutils literal notranslate"><span class="pre">&quot;1.</span> <span class="pre">2&quot;</span></code>,
which is not a valid float because of the extra space.
We can fix this by getting rid of the space using <code class="docutils literal notranslate"><span class="pre">&quot;1.</span> <span class="pre">2&quot;.replace(&quot;</span> <span class="pre">&quot;,</span> <span class="pre">&quot;&quot;)</span></code>.</p>
<p>Let’s see how to perform this kind of string manipulations
when working with data stored in a series or a data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;1.2&quot;</span><span class="p">,</span> <span class="s2">&quot;1,3&quot;</span><span class="p">,</span> <span class="s2">&quot;1. 4&quot;</span><span class="p">])</span>
<span class="n">rawns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1.2
1     1,3
2    1. 4
dtype: object
</pre></div>
</div>
</div>
</div>
<p>The series <code class="docutils literal notranslate"><span class="pre">rawns</span></code> contains strings with correct and incorrect formatting.
Note the series <code class="docutils literal notranslate"><span class="pre">rawns</span></code> has <code class="docutils literal notranslate"><span class="pre">dtype</span></code> (data type) of <code class="docutils literal notranslate"><span class="pre">object</span></code>,
which is what Pandas uses for strings.</p>
<p>Let’s try to convert this series to a numeric values (<code class="docutils literal notranslate"><span class="pre">float</span></code>s).
We can do this by calling the method <code class="docutils literal notranslate"><span class="pre">.astype()</span></code> as shown below.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># uncomment to see the ERROR</span>
<span class="c1"># rawns.astype(float)</span>
</pre></div>
</div>
</div>
</div>
<p>Calling the method <code class="docutils literal notranslate"><span class="pre">.astype(float)</span></code>
is essentially the same as calling <code class="docutils literal notranslate"><span class="pre">float</span></code> on each of the values in the series.
We get an error since the string <code class="docutils literal notranslate"><span class="pre">&quot;1,3&quot;</span></code> is not a valid <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
<p>We can perform the string replacements on the data series <code class="docutils literal notranslate"><span class="pre">rawns</span></code> using the “<code class="docutils literal notranslate"><span class="pre">str</span></code>-methods” as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span> \
     <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> \
     <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1.2
1    1.3
2    1.4
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>After performing the replacements of commas to periods and removing unwanted spaces,
the method <code class="docutils literal notranslate"><span class="pre">.astype(float)</span></code> succeeds.
Note the method we used in the above example is the string method <code class="docutils literal notranslate"><span class="pre">.str.replace()</span></code>
and not general <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> method.</p>
<p>Other types of data that might have format inconsistencies include dates, times, addresses, and postal codes.
We need to watch out when processing these types of data,
and make sure all the data is in a consistent format before starting the statistical analysis.</p>
<!-- Robyn said: Should we go more in-depth on time data? Seems widely applicable and often problematic. --></section>
<section id="dealing-with-missing-values">
<h3>Dealing with missing values<a class="headerlink" href="#dealing-with-missing-values" title="Link to this heading">#</a></h3>
<p>Real-world datasets often suffer from missing values
because of mistakes in the data collection process.
Missing values in Pandas are indicated with the special symbol <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number),
or sometimes using the symbol <code class="docutils literal notranslate"><span class="pre">&lt;NA&gt;</span></code> (Not Available).
In Python, the absence of a value corresponds to the value <code class="docutils literal notranslate"><span class="pre">None</span></code>.
The term <em>null value</em> is a synonym for missing value.
You can think of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values as empty slots.</p>
<!-- MAYBE  Some datasets might use special codes like `999` or `-1` to indicate missing integer values. -->
<p>To illustrate some examples of dealing with missing values,
we’ll load the dataset located at <code class="docutils literal notranslate"><span class="pre">datasets/raw/minimal.csv</span></code>,
which has several “holes” in it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/raw/minimal.csv&quot;</span><span class="p">)</span>
<span class="n">rawdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.5</td>
      <td>1.5</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>11.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">rawdf</span></code> contains the same data we worked on previously
plus additional rows with “problematic” values that we need to deal with.
The missing values are indicated by the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> symbol.
Specifically,
the rows with index <code class="docutils literal notranslate"><span class="pre">3</span></code> is missing the <code class="docutils literal notranslate"><span class="pre">level</span></code> variable,
and row <code class="docutils literal notranslate"><span class="pre">6</span></code> is missing the values for the <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">team</span></code> variables.</p>
<!-- You can obtain the value `NaN` by writing `float("NaN")`. 

Note the variable `level` has been converted to a `float` data type
in order to use the `NaN` for representing missing values.
This is because integers do not have a natural way to represent missing values.
Some datasets might use special codes like `999` or `-1` to indicate missing integer values.

-->
<p>We can call the <code class="docutils literal notranslate"><span class="pre">.info()</span></code> method
to get an idea of the number of missing values in the data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7 entries, 0 to 6
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   x       7 non-null      float64
 1   y       6 non-null      float64
 2   team    6 non-null      object 
 3   level   6 non-null      float64
dtypes: float64(3), object(1)
memory usage: 352.0+ bytes
</pre></div>
</div>
</div>
</div>
<p>The data frame has a total of 7 rows,
but the columns <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">team</span></code> have only 6 non-null values,
which tells us these columns contain one missing value each.</p>
<p>We can use the method <code class="docutils literal notranslate"><span class="pre">.isna()</span></code> to get a complete picture of all the values that are missing (not available).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The locations in the above data frame that contain the value <code class="docutils literal notranslate"><span class="pre">True</span></code>
correspond to the missing values in the data frame <code class="docutils literal notranslate"><span class="pre">rawdf</span></code>.</p>
<p>We can summarize the information about missing values,
by computing the row-sum of the above data frame,
which tells us count of the missing values for each variable.</p>
<!-- TODO: Explain true == 1 and false == 0 --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;rows&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x        0
y        1
team     1
level    1
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can also compute the column-sum to count the number of missing values in each row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0
1    0
2    0
3    1
4    0
5    0
6    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The most common way of dealing with missing values is to exclude them from the dataset,
by dropping all rows that contain missing values.
The method <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> filters out any rows that contain null values
and returns a new “clean” data frame with no <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rawdf</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can provide various option <code class="docutils literal notranslate"><span class="pre">subset</span></code> to the <code class="docutils literal notranslate"><span class="pre">.dropna()</span></code> method to focus on specific columns.
For example,
to drop only rows that contain null values in the columns <code class="docutils literal notranslate"><span class="pre">x</span></code> or <code class="docutils literal notranslate"><span class="pre">y</span></code>,
we would use the code <code class="docutils literal notranslate"><span class="pre">rawdf.dropna(subset=[&quot;x&quot;,&quot;y&quot;])</span></code>.
Using the <code class="docutils literal notranslate"><span class="pre">subset</span></code> option makes sense if we
plan analyze only these columns,
and missing values in the other columns will not be a problem.</p>
<p>Another approach for dealing with missing values is to use <em>imputation</em>,
which is the process of “filling in” values based on our best guess of what the missing values might have been.
One common approaches for filling in missing numeric values
is to use the mean of the other values in that column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fill_values</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">rawdf</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">}</span>
<span class="n">rawdf</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">fill_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.000000</td>
      <td>a</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.000000</td>
      <td>a</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.500000</td>
      <td>a</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.5</td>
      <td>1.500000</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
      <td>2.000000</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.0</td>
      <td>1.500000</td>
      <td>b</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>11.0</td>
      <td>1.583333</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Imputation is a tricky process,
since it changes the data,
which can affect the statistical analysis performed on the data.
It would be much better if you go back to the data source
to find what the missing values are,
instead of making arbitrary choice like the mean.</p>
</section>
<section id="removing-duplicates">
<h3>Removing duplicates<a class="headerlink" href="#removing-duplicates" title="Link to this heading">#</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">.drop_duplicates()</span></code> can be used to remove redundant rows
that contain the same data.
Duplicate rows can appear as a result of repeated data entry,
or due to overlaps that occur when merging datasets.</p>
</section>
<section id="identifying-and-removing-outliers">
<h3>Identifying and removing outliers<a class="headerlink" href="#identifying-and-removing-outliers" title="Link to this heading">#</a></h3>
<p>Outliers are data values that are much larger or much smaller than other values.
A mistake in the data collection process like measurement instrument malfunctions,
measurements of the wrong subject, or typos
can produce extreme observations in a dataset that don’t make sense.
For example,
if we intend to study the weights of different dog breeds
but somehow end up including a grizzly bear in the measurements,
your dogs dataset will the value 600 kg for a dog’s weight.
This extreme weight outlier tells you some mistake has occurred,
since such a weight measurement is impossible for a dog.</p>
<p>It’s important for you to know if your data contains outliers
before you start your analysis on this data,
otherwise the presence of outliers might “break” the statistical inference machinery,
and lead you to biased or erroneous results.</p>
<p>Sometimes we can correct outliers
by repeating the measurement.
For example,
if the data was manually transcribed from a paper notebook,
we could consult the original notebook to find the correct value.
Other times,
we can’t fix the faulty observations,
so our only option is to exclude it (drop it) from the dataset.</p>
<p>Let’s look at an example dataset that contains an outlier.
The data sample <span class="math notranslate nohighlight">\(\texttt{xs} = [1,2,3,4,5,6,50]\)</span> consists of seven values,
one of which is much much larger than the others.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">xs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1
1     2
2     3
3     4
4     5
5     6
6    50
Name: x, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can clearly see that the value <code class="docutils literal notranslate"><span class="pre">50</span></code> is an outlier in this case,
but the task may not be so easy for larger datasets
with hundreds or thousands of observations.</p>
<section id="why-outliers-are-problematic">
<h4>Why outliers are problematic<a class="headerlink" href="#why-outliers-are-problematic" title="Link to this heading">#</a></h4>
<p>Outliers can have undue leverage on the value of certain statistics
and may produce misleading analysis results.
Statistics like the mean, variance, and standard deviation
are affected by the presence of outliers.
For example,
let’s compute the mean (average value)
and the standard deviation (dispersion from the mean)
of the sample <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">xs</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10.142857142857142, 17.65812911408012)
</pre></div>
</div>
</div>
</div>
<p>These values are very misleading:
they give us the wrong impression about the centre of the data distribution and how spread out it is.
In reality,
the first six values are small numbers,
but the presence of the large outlier <span class="math notranslate nohighlight">\(50\)</span>
makes the mean and the standard deviation appear much larger.</p>
<p>If we remove the outlier <span class="math notranslate nohighlight">\(50\)</span>,
the mean of the standard deviation of the remaining values <span class="math notranslate nohighlight">\([1,2,3,4,5,6]\)</span> is much smaller.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3.5, 1.8708286933869707)
</pre></div>
</div>
</div>
</div>
<p>These summary statistics are much more representative of the data.
The mean value <span class="math notranslate nohighlight">\(3.5\)</span> is a good single-number description for the “centre” of the data points,
and the standard deviation of <span class="math notranslate nohighlight">\(1.87\)</span> also gives us a good idea of the dispersion of the data points.</p>
<p>Any subsequent statistical analyses we might perform with this data
will benefit from these more accurate summary statistics
we calculated after removing the outlier.</p>
<!-- Some statisticians argue that outliers should be excluded even if they aren't mistakes. They reason that because outliers skew results so drastically, those results won't be generalizable. --></section>
<section id="criteria-for-identifying-outliers">
<h4>Criteria for identifying outliers<a class="headerlink" href="#criteria-for-identifying-outliers" title="Link to this heading">#</a></h4>
<p>We’ll now describe some procedures for detecting outliers.
There are several criteria we can use to identify outliers:</p>
<ul class="simple">
<li><p><strong>Visual inspection</strong> is probably the simplest way to detect outliers.
Simply plot the data as a strip plot or scatter plot,
and look for values that don’t seem to fit with the rest.</p></li>
<li><p>The <strong>Tukey criterion</strong> considers any value that is
more than 1.5 the interquartile range,
<span class="math notranslate nohighlight">\(\mathbf{IQR} = \mathbf{Q}_3 - \mathbf{Q}_1\)</span>,
away from the outer quartiles of the data to be an outlier.
This is the criterion we used when drawing Tukey box-plots
in <a class="reference internal" href="#../notebooks/13_descriptive_statistics.ipynb"><span class="xref myst">Section 1.3</span></a>.</p></li>
<li><p>The <strong><span class="math notranslate nohighlight">\(z\)</span>-score criterion</strong> allows us to identify values that are very far away from the mean,
using a multiple of the standard deviation as the measure of distance.</p></li>
</ul>
<p>We’ll now show how to apply these criteria to the data sample <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<!-- https://www.itl.nist.gov/div898/handbook/eda/section3/eda35h.htm --></section>
<section id="visual-inspection-of-the-data">
<h4>Visual inspection of the data<a class="headerlink" href="#visual-inspection-of-the-data" title="Link to this heading">#</a></h4>
<p>A strip plot of the data sample <code class="docutils literal notranslate"><span class="pre">xs</span></code>
can help us simply “see” outliers if they are present.
Here is how to use the Seaborn function <code class="docutils literal notranslate"><span class="pre">sns.stripplot</span></code> to plot the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/152aa185e6616330183e48def575b579aef4e71295b77a650f43a057003830ea.png"><img alt="../../../_images/152aa185e6616330183e48def575b579aef4e71295b77a650f43a057003830ea.png" src="../../../_images/152aa185e6616330183e48def575b579aef4e71295b77a650f43a057003830ea.png" style="width: 489px; height: 140px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # FIGURES ONLY</span>
<span class="c1"># import matplotlib.pylab as plt</span>
<span class="c1"># import seaborn as sns</span>
<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(6,1)}):</span>
<span class="c1">#     ax = sns.stripplot(x=xs, jitter=0);</span>
<span class="c1">#     ax.set_xlabel(None)</span>
</pre></div>
</div>
</div>
</div>
<p>We clearly see one of these is not like the others.</p>
</section>
<section id="tukey-outliers">
<h4>Tukey outliers<a class="headerlink" href="#tukey-outliers" title="Link to this heading">#</a></h4>
<p>The <em>Tukey box plot</em> is a standard data visualization plot
produced from the quartiles of dataset,
The rectangular “box” goes from <span class="math notranslate nohighlight">\(\mathbf{Q}_{1}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{Q}_{3}\)</span>.
The width of this box is the interquartile range <span class="math notranslate nohighlight">\(\mathbf{IQR}\)</span>.
A vertical line is placed in the  <span class="math notranslate nohighlight">\(\mathbf{Q}_{2}\)</span> (the median).
Tukey box plots give special attention to the display of outliers,
which are represented as individual circles.
The lines extending from the box are called <em>whiskers</em>
and represent the range of the data excluding outliers.
We can use the Seaborn function <code class="docutils literal notranslate"><span class="pre">sns.boxplot</span></code> to obtain a Tukey box plot of the data <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../../_images/f3598df0dda10bafd69b028b4b599e9e47dbad4be650bbabffe8a707735e1908.png"><img alt="../../../_images/f3598df0dda10bafd69b028b4b599e9e47dbad4be650bbabffe8a707735e1908.png" src="../../../_images/f3598df0dda10bafd69b028b4b599e9e47dbad4be650bbabffe8a707735e1908.png" style="width: 489px; height: 140px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # FIGURES ONLY</span>
<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(6,1)}):</span>
<span class="c1">#     ax = sns.boxplot(x=xs)</span>
<span class="c1">#     ax.set_xlabel(None)</span>
</pre></div>
</div>
</div>
</div>
<p>The Tukey plot uses the distance <span class="math notranslate nohighlight">\(1.5 \cdot \mathbf{IQR}\)</span>
away from the quartiles box as the criterion for identifying outliers.
In other words,
any values that fall outside the interval
<span class="math notranslate nohighlight">\([\mathbf{Q}_{1} - 1.5 \cdot \mathbf{IQR}, \mathbf{Q}_{3} + 1.5 \cdot \mathbf{IQR}]\)</span>
is an outlier.
The outlier at <span class="math notranslate nohighlight">\(x=50\)</span> is displayed as circle,
and clearly stands out.
The whiskers in the box plot range from the smallest and largest values within the interval
<span class="math notranslate nohighlight">\([\mathbf{Q}_{1} - 1.5 \cdot \mathbf{IQR}, \mathbf{Q}_{3} + 1.5 \cdot \mathbf{IQR}]\)</span>.
The right whisker in the above figure is placed at <span class="math notranslate nohighlight">\(x=6\)</span>
which is the largest non-outlier value in <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<p>Let’s reproduce the calculations
that Seaborn performed to identify the outliers in the Tukey box plot
using Pandas methods.
We start by compute the first quartile <span class="math notranslate nohighlight">\(\mathbf{Q}_{1}\)</span>,
the third quartiles <span class="math notranslate nohighlight">\(\mathbf{Q}_{3}\)</span>,
and the interquartile range <span class="math notranslate nohighlight">\(\mathbf{IQR}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q1</span><span class="p">,</span> <span class="n">Q3</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
<span class="n">Q1</span><span class="p">,</span> <span class="n">Q3</span><span class="p">,</span> <span class="n">IQR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.5, 5.5, 3.0)
</pre></div>
</div>
</div>
</div>
<p>We can now calculate the cutoff values for Tukey outlier criterion,
which is 1.5 times the interquartile range away from the outer quartiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">,</span>  <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2.0, 10.0]
</pre></div>
</div>
</div>
</div>
<p>The Tukey plot identifies values outside the interval <span class="math notranslate nohighlight">\([-2,10]\)</span> as outliers.
In words,
values smaller than <span class="math notranslate nohighlight">\(-2\)</span> or greater than <span class="math notranslate nohighlight">\(10\)</span>
are “unusual” for the data sample <code class="docutils literal notranslate"><span class="pre">xs</span></code>.
We can build a mask that selects values that fit the Tukey criteria
by combining the two conditions <code class="docutils literal notranslate"><span class="pre">xs</span> <span class="pre">&lt;</span> <span class="pre">-2</span></code> and <code class="docutils literal notranslate"><span class="pre">xs</span> <span class="pre">&gt;</span> <span class="pre">10</span></code>
using the bitwise OR operator <code class="docutils literal notranslate"><span class="pre">|</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tukey_outliers</span> <span class="o">=</span> <span class="p">(</span><span class="n">xs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">xs</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="n">tukey_outliers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
3    False
4    False
5    False
6     True
Name: x, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tukey_outliers</span></code> series
tells us which values in the series <code class="docutils literal notranslate"><span class="pre">xs</span></code> are outliers.
We can use this mask to filter out the outliers,
as we’ll show later in this section.</p>
</section>
<section id="detecting-outliers-using-z-scores">
<h4>Detecting outliers using z-scores<a class="headerlink" href="#detecting-outliers-using-z-scores" title="Link to this heading">#</a></h4>
<p>Another way to detect extreme values
is to identify values that are multiple standard deviations away from the mean.
Given the data <span class="math notranslate nohighlight">\([x_1, x_2, \ldots, x_n]\)</span>,
we compute the <span class="math notranslate nohighlight">\(z\)</span>-scores <span class="math notranslate nohighlight">\([z_1, z_2, \ldots, z_n]\)</span>,
using the formula <span class="math notranslate nohighlight">\(z_i = \frac{x_i - \overline{\texttt{xs}}}{s_{\texttt{xs}}}\)</span>,
where <span class="math notranslate nohighlight">\(\overline{\texttt{xs}} = \frac{1}{n}\sum_{i=1}^n x_{i} =\)</span> <code class="docutils literal notranslate"><span class="pre">xs.mean()</span></code> is the same mean,
and <span class="math notranslate nohighlight">\(s_{\texttt{xs}} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(x_i - \overline{\texttt{xs}} )^2 } =\)</span> <code class="docutils literal notranslate"><span class="pre">xs.std()</span></code>
is the sample standard deviation.
The <span class="math notranslate nohighlight">\(z\)</span>-score <span class="math notranslate nohighlight">\(z_i\)</span> of an observation <span class="math notranslate nohighlight">\(x_i\)</span>
tells you where <span class="math notranslate nohighlight">\(x_i\)</span> sits relative to the mean <span class="math notranslate nohighlight">\(\overline{\texttt{xs}}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">xstd</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">zscores</span> <span class="o">=</span> <span class="p">(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">)</span> <span class="o">/</span> <span class="n">xstd</span>
<span class="n">zscores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0   -0.517770
1   -0.461139
2   -0.404508
3   -0.347877
4   -0.291246
5   -0.234615
6    2.257155
Name: x, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can identify outliers by their unusually large <span class="math notranslate nohighlight">\(z\)</span>-scores.
For example,
we could check which values are more than two standard deviations away from the mean,
by selecting <span class="math notranslate nohighlight">\(z\)</span>-scores that are less than <span class="math notranslate nohighlight">\(-2\)</span> or greater than <span class="math notranslate nohighlight">\(2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zscore_outliers</span> <span class="o">=</span> <span class="p">(</span><span class="n">zscores</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">zscores</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">zscore_outliers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
2    False
3    False
4    False
5    False
6     True
Name: x, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>We see that the <span class="math notranslate nohighlight">\(z\)</span>-scores method also identifies <span class="math notranslate nohighlight">\(50\)</span> as an outlier.</p>
</section>
<section id="removing-outliers">
<h4>Removing outliers<a class="headerlink" href="#removing-outliers" title="Link to this heading">#</a></h4>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">tukey_outliers</span></code> or the <code class="docutils literal notranslate"><span class="pre">zscore_outliers</span></code> criteria
to filter out the outliers.
We’ll actually invert the <code class="docutils literal notranslate"><span class="pre">tukey_outliers</span></code> mask
using the Python NOT operator <code class="docutils literal notranslate"><span class="pre">~</span></code>
to obtain a mask for all the values which are <em>not</em> outliers,
and use this mask to select only the subset of values that are not outliers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">[</span><span class="o">~</span><span class="n">tukey_outliers</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1
1    2
2    3
3    4
4    5
5    6
Name: x, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We can now continue the statistical analysis
on the subset of the data that doesn’t include the problematic outlier.</p>
</section>
<section id="when-to-exclude-outliers">
<h4>When to exclude outliers<a class="headerlink" href="#when-to-exclude-outliers" title="Link to this heading">#</a></h4>
<p>You need to have a legitimate reason for removing outliers.
Rejecting observations that are far outside the range of expected values
is the correct thing to do
only when these observations arise from data entry, measurement, or experimental errors.
In these cases,
the observation doesn’t come from the population you’re interested in,
so it doesn’t make sense to use this observation along with the others.</p>
<p>You should never remove data points to make our data look “nicer,”
or because some value seems unexpected.
On the contrary,
outliers might be the most interesting and important observations in your dataset.
The presence of an outlier might indicate an unexpected phenomenon,
or a previously unsuspected variable that influences the measurement.
It would be a shame to just discard such potentially valuable findings.
Instead of removing these observations,
you should investigate the unusual cases more closely and look for an explanation.
A consultation with subject-matter experts (SMEs) might be help
you understand what could have produced this outlier.</p>
<!-- TODO: mention robust statistics + FWD reference?

% A statistic like the median, that's only calculated using one or two values is immune to the effect of outliers.

Alternatively,
you could use a statistical procedure that gives less weight to outliers,
or you could repeat the experiment to obtain a new dataset and compare your two sets of results.
Finally,
you could choose to report results both with and without outliers and let your audience decide.


Indeed,
the goal of certain statistics procedures like *anomaly detection*
is precisely to identify outliers,
so you should definitely not remove them.

If you eliminate data points from your analyses (for any reason),
make sure to report this when reporting your results.

-->
</section>
</section>
<section id="summary-of-data-cleaning">
<h3>Summary of data cleaning<a class="headerlink" href="#summary-of-data-cleaning" title="Link to this heading">#</a></h3>
<p>The data cleaning steps we introduced in this section
are an essential prerequisite for any statistical analysis.
It’s important that you learn to perform these basic data manipulations
so that you’ll be able to work with messy, real-world datasets.
We’ve only scratched the surface of what is possible,
but I hope you got an idea of the data cleaning steps you might need to do.</p>
<p>Data pre-processing is not something you can “outsource” or handoff to a colleague,
because it’s very informative to “touch” the data and get to know it.
If you only see data after it has been cleaned up by someone else,
then you’re missing a lot of the context,
and you were not included in some important decisions,
like dealing with missing values and outliers.
The <a class="reference internal" href="#Case-studies"><span class="xref myst"><strong>Case Studies</strong></span></a> section later in this tutorial
shows some hands-on examples of data cleaning.
Here are some exercises that ask you to clean-up
the raw data files in <code class="docutils literal notranslate"><span class="pre">datasets/raw/</span></code>.</p>
</section>
<section id="data-cleaning-exercises">
<h3>Data cleaning exercises<a class="headerlink" href="#data-cleaning-exercises" title="Link to this heading">#</a></h3>
<section id="exercise-10">
<h4>Exercise 10<a class="headerlink" href="#exercise-10" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
</section>
</section>
<section id="data-extraction">
<h2>Data extraction<a class="headerlink" href="#data-extraction" title="Link to this heading">#</a></h2>
<p>Real-world data is stored in all kinds of places,
and an “extraction” step is required to get your hands on this data.</p>
<section id="data-sources">
<h3>Data sources<a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h3>
<p>Here are the some common data sources you should know about:</p>
<ul>
<li><p><strong>Local files.</strong>
The simplest kind of data files are the ones stored locally on your machine.
You can usually tell what type of data is stored in a file
by looking at the file’s <em>extension</em>: <code class="docutils literal notranslate"><span class="pre">.csv</span></code>, <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>, <code class="docutils literal notranslate"><span class="pre">.json</span></code>, etc.</p></li>
<li><p><strong>Online files.</strong>
Files can be made available for download on the internet by placing them on a web server.</p></li>
<li><p><strong>Logs.</strong>
Many software systems generate log files as part of their normal operation.
For example,
every web server keeps a log of all the requests it has received,
which is a very useful data source when working on web analytics.</p>
<!-- Vanessa's dataset of website visitors was obtained by processing the logs of her web server. TODO: remind reader + pageref -->
</li>
<li><p><strong>Surveys.</strong>
You can send out a survey and collect the responses from people you’re interested in.
Every startup should be investing time to talk to their customers,
and surveys can be a part of this conversation.</p></li>
<li><p><strong>Databases.</strong>
Company operational data is stored in one or more databases.
Access to this data is essential for understanding any business.
The Structured Query Language (SQL) is the standard interface for accessing data in databases.</p></li>
<li><p><strong>Websites.</strong>
Data is often displayed as tables on various webpages.
Webpages are usually intended to be read by humans,
but we can also load load this data into Pandas for analysis.</p></li>
<li><p><strong>APIs.</strong>
An <em>application programming interface</em> (API) is a standard way for computers to exchange data.
Data obtained from APIs is intended for machine use.
You can think of APIs as websites that allow fine-grained control of the data you’re requesting,
and a well-defined format for the response data.</p>
<!-- Common data formats used for API responses are JSON and XML. -->
<!-- TODO mention Getting data from APIs can be done via requests + json processing (examples using github API?) -->
</li>
<li><p><strong>Data repositories.</strong>
Many researchers make the data from their studies publicly
available for download through data repositories,
which are websites specialized for this purpose.
Examples of data repositories include government data repositories
and open science repositories like OSF, Zenodo, etc.</p></li>
<li><p><strong>Reverse engineering plots and graphs.</strong>
We can sometimes extract data from graphs in published research papers.
Tools <a class="reference external" href="https://www.graphreader.com/"><code class="docutils literal notranslate"><span class="pre">graphreader.com</span></code></a> can help with this.</p></li>
</ul>
</section>
<section id="data-formats">
<h3>Data formats<a class="headerlink" href="#data-formats" title="Link to this heading">#</a></h3>
<!-- ALT. Data file formats -->
<p>Data files can be encoded in one of several data formats:
CSV files, TSV files, spreadsheets, JSON files, HTML files, SQLite database files, etc.
We’ll now show examples of the Pandas code for loading data
from the most common data formats you are likely to encounter “in the wild.”</p>
<!-- Pandas provides methods for loading data from many other data file formats.
The function `pd.read_excel()` is used to load data from spreadsheet files.
There are also functions `pd.read_html()` and `pd.read_json()`
for reading data from HTML and JSON files,
which we'll discuss later on. -->
<!-- Robyn said: Move formats to appendix? Consider condensing into a table instead with columns: - snippet of what the data looks like, - name of the format - method to read it in python -->
<!-- CUT SINCE NOT COVERING ALL FORMATS ANYMORE
all of the above source formats.
You can find all the source data files in the `datasets/formats/` directory.
We'll use the function `head` to print the first few lines of the data files so you'll get a feeling for how the data is structured,
then show the appropriate Pandas function for loading data in this format.
The actual data we'll be loading in will be the same in each case,
it's just encoded in a different source format,
but after loading the data into Pandas,
all the different formats will end up as identical data frame objects. --><section id="csv-files">
<h4>CSV files<a class="headerlink" href="#csv-files" title="Link to this heading">#</a></h4>
<p>Comma-Separated-Values (CSV) is a widely used file format for tabular data.
CSV files consist of plain text values separated by commas.
The first line of a CSV file usually contains the variable names (it is called the header row).
Comma-Separated-Values files are the most common file format for tabular data that you are likely to encounter.</p>
<p>Let’s see the “raw contents” of the data file <code class="docutils literal notranslate"><span class="pre">datasets/minimal.csv</span></code>
as you would see if you opened it with a basic text editor (e.g. Notepad in Windows or TextEdit on a Mac).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">team</span><span class="p">,</span><span class="n">level</span>
    <span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">3</span>
    <span class="mf">1.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span>
    <span class="mf">2.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span>
    <span class="mf">2.5</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">3</span>
    <span class="mf">3.0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">3</span>
</pre></div>
</div>
<p>The first line of this file contains the column names.
The next five rows contain the actual data for the observations.</p>
<!-- Comma-Separated-Values are the most common format for tabular data.
CSV files are regular text files that contain individual values (numeric or text) separated by commas. In many CSV files, the first line is a special header row that contains the names of the variables. --><p>You can load CSV data using the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv(&lt;path&gt;)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">&lt;path&gt;</span></code> is the location of the CSV file.
Recall we used this function in the beginning of this tutorial.
Here is the code for loading a CSV file <code class="docutils literal notranslate"><span class="pre">datasets/minimal.csv</span></code> once more.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/minimal.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code>
accepts many options for specifying alternative separators,
custom headers, quoted values, parsing dates, etc.</p>
</section>
<section id="spreadsheets-files">
<h4>Spreadsheets files<a class="headerlink" href="#spreadsheets-files" title="Link to this heading">#</a></h4>
<p>Spreadsheet software like LibreOffice Calc, Microsoft Excel, and Google Sheets
produce spreadsheet files that have extensions like <code class="docutils literal notranslate"><span class="pre">.ods</span></code>, <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>, or <code class="docutils literal notranslate"><span class="pre">.xls</span></code>.
We can load data from spreadsheet files using the function <code class="docutils literal notranslate"><span class="pre">pd.read_excel()</span></code>.
For example,
here is how to load the data file <code class="docutils literal notranslate"><span class="pre">datasets/formats/minimal.ods</span></code>,
which was created by LibreOffice Calc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">odsdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.ods&quot;</span><span class="p">,</span>
                      <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">odsdf</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The code for loading Excel files is similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.xlsx&quot;</span><span class="p">,</span> 
                       <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="n">xlsdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.xls&quot;</span><span class="p">,</span> 
                      <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that reading <code class="docutils literal notranslate"><span class="pre">.ods</span></code> files requires the Python module <code class="docutils literal notranslate"><span class="pre">odfpy</span></code>,
which we <code class="docutils literal notranslate"><span class="pre">pip</span></code>-installed in the beginning of this notebook.
Similarly,
reading the Excel file formats <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code> and <code class="docutils literal notranslate"><span class="pre">.xls</span></code>
requires the Python modules <code class="docutils literal notranslate"><span class="pre">openpyxl</span></code> and <code class="docutils literal notranslate"><span class="pre">xlrd</span></code> to be installed.</p>
</section>
<section id="tsv-files">
<h4>TSV files<a class="headerlink" href="#tsv-files" title="Link to this heading">#</a></h4>
<p>The Tab-Separated-Values format is similar to CSV, but uses TAB characters as separators.
TAB is a special character used for aligning text into columns.
Tabs are represented as <code class="docutils literal notranslate"><span class="pre">&quot;\t&quot;</span></code> in Python strings.
Here is the raw contents of the data file <code class="docutils literal notranslate"><span class="pre">datasets/formats/minimal.tsv</span></code>.</p>
<div class="highlight-TSV notranslate"><div class="highlight"><pre><span></span>x       y       team    level
1.0     2.0     a       3
1.5     1.0     a       2
2.0     1.5     a       1
2.5     2.0     b       3
3.0     1.5     b       3
</pre></div>
</div>
<!-- TODO: say TAB keypress means move-one-colum-to-the-right inside tables (like spreadsheet software) --><p>We load TSV files using the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>
by passing the value <code class="docutils literal notranslate"><span class="pre">&quot;\t&quot;</span></code> to the <code class="docutils literal notranslate"><span class="pre">sep</span></code> (separator) option,
as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsvdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.tsv&quot;</span><span class="p">,</span>
                    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">tsvdf</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="json-files">
<h4>JSON files<a class="headerlink" href="#json-files" title="Link to this heading">#</a></h4>
<p>The JavaScript Object Notation (JSON) format
is a common data format used by many web applications and APIs.
The JSON data format is similar to Python’s notation for
<code class="docutils literal notranslate"><span class="pre">list</span></code>s (square brackets <code class="docutils literal notranslate"><span class="pre">[...]</span></code>),
and <code class="docutils literal notranslate"><span class="pre">dict</span></code>s (curly braces <code class="docutils literal notranslate"><span class="pre">{...}</span></code>).
Here are the contents of the data file <code class="docutils literal notranslate"><span class="pre">datasets/formats/minimal.json</span></code>.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="mf">2.5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;team&quot;</span><span class="p">:</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Pandas provides the function <code class="docutils literal notranslate"><span class="pre">pd.read_json()</span></code> for loading JSON data.
If the contents of the JSON file is a list of observation,
we can load JSON files directly into a data frame using the function <code class="docutils literal notranslate"><span class="pre">pd.read_json()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jsondf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.json&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">jsondf</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<!-- TODO: plug `pd.json_normalize` https://pandas.pydata.org/docs/reference/api/pandas.json_normalize.html via https://towardsdatascience.com/all-pandas-json-normalize-you-should-know-for-flattening-json-13eae1dfb7dd -->
<p>If the JSON source data file has a structure that is more complicated than a list-of-observations,
we can try calling the function <code class="docutils literal notranslate"><span class="pre">pd.json_normalize</span></code>,
which will try to auto-guess the structure of the JSON data.
In the general case,
importing JSON data might require using the Python module <code class="docutils literal notranslate"><span class="pre">json</span></code> to load the data into Python data structures
and carry out processing steps to extract the desired subset of the data you’re interested in and organizing it
into the list-of-observation format that Pandas expects.</p>
</section>
<section id="tables-in-html-files">
<h4>Tables in HTML files<a class="headerlink" href="#tables-in-html-files" title="Link to this heading">#</a></h4>
<p>The HyperText Markup Language format is used by all the web pages you access on the web.
The HTML source code of a webpage can include tabular data (the <code class="docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code> tag in the HTML source code).
Here are the first few lines of the HTML file <code class="docutils literal notranslate"><span class="pre">datasets/formats/minimal.html</span></code>.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>x<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>y<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>team<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">th</span><span class="p">&gt;</span>level<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>1.0<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>2.0<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>a<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>3<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We can load the data from HTML files using the function <code class="docutils literal notranslate"><span class="pre">pd.read_html()</span></code>,
which returns a list of data frames extracted from the tables found in a HTML document.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s2">&quot;datasets/formats/minimal.html&quot;</span><span class="p">)</span>
<span class="n">htmldf</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">htmldf</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">htmldf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>team</th>
      <th>level</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.5</td>
      <td>1.0</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>1.5</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>2.0</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>b</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="sqlite-database-files">
<h4>SQLite database files<a class="headerlink" href="#sqlite-database-files" title="Link to this heading">#</a></h4>
<p>SQLite is a commonly used data format
for storing databases as files.
Pandas provides the functions <code class="docutils literal notranslate"><span class="pre">pd.read_sql_table()</span></code>
and <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> for extracting data from databases.
We can use these functions to “connect” to the SQLite database file
and read the data stored in one or more database tables in the SQLite database file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
<span class="n">dbpath</span> <span class="o">=</span> <span class="s2">&quot;datasets/formats/minimal.sqlite&quot;</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;sqlite:///&quot;</span> <span class="o">+</span> <span class="n">dbpath</span><span class="p">)</span>
<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
    <span class="n">sqldf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s2">&quot;players&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">conn</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">sqldf</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT x, y, team, level FROM players;&quot;</span>
<span class="n">sqldf2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">sqldf2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The key to remember when dealing with various source files,
is that you your goal is to get the data in whatever “shape” it is in,
and save it as a Pandas data frame.
Do not try to restructure or modify the data,
you can do the data transformation and cleaning steps once you have it in the Pandas data frame,
using what we learned in <a class="reference internal" href="#Data-transformations"><span class="xref myst"><strong>Data Transformation</strong></span></a>
and the <a class="reference internal" href="#Data-cleaning"><span class="xref myst"><strong>Data Cleaning</strong></span></a> sections earlier.</p>
</section>
</section>
<section id="data-extraction-exercises">
<h3>Data extraction exercises<a class="headerlink" href="#data-extraction-exercises" title="Link to this heading">#</a></h3>
<section id="exercise-11">
<h4>Exercise 11<a class="headerlink" href="#exercise-11" title="Link to this heading">#</a></h4>
<p>TODO</p>
</section>
<section id="exercise-12">
<h4>Exercise 12<a class="headerlink" href="#exercise-12" title="Link to this heading">#</a></h4>
<p>TODO</p>
<p><a name="Case-studies"></a></p>
</section>
</section>
</section>
<section id="case-studies">
<h2>Case studies<a class="headerlink" href="#case-studies" title="Link to this heading">#</a></h2>
<p>We’ll now describe how the datasets used in the book were obtained:
Vanessa’s website visitors,
Bob’s electricity prices,
and Charlotte’s student scores,
as well as the apples, kombucha, doctors, etc.
We were not involved in the data collection process for these datasets,
but it’s still worth asking the clients (Vanessa, Bob, Charlotte, etc.)
about the steps they followed to obtain the data.
There is an unspoken rule in statistics
that <strong>the more you know about the data,
the better you’ll be able to do the statistical analysis on it</strong>.</p>
<!-- TODO: reference Table of datasetsd for 1.2 -->
<p>The goal of the next ten pages is
to show you examples of real-world data collection and cleanup steps
to showcase the power of Pandas’ functions for data management,
and give you an idea of what to expect when you start working on your own datasets.
We’ll present the backstory for each dataset as an informal conversation.</p>
<p>Don’t be scared by all the technical details!
You don’t have to know about server logs, HTML scraping, and web applications to understand this section:
you’re just an observer who wants to learn about the extraction and transformation steps.
The goal is to become familiar with the steps that each of your clients performed before providing you the data,
a bit 	like <em>farm-to-table</em>, but for data.</p>
<section id="collecting-the-apples-dataset">
<h3>Collecting the apples dataset<a class="headerlink" href="#collecting-the-apples-dataset" title="Link to this heading">#</a></h3>
<p>Alice’s orchard</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>		Alice runs an apple orchard.
		She collected a sample from the apples harvested this year (the \emph{population})
		and sent you the data in a CSV file called \tt{apples.csv}.
		You start by loading the data into Pandas and looking at its characteristics.

		\begin{codeblock}[load-apples-and-head]
		&gt;&gt;&gt; apples = pd.read_csv(&quot;datasets/apples.csv&quot;)
		&gt;&gt;&gt; apples.shape
		(30, 1)
		&gt;&gt;&gt; apples.head(3)
		   weight
		0   205.0
		1   182.0
		2   192.0
		\end{codeblock}

		\noindent
		The apples dataset contains $n=30$ observations of the \tt{weight} variable.
		The weights are measured in grams.

		You decide to generate a strip plot (\tt{sns.stripplot}) to visualize the apple weights.

		\begin{codeblock}[stripplot-apples-x-weight]
		&gt;&gt;&gt; sns.stripplot(data=apples, x=&quot;weight&quot;)
		Result is shown in Figure ¡\ref{fig:apples-stripplot-weight}¡.
		\end{codeblock}

		\begin{figure}[htb]
			\centering
			\includegraphics[width=0.99\textwidth]{figures/data/practice/apples-stripplot-weight.pdf}
			\vspace{-2mm}
			\caption{	Strip plot of the \tt{weight} variable from the apples dataset.}
			\label{fig:apples-stripplot-weight}
		\end{figure}

		\noindent
		You also compute the average weight of the apples in this sample.

		\begin{codeblock}[apples-weight-mean]
		&gt;&gt;&gt; apples[&#39;weight&#39;].mean()
		202.6
		\end{codeblock}

		\noindent
		The mean of the apple weights from this sample is $202.6$ grams.

		\paragraph{Alice&#39;s estimation question}

			Alice wants to know the average apple weight in the population.
			The sample mean $202.6$\;g 		% \tt{apples[&#39;weight&#39;].mean()}
			is an approximation to the population mean, % (denoted $\mu_A$),
			so that is a good place to start.
			But how good is this approximation?
			Alice is asking you to quantify the accuracy of this estimate
			by constructing a \emph{confidence interval} for the population mean,
			which is a range of numbers that includes the plausible values.

			To answer Alice&#39;s question,
			we&#39;ll learn how to model the \emph{sampling distribution} of the mean (Section~\ref{sec:estimators})
			and construct a \emph{confidence interval} for the population mean (Section~\ref{sec:confidence_intervals}).
</pre></div>
</div>
<p>Before drawing any conclusion about the average weight of the population (all the apples in this year’s harvest),
you need to know how the sample was collected so you decide to ask Alice about that.
Alice says she used \emph{random sampling} approach to collect the sample.
She explains that apples are stored in numbered crates in a warehouse,
and she picked 30 crates at random and selected an apple at random from the selected crates.</p>
<p>Judging from the first three rows,
you suspect the measurement unit is grams.</p>
<p>Alice has sent you the sample of apple weights from this year</p>
<p>but what is the accuracy of this estimate?
Alice wants you to compute the ``error bars’’ for the estimate.</p>
</section>
<section id="collecting-the-electricity-prices-dataset">
<h3>Collecting the electricity prices dataset<a class="headerlink" href="#collecting-the-electricity-prices-dataset" title="Link to this heading">#</a></h3>
<p>You call Bob to ask him about how he collected the electricity prices dataset <code class="docutils literal notranslate"><span class="pre">eprices.csv</span></code>.
He tells you he obtained the electricity pricing data by scraping the pages from a local price-comparison website.
This website contained the electricity prices for various charging stations in the form of an HTML table.
He used the function <code class="docutils literal notranslate"><span class="pre">pd.read_html()</span></code> to extract the prices
and categorized the stations based on their location in the East and West parts of the city.</p>
<!-- TODO: in notebook, JOIN data from individual stations + prices -->
<p>Listening to the explanations,
you wonder about the possible bias that might exist in the electricity prices that Bob collected,
so you decide to ask him about it.</p>
<p>“Bob, tell me more about this website. Which charging stations are listed there?” you ask.</p>
<p>“It’s a volunteer-run effort. People post the price they paid,
so it includes a wide selection of stations.
There were several pages of results,
and each page has 20 prices,
so I think I had the data from most of the stations,” he says.</p>
<p>“Ah OK, cool. It seems it’s a pretty good sample,” you say.
“I was worried it might be a commercial website that only shows the prices from ‘preferred’ stations.”</p>
<!-- Robyn said: Potential issues with the data Repeated measure on the same stations: without accounting for it, people voluntarily posting the price they paid, not selected at random TODO: fix this -->
<p>You’re reassured you have a representative sample of the prices,
so you’ll be able to study the question
“Which part of the city has cheaper electricity prices?”
since you have the data from a reasonable number of charging stations.</p>
<p>You load up Bob’s dataset <code class="docutils literal notranslate"><span class="pre">datasets/epriceswide.csv</span></code>
and print the first few rows to see how the dataset is structured.</p>
<!--

	The website eprices.texas  (or emf.cheap) lists current electricity prices at the "pump" for various charging stations in each city.
	Bob has "scraped" the pricing info from his city over several months.

	Using the Pandas shortcut function for extracting data from HTML pages,
	Bob obtained a prices table for the moment,
	and collected those daily for ten weeks.	
	The ``raw'' data is therefore 70 individual data frames with prices for that day,

	Bob combined the data frames to form one giant sample of prices collected over 10 weeks.
	Bob also augmented the \texttt{eprices} dataset with East and West labels for each charging station
	We're interested in the overall difference between East and West prices
	not interested in the variability between pricing strategies of different charging station.
	Bob is also intentionally choosing to ignore the time when the price samples were taken---we're looking
	for an overall average over the last 10 weeks and ignore any time-dependent trends that may exist.

	The \texttt{eprices.csv} dataset obtained by selecting prices and their side label (East or West).
	

--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epriceswide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/epriceswide.csv&quot;</span><span class="p">)</span>
<span class="n">epriceswide</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>East</th>
      <th>West</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.7</td>
      <td>11.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.9</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.8</td>
      <td>8.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.3</td>
      <td>8.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It seems Bob stored the data in “wide format,”
with the prices from charging stations in the East in one column,
and the prices from the charging stations in the West in another column.
In other words,
knowing if a given price is in the East or West is encoded in its column position.</p>
<p>We can use the Pandas method <code class="docutils literal notranslate"><span class="pre">.melt</span></code>
to convert the <code class="docutils literal notranslate"><span class="pre">epriceswide</span></code> data frame
from “wide” format into “long” format,
with one observation per row.
We’ll use the option <code class="docutils literal notranslate"><span class="pre">var_name=&quot;loc&quot;</span></code> to specify the variable name encoded in the column position,
and the option <code class="docutils literal notranslate"><span class="pre">value_name</span></code> to specify the name of the variable stored in the individual cells.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epriceslong</span> <span class="o">=</span> <span class="n">epriceswide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span>
                               <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">)</span>
<span class="n">epriceslong</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>loc</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>East</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>East</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>East</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>East</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>East</td>
      <td>6.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.melt</span></code> operation transformed the implicit “which column is the data in” information
into an explicit <code class="docutils literal notranslate"><span class="pre">loc</span></code> variable stored in a separate column.
Each row in the transformed data frame contains only a single observation,
so it is in tidy data format.
You save this data to the path <code class="docutils literal notranslate"><span class="pre">datasets/eprices.csv</span></code>,
which is ready for analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epriceslong</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;datasets/eprices.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You know how to continue from here.</p>
<p>“Okay Bob. Thanks for the info,” you tell ending the conversation.
“I think I have everything I need to do the statistical analysis,
and I’ll get back to you soon with the results.”</p>
<!-- 

"Cool!
Thanks for agreeing to provide 'stats support' on this.
I'm looking forward to seeing the results."


Do you know what type of statistical analysis you'll use for this dataset?"
he asks.

Bob is asking a really good question.
Depending on the data we have,
there are several types of statistical analysis recipes we can use.
In this case,
we're trying to compare the means of two groups of numerical variables.
In order to describe the variability in the data,
we'll also measure the standard deviation for the two groups.
Based on these statistics computed from the observed data,
we'll be able to make conclusions about the general population (all electricity prices).
Our final goal is to tell Bob conclusively if there is a difference between East and West prices,
and if there is a difference which side of his city has the cheaper prices.

You recently did an analysis of a similar dataset
where you compared the means of two groups,
so you have a clear plan for what you're going to do.

"My plan is to compute the mean and the standard deviation for the East and West prices,
then compare the means to see if there is a difference.
If there is a difference between the means,
I'll run a statistical test to see if the observed difference is statistically significant,"
you explain.

"Wow, sounds complicated!" exclaims Bob,
mystified by the technical jargon.

You reassure him there is nothing too complicated and statistical testing is just a fancy way
to compare means obtained from two groups
and determine if the observed difference in the means could have occurred by chance.
You clearly see he's interested to learn more about how statistical tests work,
but you know this is not the moment to explain everything.
There is a whole book ahead of us for this.

-->
<!-- 
In Chapter 2 we'll learn to use probability theory to model data distributions,
then in Chapter 3 develop tools for estimating parameters from data samples
and using statistical hypothesis testing procedures.
Let's not rush into things.
Easy does it. -->
<!-- TODO: future conversational --- Bob asks why we used the normality assumption, response \"funny you asked this, I also ran the nonparametric Signed Rank test\...\" -->
</section>
<section id="collecting-the-students-dataset">
<h3>Collecting the students dataset<a class="headerlink" href="#collecting-the-students-dataset" title="Link to this heading">#</a></h3>
<p>Charlotte is a bit of a techie,
so she set up a learning management system (LMS) server for the students in her class.
Charlotte learned how to do this (run web applications on her own server) after suffering months of difficulties
of trying to upload her teaching materials to the platform provided by her school.
She reasoned that it can’t be this hard to run her own server:
it’s just documents, video lectures, and exercises,
and there is plenzty of free software that can do this.</p>
<p>Charlotte’s main reason for running her own server is because
she didn’t feel comfortable with the idea of her students’ learning process being monitored by a proprietary learning platform.
You’re excited to talk to her,
because it’s nice to meet a teacher who cares deeply about student data privacy.</p>
<p>The LMS Charlotte used for this class stores student records in a database.
She made some SQL queries using the function <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code>
to obtain detailed logs of each students’ actions on the platform.</p>
<p>She then aggregated the total <code class="docutils literal notranslate"><span class="pre">effort</span></code> (total time spend on the platform)
and the combined <code class="docutils literal notranslate"><span class="pre">score</span></code> for each student.
She transported the data as a CSV to her laptop,
then send it to you.</p>
<p>Charlotte automated the whole data extraction process
by writing a script.</p>
<p>TODO: explain script step by step</p>
<p>TODO: merge in
You go through the column names to confirm that you understand the meaning of the categorical variables
and you know how all the numerical variables were calculated.</p>
<p>You wonder how she calculated the <code class="docutils literal notranslate"><span class="pre">effort</span></code> and <code class="docutils literal notranslate"><span class="pre">score</span></code> variables.
She explains she computed the <code class="docutils literal notranslate"><span class="pre">effort</span></code> variable from the total time spent learning,
which includes watching videos and doing exercises.
She computed the <code class="docutils literal notranslate"><span class="pre">score</span></code> variable as the average success rate on all exercises that the student completed.</p>
<p>Using the function <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>,
you can load the <code class="docutils literal notranslate"><span class="pre">students.csv</span></code> dataset and print the first few rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/students.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;student_ID&quot;</span><span class="p">)</span>
<span class="n">students</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>background</th>
      <th>curriculum</th>
      <th>effort</th>
      <th>score</th>
    </tr>
    <tr>
      <th>student_ID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>arts</td>
      <td>debate</td>
      <td>10.96</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>science</td>
      <td>lecture</td>
      <td>8.69</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>arts</td>
      <td>debate</td>
      <td>8.60</td>
      <td>67.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>arts</td>
      <td>lecture</td>
      <td>7.92</td>
      <td>70.3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>science</td>
      <td>debate</td>
      <td>9.90</td>
      <td>76.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="collecting-the-kombucha-dataset">
<h3>Collecting the kombucha dataset<a class="headerlink" href="#collecting-the-kombucha-dataset" title="Link to this heading">#</a></h3>
<p>Khalid measures random samples from different batches …</p>
<p>Khalid’s is not running a scientific study but using statistics for quality control purposes.</p>
</section>
<section id="collecting-the-doctors-dataset">
<h3>Collecting the doctors dataset<a class="headerlink" href="#collecting-the-doctors-dataset" title="Link to this heading">#</a></h3>
<p>Dan’s survey of doctors lifestyle choices …</p>
<p>Dan is a data analyst working at the Ministry of Health.
His current assignment is to look for ways to improve the health of family doctors.
He collected the doctors dataset (\tt{doctors.csv}),
which contains data about the demographics, life habits, and health metrics
of 224 family doctors that Dan randomly selected from the populations of family doctors in the country.</p>
<p>Dan’s doctors dataset is also observational in nature.
He didn’t take identical groups of doctors and send them to work in rural and urban settings,
but just observed their location and their sleep scores.</p>
</section>
<section id="generating-the-players-dataset">
<h3>Generating the players dataset<a class="headerlink" href="#generating-the-players-dataset" title="Link to this heading">#</a></h3>
<p>The players dataset that we used for the examples in sections 1.1 and 1.2 in the book
is a synthetic dataset,
which means it was artificially generated to have certain properties.</p>
<p>Check out this notebook <a class="reference external" href="https://bit.ly/3Z8oco0"><code class="docutils literal notranslate"><span class="pre">bit.ly/3Z8oco0</span></code></a> to view the steps used to generate the dataset.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>I hope this tutorial helped you</p>
<!-- TODO: better conclusion -->
<p>By learning how to extract, transform, and manage data,
you’ve established an important foundational knowledge
that you’ll be able in science, engineering, and business.
Data management is also a big part of doing statistics.</p>
<section id="alternatives-to-pandas">
<h3>Alternatives to Pandas<a class="headerlink" href="#alternatives-to-pandas" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Polars</p></li>
<li><p>Base R</p></li>
<li><p>Tidyverse</p></li>
<li><p>Excel</p></li>
</ul>
<!--

The Stack Overflow discussion forums are a good place to ask questions
once you learn the jargon terms for data transformations (`.melt()`, `.groupby()`, `.agg()`, etc.).


The main takeaway is that \emph{data munging} skills are very useful to develop
for anyone who plans to do work with data in the future.
The examples in this section illustrated some of the most common data processing tasks,
but there are all kinds of other transformations you might need to perform,
depending on the datasets you're working with.

It doesn't make sense to learn all possible data transformations,
but instead learn what you need to know when you need it.
See the Pandas tutorial (Appendix~\ref{appendix:pandas_tutorial})
to learn more tricks and techniques for working different data formats, data cleaning, and dealing with missing values.



The data loading steps we introduced in this section are an essential prerequisite for statistical analysis.
It's important that you learn to perform the basic data manipulations
so that you'll be able to load datasets and select the data you need for your study. 
--></section>
</section>
<section id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Data transformations: <code class="docutils literal notranslate"><span class="pre">melt</span></code>, <code class="docutils literal notranslate"><span class="pre">dropna</span></code>, filter by value, etc.</p></li>
<li><p>Rename categorical values to normalize them. <code class="docutils literal notranslate"><span class="pre">OH</span></code> (Ohio), <code class="docutils literal notranslate"><span class="pre">WA</span></code> (Washington), etc.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to compute the average <span class="math notranslate nohighlight">\(y\)</span>-position for the players in the two teams.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code> methods: split City, ST – into city and state (or Last Name, First name into separate names)</p></li>
<li><p>Filter out outliers using pre-specified cutoff (Q3 + 1.5IQR) but don’t tell how limits were computed (FWD refs to Descr. Stats and Z-score).</p></li>
<li><p>guided ETL problems for extracting data from various sources (CSV, TSV, Excel, DB, txt, JSON, web scrape tabular)</p></li>
<li><p>data transformations: str methods, melt, dropna, etc. (hands-on practicum in Appendix D)</p></li>
</ul>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">#</a></h2>
<p>I’ve compiled a list of Pandas learning resources for you.</p>
<section id="music-videos">
<h3>Music videos<a class="headerlink" href="#music-videos" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=4NJlUribp3c">https://www.youtube.com/watch?v=4NJlUribp3c</a></p></li>
</ul>
</section>
<section id="general-concepts">
<h3>General concepts<a class="headerlink" href="#general-concepts" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Data_wrangling">https://en.wikipedia.org/wiki/Data_wrangling</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Data_preparation">https://en.wikipedia.org/wiki/Data_preparation</a></p></li>
</ul>
</section>
<section id="cheatsheets">
<h3>Cheatsheets<a class="headerlink" href="#cheatsheets" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://homepage.univie.ac.at/michael.blaschek/media/Cheatsheet_pandas.pdf">https://homepage.univie.ac.at/michael.blaschek/media/Cheatsheet_pandas.pdf</a></p></li>
<li><p>Data Wrangling with pandas Cheat Sheet
<a class="reference external" href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf</a></p></li>
<li><p>Pandas Basics from the Python For Data Science Cheat Sheet collection<br />
<a class="reference external" href="https://datacamp-community-prod.s3.amazonaws.com/dbed353d-2757-4617-8206-8767ab379ab3">https://datacamp-community-prod.s3.amazonaws.com/dbed353d-2757-4617-8206-8767ab379ab3</a><br />
see also <a class="reference external" href="https://www.datacamp.com/blog/pandas-cheat-sheet-for-data-science-in-python">https://www.datacamp.com/blog/pandas-cheat-sheet-for-data-science-in-python</a></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame Object<br />
<a class="reference external" href="https://www.webpages.uidaho.edu/~stevel/cheatsheets/Pandas%20DataFrame%20Notes_12pages.pdf">https://www.webpages.uidaho.edu/~stevel/cheatsheets/Pandas DataFrame Notes_12pages.pdf</a></p></li>
</ul>
</section>
<section id="tutorials">
<h3>Tutorials<a class="headerlink" href="#tutorials" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Getting started with pandas tutorial<br />
<a class="reference external" href="https://www.efavdb.com/pandas-tips-and-tricks">https://www.efavdb.com/pandas-tips-and-tricks</a></p></li>
<li><p>Making head and tails of Pandas<br />
<a class="reference external" href="https://www.youtube.com/watch?v=otCriSKVV_8">https://www.youtube.com/watch?v=otCriSKVV_8</a>
<a class="github reference external" href="https://github.com/tomaugspurger/pydataseattle">tomaugspurger/pydataseattle</a></p></li>
<li><p>Essential basic functionality (very good)<br />
<a class="reference external" href="https://pandas.pydata.org/docs/user_guide/basics.html">https://pandas.pydata.org/docs/user_guide/basics.html</a></p></li>
<li><p>The 10 minutes to Pandas tutorial<br />
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html</a></p></li>
<li><p>Effective Pandas tutorial by Matt Harrison
(Use appropriate data types to save memory. Lots of examples of method chaining.)<br />
<a class="reference external" href="https://www.youtube.com/watch?v=zgbUk90aQ6A&amp;amp;t=526s">https://www.youtube.com/watch?v=zgbUk90aQ6A&amp;t=526s</a></p></li>
<li><p>Overview of Pandas data frame operations<br />
<a class="reference external" href="https://devopedia.org/pandas-dataframe-operations">https://devopedia.org/pandas-dataframe-operations</a></p></li>
<li><p>Nice examples of data frames with variety of data types and compact reference of all operations<br />
<a class="reference external" href="https://dataframes.juliadata.org/stable/man/comparisons/#Comparison-with-the-Python-package-pandas">https://dataframes.juliadata.org/stable/man/comparisons/#Comparison-with-the-Python-package-pandas</a><br />
see also <a class="github reference external" href="https://github.com/bkamins/Julia-DataFrames-Tutorial/">bkamins/Julia-DataFrames-Tutorial</a></p></li>
<li><p>Pandas: Python Data Analysis Library<br />
<a class="reference external" href="https://johnfoster.pge.utexas.edu/numerical-methods-book/ScientificPython_Pandas.html">https://johnfoster.pge.utexas.edu/numerical-methods-book/ScientificPython_Pandas.html</a><br />
See also <a class="reference external" href="https://github.com/johnfoster-pge-utexas/numerical-methods-book/blob/master/content/ScientificPython_Pandas.ipynb">notebook</a>
and <a class="reference external" href="https://github.com/johnfoster-pge-utexas/numerical-methods-book/tree/master/content">src</a>.</p></li>
<li><p>Pandas sections from <em>Python Data Science Handbook</em>
<a class="reference external" href="https://www.one-tab.com/page/OaSZriUtRg6wb7mppbamag">https://www.one-tab.com/page/OaSZriUtRg6wb7mppbamag</a><br />
via <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/">https://jakevdp.github.io/PythonDataScienceHandbook/</a></p></li>
<li><p>Pandas tutorials – lots of details<br />
<a class="reference external" href="https://www.one-tab.com/page/Iw-cytCuTe-FiNZ7F1nrww">https://www.one-tab.com/page/Iw-cytCuTe-FiNZ7F1nrww</a></p></li>
<li><p>Tutorial notebooks from DataCamp<br />
<a class="reference external" href="https://trenton3983.github.io/files/projects/2019-01-24_pandas_dataframes/2019-01-24_pandas_dataframes.html">https://trenton3983.github.io/files/projects/2019-01-24_pandas_dataframes/2019-01-24_pandas_dataframes.html</a><br />
<a class="reference external" href="https://trenton3983.github.io/files/projects/2019-02-04_manipulating_dataframes_with_pandas/2019-02-04_manipulating_dataframes_with_pandas.html">https://trenton3983.github.io/files/projects/2019-02-04_manipulating_dataframes_with_pandas/2019-02-04_manipulating_dataframes_with_pandas.html</a></p></li>
<li><p>Lots of simple tasks<br />
<a class="reference external" href="https://nbviewer.org/github/justmarkham/pandas-videos/blob/master/pandas.ipynb">https://nbviewer.org/github/justmarkham/pandas-videos/blob/master/pandas.ipynb</a></p></li>
<li><p>SciPy 2015 Tutorial by Chris Fonnesbeck<br />
<a class="reference external" href="https://www.youtube.com/watch?v=heFaYLKVZY4">https://www.youtube.com/watch?v=heFaYLKVZY4</a>
and the associated git repo: <a class="github reference external" href="https://github.com/fonnesbeck/scipy2015_tutorial">fonnesbeck/scipy2015_tutorial</a></p></li>
<li><p>Notebook with advanced Pandas tricks by Chip Huyen<br />
<a class="github reference external" href="https://github.com/chiphuyen/just-pandas-things/blob/master/just-pandas-things.ipynb">chiphuyen/just-pandas-things</a></p></li>
</ul>
</section>
<section id="id1">
<h3>Data cleaning<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Tidying Data tutorial by Daniel Chen (Lots of examples of melt operations on real-world datasets)<br />
<a class="reference external" href="https://www.youtube.com/watch?v=iYie42M1ZyU">https://www.youtube.com/watch?v=iYie42M1ZyU</a>
<a class="github reference external" href="https://github.com/chendaniely/pydatadc_2018-tidy/blob/master/notebooks/tidy.ipynb">chendaniely/pydatadc_2018-tidy</a></p></li>
<li><p>Data Cleaning lab from Applied &amp; Computational Mathematics Emphasis (ACME) course<br />
<a class="reference external" href="https://acme.byu.edu/0000017c-ccff-da17-a5fd-cdff03570000/acmefiles-09-datacleaning-2021-pdf">https://acme.byu.edu/0000017c-ccff-da17-a5fd-cdff03570000/acmefiles-09-datacleaning-2021-pdf</a><br />
See more <a class="reference external" href="https://acme.byu.edu/2021-2022-materials">materials here</a>.</p></li>
<li><p><a class="github reference external" href="https://github.com/hxchua/datadoubleconfirm/blob/master/EuroPython/DataCleaning.ipynb">hxchua/datadoubleconfirm</a></p></li>
<li><p>Visualizations of Pandas operations (click on examples)
<a class="reference external" href="https://pandastutor.com/vis.html">https://pandastutor.com/vis.html</a></p></li>
<li><p>A talk on data cleaning principles by Karl Broman
<a class="reference external" href="https://www.youtube.com/watch?v=7Ma8WIDinDc">https://www.youtube.com/watch?v=7Ma8WIDinDc</a><br />
slides <a class="reference external" href="https://kbroman.org/Talk_DataCleaning/data_cleaning.pdf">https://kbroman.org/Talk_DataCleaning/data_cleaning.pdf</a></p></li>
<li><p><a class="reference external" href="https://datascienceinpractice.github.io/tutorials/06-DataWrangling.html">https://datascienceinpractice.github.io/tutorials/06-DataWrangling.html</a></p></li>
<li><p><a class="reference external" href="https://datascienceinpractice.github.io/tutorials/07-DataCleaning.html">https://datascienceinpractice.github.io/tutorials/07-DataCleaning.html</a></p></li>
<li><p><a class="reference external" href="https://www.mariakhalusova.com/posts/2019-01-31-cleaning-data-with-pandas/">https://www.mariakhalusova.com/posts/2019-01-31-cleaning-data-with-pandas/</a></p></li>
<li><p><a class="reference external" href="https://counting.substack.com/p/data-cleaning-is-analysis-not-grunt">https://counting.substack.com/p/data-cleaning-is-analysis-not-grunt</a></p></li>
<li><p>Data cleaning principles by Karl Broman<br />
<a class="reference external" href="https://www.youtube.com/watch?v=7Ma8WIDinDc">https://www.youtube.com/watch?v=7Ma8WIDinDc</a><br />
and slides: <a class="reference external" href="https://kbroman.org/Talk_DataCleaning/data_cleaning.pdf">https://kbroman.org/Talk_DataCleaning/data_cleaning.pdf</a></p></li>
</ul>
<!--
COMMAND LINE CLEANUP
http://mchap.io/using-foia-data-and-unix-to-halve-major-source-of-parking-tickets.html
via https://news.ycombinator.com/item?id=17754105
-->
</section>
<section id="articles">
<h3>Articles<a class="headerlink" href="#articles" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><em>pandas: a Foundational Python Library for Data Analysis and Statistics</em> by Wes McKinney<br />
<a class="reference external" href="https://www.dlr.de/sc/Portaldata/15/Resources/dokumente/pyhpc2011/submissions/pyhpc2011_submission_9.pdf">https://www.dlr.de/sc/Portaldata/15/Resources/dokumente/pyhpc2011/submissions/pyhpc2011_submission_9.pdf</a></p></li>
<li><p>More Pandas articles and links<br />
<a class="reference external" href="https://www.one-tab.com/page/-EZFbibXRq2xZRYM9iUVDg">https://www.one-tab.com/page/-EZFbibXRq2xZRYM9iUVDg</a></p></li>
<li><p>Good tips about <code class="docutils literal notranslate"><span class="pre">loc</span></code> vs. <code class="docutils literal notranslate"><span class="pre">[]</span></code><br />
<a class="reference external" href="https://stackoverflow.com/a/48411543/127114">https://stackoverflow.com/a/48411543/127114</a></p></li>
<li><p>Devoperia articles on Pandas:<br />
<a class="reference external" href="https://devopedia.org/pandas-dataframe-operations">data frame operations</a><br />
<a class="reference external" href="https://devopedia.org/pandas-data-structures">data structures</a><br />
<a class="reference external" href="https://devopedia.org/data-preparation">data preparation</a></p></li>
</ul>
</section>
<section id="books">
<h3>Books<a class="headerlink" href="#books" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://store.metasnake.com/effective-pandas-book">https://store.metasnake.com/effective-pandas-book</a></p></li>
</ul>
<!--

TODO import links from gdoc

### R learning resources

- https://www.one-tab.com/page/4P1d6YLhQKm1FthXB4qRzg
- https://remkoduursma.github.io/learningguidetor/dataskills1.html
- https://remkoduursma.github.io/learningguidetor/dataskills2.html		

#### Tidy data in R
- https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html
- https://datasciencebook.ca/wrangling.html
- https://moderndive.com/3-wrangling.html 
- https://github.com/jennybc/lotr-tidy/


-->
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstats",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/tutorials/src"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-overview">Pandas overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning objectives</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-pandas-and-other-libraries">Installing Pandas and other libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-display-options">Setting display options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-datasets">Download datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames">Data frames</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-data-frame-from-a-csv-file">Creating a data frame from a CSV file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frame-properties">Data frame properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rows-index">Rows index</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#columns-index">Columns index</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-data-types-and-momory-usage">Shape, data types, and momory usage</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-and-selecting-values">Accessing and selecting values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-individual-values">Accessing individual values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-entire-rows">Selecting entire rows</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-entire-columns">Selecting entire columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-multiple-columns">Selecting multiple columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-only-certain-rows">Selecting only certain rows</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-data-frames-from-python-objects">Creating data frames from Python objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-frames-exercises">Data frames exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-select-a-column">Exercise 1: Select a column</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2-select-rows">Exercise 2: Select rows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#series">Series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-properties">Series properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-calculations">Series calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-pandas-series-from-python-lists">Creating Pandas series from Python lists</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#series-exercises">Series exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-grouping-and-aggregation">Sorting, grouping, and aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-and-ranking">Sorting and ranking</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ranking-values">Ranking values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-by-and-aggregation">Group by and aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-1-pandas-method-chaining">Sidenote 1: Pandas method chaining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sidenote-2-line-continuation-strategies">Sidenote 2: Line-continuation strategies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-values">Counting values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-pivot-table-for-aggregation">Using <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> for aggregation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting-and-aggregation-exercises">Sorting and aggregation exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-transformations">Data transformations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-new-columns">Adding new columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoiding-in-place-modifications">Avoiding in-place modifications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-assign-method">The <code class="docutils literal notranslate"><span class="pre">assign</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-apply-method">The <code class="docutils literal notranslate"><span class="pre">apply</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dropping-rows-and-and-columns">Dropping rows and and columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#renaming-columns-and-values">Renaming columns and values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-data-frames">Reshaping data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy-data">Tidy data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#string-methods">String methods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-data-frames">Merging data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenating-data-frames">Concatenating data frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-type-conversions">Data type conversions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-and-dummy-coding-for-categorical-variables">One-hot and dummy coding for categorical variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transpose">Transpose</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation-exercises">Transformation exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data cleaning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standardize-categorical-values">Standardize categorical values</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9-cleaning-the-cats-data">Exercise 9: cleaning the cats data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#number-formatting-errors">Number formatting errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-values">Dealing with missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-duplicates">Removing duplicates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#identifying-and-removing-outliers">Identifying and removing outliers</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#why-outliers-are-problematic">Why outliers are problematic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#criteria-for-identifying-outliers">Criteria for identifying outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-inspection-of-the-data">Visual inspection of the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tukey-outliers">Tukey outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-outliers-using-z-scores">Detecting outliers using z-scores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-outliers">Removing outliers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-exclude-outliers">When to exclude outliers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-data-cleaning">Summary of data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning-exercises">Data cleaning exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-extraction">Data extraction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-formats">Data formats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-files">CSV files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets-files">Spreadsheets files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tsv-files">TSV files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#json-files">JSON files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-in-html-files">Tables in HTML files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite-database-files">SQLite database files</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-extraction-exercises">Data extraction exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#case-studies">Case studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-apples-dataset">Collecting the apples dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-electricity-prices-dataset">Collecting the electricity prices dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-students-dataset">Collecting the students dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-kombucha-dataset">Collecting the kombucha dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-the-doctors-dataset">Collecting the doctors dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-the-players-dataset">Generating the players dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternatives-to-pandas">Alternatives to Pandas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#links">Links</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#music-videos">Music videos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-concepts">General concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cheatsheets">Cheatsheets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorials">Tutorials</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#articles">Articles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#books">Books</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ivan Savov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>