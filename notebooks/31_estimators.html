
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Section 3.1 — Estimators &#8212; No BS Stats Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/31_estimators';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exercises for Section 3.1 Estimates and estimators" href="../exercises/exercises_31_estimtors.html" />
    <link rel="prev" title="Chapter 3 — Classical statistics" href="30_STATS.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="No BS Stats Notebooks - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="No BS Stats Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    No Bullshit Guide to Statistics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="10_DATA.html">Chapter 1 — Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="11_intro_to_data.html">Section 1.1 — Introduction to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_data_in_practice.html">Section 1.2 — Data in practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_descriptive_statistics.html">Section 1.3 — Descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/exercises_13_descr_stats.html">Descriptive statistics exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="20_PROB.html">Chapter 2 — Probability theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="21_discrete_random_vars.html">Section 2.1 — Discrete random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="22_multiple_random_vars.html">Section 2.2 — Multiple random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="23_inventory_discrete_dists.html">Section 2.3 — Inventory of discrete distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="24_continuous_random_vars.html">Section 2.4 — Continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="25_multiple_continuous_random_vars.html">Section 2.5 — Multiple continuous random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="26_inventory_continuous_dists.html">Section 2.6 — Inventory of continuous distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="28_random_samples.html">Section 2.8 — Probability models for random samples</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="30_STATS.html">Chapter 3 — Classical statistics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Section 3.1 — Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/exercises_31_estimtors.html">Exercises for Section 3.1 Estimates and estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="32_confidence_intervals.html">Section 3.2 — Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/exercises_32_confidence_intervals.html">Exercises for Section 3.2 Confidence intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="33_intro_to_NHST.html">Section 3.3 — Introduction to hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="34_analytical_approx.html">Section 3.4 — Hypothesis testing using analytical approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="35_two_sample_tests.html">Section 3.5 — Two-sample hypothesis tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="36_design.html">Section 3.6 — Statistical design and error analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="37_inventory_stats_tests.html">Section 3.7 — Inventory of statistical tests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../examples/README.html">Statistical analysis examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/statistical_design.html">Statistical design examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/one_sample_z-test.html">One-sample z-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/one_sample_t-test.html">One-sample t-test for the mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/two_sample_t-test.html">Welch’s two-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/ANOVA.html">Analysis of variance (ANOVA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/two_sample_equivalence_test.html">Two-sample equivalence test</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="40_LINEAR_MODELS.html">Chapter 4 — Linear models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="41_simple_linear_regression.html">Section 4.1 — Simple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="42_multiple_linear_regression.html">Section 4.2 — Multiple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="43_interpreting_linear_models.html">Section 4.3 — Interpreting linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="44_regression_with_categorical_predictors.html">Section 4.4 — Regression with categorical predictors</a></li>
<li class="toctree-l2"><a class="reference internal" href="45_causal_inference.html">Section 4.5 — Model selection for causal inference</a></li>

<li class="toctree-l2"><a class="reference internal" href="46_generalized_linear_models.html">Section 4.6 — Generalized linear models</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="50_BAYESIAN_STATS.html">Chapter 5 — Bayesian statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="51_intro_to_Bayesian_stats.html">Section 5.1 — Introduction to Bayesian statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="52_Bayesian_inference_computations.html">Section 5.2 — Bayesian inference computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="53_Bayesian_linear_models.html">Section 5.3 — Bayesian linear models</a></li>

<li class="toctree-l2"><a class="reference internal" href="54_difference_between_means.html">Section 5.4 — Bayesian difference between means</a></li>

<li class="toctree-l2"><a class="reference internal" href="55_hierarchical_models.html">Section 5.5 — Hierarchical models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/appendix.html">Appendix</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/python_tutorial.html">Appendix C — Python tutorial</a></li>












<li class="toctree-l2"><a class="reference internal" href="../tutorials/pandas_tutorial.html">Appendix D — Pandas tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/seaborn_tutorial.html">Appendix E — Seaborn tutorial</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/calculus_tutorial.html">Calculus tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../blogposts/index.html">Blog posts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/python_for_stats.html">Using Python for learning statistics Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/probability_models.html">Using Python for probability calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/sampling_distributions.html">Sampling distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/bootstrap.html">Bootstrap estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/simulation_hypothesis_tests.html">Hypothesis testing using simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/permutation_test.html">Permutation tests for comparing two groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/stats_procedures.html">Python libraries for doing statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blogposts/python_stats_libraries.html">Python libraries for doing statistics</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/minireference/noBSstats/main?urlpath=lab/tree/./notebooks/31_estimators.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/minireference/noBSstats" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/minireference/noBSstats/issues/new?title=Issue%20on%20page%20%2Fnotebooks/31_estimators.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/31_estimators.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Section 3.1 — Estimators</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-sampling-distributions">Applications of sampling distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-data-concepts">Review of data concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-probability-concepts">Review of probability concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-concepts">New concepts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimators">Estimators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-mean-estimator">Sample mean estimator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-variance-and-standard-deviation">Sample variance and standard deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-apple-weight-mean-and-variance">Example 1: apple weight mean and variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-kombucha-volume-mean-and-variance">Example 2: kombucha volume mean and variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-sample-means-estimator">Difference between sample means estimator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-comparison-of-electricity-prices">Example 3: comparison of electricity prices</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distributions">Sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4">Example 4</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration">Illustration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimator-properties">Estimator properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Illustration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-approach-to-sampling-distributions">Computational approach to sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-sampling-distributions-of-the-kombucha-volume">Example 5: sampling distributions of the kombucha volume</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean">Sampling distribution of the mean</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-variance">Sampling distribution of the variance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-sampling-distribution">Approximating sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-estimation">Bootstrap estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minimal-example">Minimal example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-bootstrap-samples-example">Interactive bootstrap samples example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-purpose-bootstrap-estimation-function">General-purpose bootstrap estimation function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-6">Example 6</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-approximation-formulas">Analytical approximation formulas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#central-limit-theorem">Central limit theorem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Sampling distribution of the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#true-sampling-distribution">True sampling distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-of-the-central-limit-theorem">Prediction of the central limit theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-plug-in-principle">The plug-in principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-approximation-to-the-sampling-distribution">Normal approximation to the sampling distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-better-approximation">A better approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-sample-mean">Bootstrapped sampling distribution of the sample mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Sampling distribution of the variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Sampling distribution of the variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-sample-variance">Bootstrapped sampling distribution of the sample variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-means-estimator">Difference between means estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-formula-for-the-sampling-distribution">Analytical formula for the sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#approximation-using-student-s-t-distribution">Approximation using Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-7-difference-between-electricity-prices">Example 7: difference between electricity prices</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-difference-between-means">Bootstrapped sampling distribution of the difference between means</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-calculation-methods">Alternative calculation methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-statsmodels-for-bootstrap-estimation">Using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> for bootstrap estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-mean">Bootstrap mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-difference-between-mean">Bootstrap difference between mean</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biased-and-unbiased-estimators-for-the-population-variance">Biased and unbiased estimators for the population variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pivotal-quantities">Pivotal quantities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shifted-sampling-distributions">Shifted sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation-of-the-apples-weights">Estimation of the apples weights</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kombucha-volume-probabilities">Kombucha volume probabilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="section-3-1-estimators">
<h1>Section 3.1 — Estimators<a class="headerlink" href="#section-3-1-estimators" title="Link to this heading">#</a></h1>
<p>This notebook contains the code examples from <a class="reference internal" href="#"><span class="xref myst">Section 3.1 Estimators</span></a> of the <strong>No Bullshit Guide to Statistics</strong>. Use the “rocket” icon at the top-right to make the code cells interactive (Live Code), or run this notebook an ephemeral JupyterLab cloud instance (Binder).</p>
<p>We’ll begin our study of inferential statistics by introducing <strong>estimators</strong>,
which are the math tools used for computing <strong>confidence intervals</strong> and running <strong>hypothesis tests</strong>.</p>
<p><img alt="simplified_estimators.png" src="../_images/simplified_estimators.png" /></p>
<section id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load Python modules</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --quiet ministats
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">25.2</span> -&gt; <span class=" -Color -Color-Green">25.3</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot helper functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_pdf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figures setup</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plot_helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">RCPARAMS</span>
<span class="n">RCPARAMS</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span>
    <span class="n">rc</span><span class="o">=</span><span class="n">RCPARAMS</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Useful colors</span>
<span class="n">snspal</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>
<span class="n">blue</span><span class="p">,</span> <span class="n">orange</span><span class="p">,</span> <span class="n">purple</span> <span class="o">=</span> <span class="n">snspal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">snspal</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">snspal</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># High-resolution please</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simple float __repr__</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s1">&#39;1.25&#39;</span><span class="p">)</span>

<span class="c1"># set random seed for repeatability</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\def\stderr#1{\mathbf{se}_{#1}}\)</span>
<span class="math notranslate nohighlight">\(\def\stderrhat#1{\hat{\mathbf{se}}_{#1}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Mean}{\textbf{Mean}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Var}{\textbf{Var}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Std}{\textbf{Std}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Freq}{\textbf{Freq}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\RelFreq}{\textbf{RelFreq}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DMeans}{\textbf{DMeans}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Prop}{\textbf{Prop}}\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DProps}{\textbf{DProps}}\)</span></p>
<p>(this cell contains the macro definitions <span class="math notranslate nohighlight">\(\stderr{\theta}\)</span>, <span class="math notranslate nohighlight">\(\stderrhat{}\)</span>, <span class="math notranslate nohighlight">\(\Mean\)</span>, …)</p>
</section>
<section id="applications-of-sampling-distributions">
<h2>Applications of sampling distributions<a class="headerlink" href="#applications-of-sampling-distributions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Parameter estimates</p></li>
<li><p>Confidence intervals (next section)</p></li>
<li><p>Test statistics (remainder of the sections in this chapter)</p></li>
</ul>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<section id="review-of-data-concepts">
<h3>Review of data concepts<a class="headerlink" href="#review-of-data-concepts" title="Link to this heading">#</a></h3>
<p>To get things started, let’s review the data analysis concepts:</p>
<ul class="simple">
<li><p><em>Population</em>: the entire group of individuals we’re interested in.
We generally assume it’s impossible to collect measurements for the
entire population, because it consists of thousands or millions of
individuals.</p></li>
<li><p><em>Sample</em> <span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \ldots, x_n)\)</span>: a sequence of <span class="math notranslate nohighlight">\(n\)</span>
observations from the population. Each <span class="math notranslate nohighlight">\(x_i\)</span> corresponds to a
measurement from one individual randomly selected from the
population.</p></li>
<li><p><em>Sample statistic</em>: any quantity computed from the sample
<span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p></li>
<li><p><em>Descriptive statistics</em>: numerical summaries that describe the
characteristics of the sample <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. Example of descriptive
statistics include, the sample mean <span class="math notranslate nohighlight">\(\overline{\mathbf{x}}\)</span>, the
sample variance <span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2\)</span>, and the sample standard
deviation <span class="math notranslate nohighlight">\(s_{\mathbf{x}}\)</span>.</p></li>
</ul>
</section>
<section id="review-of-probability-concepts">
<h3>Review of probability concepts<a class="headerlink" href="#review-of-probability-concepts" title="Link to this heading">#</a></h3>
<p>Let’s review the main concepts and the notation we used to describe probability models:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X \sim \mathcal{M}(\theta)\)</span>: the <em>population probability model</em> describes
the variability of the data in the population as a random variable
<span class="math notranslate nohighlight">\(X\)</span> with probability distribution <span class="math notranslate nohighlight">\(f_X\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{M}\)</span>: the <em>model family</em> describes the general “shape” of the
distribution. Examples of probability model families include the
uniform <span class="math notranslate nohighlight">\(\mathcal{U}\)</span>, the normal <span class="math notranslate nohighlight">\(\mathcal{N}\)</span>, and the exponential <span class="math notranslate nohighlight">\(\text{Expon}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta\)</span>: the <em>model parameters</em> that describe the specific
population. Examples of model parameters: <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> for
uniform models, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> for normal models, and <span class="math notranslate nohighlight">\(\lambda\)</span>
for exponential models.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tt{rvX}\)</span>: the <em>computer model</em> of the random variable
<span class="math notranslate nohighlight">\(X \sim \mathcal{M}(\theta)\)</span>.</p></li>
<li><p><em>Random sample</em> <span class="math notranslate nohighlight">\(\mathbf{X} = (X_1, X_2, \ldots, X_n)\)</span>: a sequence
of <span class="math notranslate nohighlight">\(n\)</span> observations from the population model. Each <span class="math notranslate nohighlight">\(X_i\)</span> is an
independent copy of the random variable <span class="math notranslate nohighlight">\(X \sim \mathcal{M}(\theta)\)</span>.</p></li>
</ul>
</section>
<section id="new-concepts">
<h3>New concepts<a class="headerlink" href="#new-concepts" title="Link to this heading">#</a></h3>
<p>Building on the DATA and PROB definitions, we can now introduce the
notation and terminology around estimators:</p>
<ul class="simple">
<li><p><em>Estimate</em> <span class="math notranslate nohighlight">\(\hat{\theta}\)</span>: a statistic computed from the sample
<span class="math notranslate nohighlight">\(\mathbf{x}\)</span> for the purpose of making inferences about a population
parameter <span class="math notranslate nohighlight">\(\theta\)</span>. For example, the sample mean
<span class="math notranslate nohighlight">\(\overline{\mathbf{x}}\)</span> is an estimate of the population mean
<span class="math notranslate nohighlight">\(\mu_X\)</span>.</p></li>
<li><p><em>Estimator</em> <span class="math notranslate nohighlight">\(g : \mathcal{X}^n \to \mathbb{R}\)</span>: the function that we use
to compute the estimate <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> from a given sample
<span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \ldots, x_n)\)</span>. We denote this as
<span class="math notranslate nohighlight">\(\hat{\theta} = g(\mathbf{x})\)</span>. For example, the estimator
<span class="math notranslate nohighlight">\(\Mean\)</span> is defined as the function
<span class="math notranslate nohighlight">\(\Mean(\mathbf{x}) = \tfrac{1}{n}\!\sum_{i=1}^n x_i\)</span>. We use
the estimator <span class="math notranslate nohighlight">\(\Mean\)</span> to compute the sample mean estimate
<span class="math notranslate nohighlight">\(\overline{\mathbf{x}}\)</span>.</p></li>
<li><p>The <em>sampling distribution</em> of the estimator <span class="math notranslate nohighlight">\(g\)</span> is denoted
<span class="math notranslate nohighlight">\(\hat{\Theta} = g(\mathbf{X})\)</span> and describes the estimates we
can expect to observe from random samples from the population
<span class="math notranslate nohighlight">\(\mathbf{X} = (X_1, X_2, \ldots, X_n)\)</span>. For example, the sampling
distribution of the mean is the random variable
<span class="math notranslate nohighlight">\(\overline{\mathbf{X}} = \Mean(\mathbf{X}) = \tfrac{1}{n}\!\sum_{i=1}^n X_i\)</span>.</p></li>
<li><p>The <em>standard error</em> of an estimator <span class="math notranslate nohighlight">\(g\)</span> is denoted
<span class="math notranslate nohighlight">\(\stderr{\hat{\theta}}\)</span> and describes the standard deviation of its
sampling distribution. For example, the standard error of the mean
is denoted <span class="math notranslate nohighlight">\(\stderr{\overline{\mathbf{x}}}\)</span>.</p></li>
</ul>
<p><img alt="estimator from particular sample" src="../_images/Esimators_contexA1.png" /></p>
<p>Statistical inference is the use the values of the statistics obtained from the sample <span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \ldots, x_n)\)</span> to estimate the population parameters <span class="math notranslate nohighlight">\(\theta\)</span>. For example,
the sample mean <span class="math notranslate nohighlight">\(\overline{\mathbf{x}}=\Mean(\mathbf{x})\)</span> is an estimate of the population mean <span class="math notranslate nohighlight">\(\mu\)</span>,
and the sample variance <span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2=\Var(\mathbf{x})\)</span> is an estimate of the population variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>.</p>
</section>
</section>
<section id="estimators">
<h2>Estimators<a class="headerlink" href="#estimators" title="Link to this heading">#</a></h2>
<p>Let’s start with some estimators you’re already familiar with (discussed in <a class="reference internal" href="13_descriptive_statistics.html"><span class="std std-doc">descriptive statistics</span></a>):</p>
<section id="sample-mean-estimator">
<h3>Sample mean estimator<a class="headerlink" href="#sample-mean-estimator" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>estimator: <span class="math notranslate nohighlight">\(\overline{\mathbf{x}} = \Mean(\mathbf{x}) = \frac{1}{n}\sum_{i=1}^n x_i\)</span></p></li>
<li><p>gives an estimate for the population mean <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="c1"># ALT. use .mean() method on a Pandas series</span>
<span class="c1"># ALT. use np.mean(sample)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sample-variance-and-standard-deviation">
<h3>Sample variance and standard deviation<a class="headerlink" href="#sample-variance-and-standard-deviation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>estimator: <span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2 = \Var(\mathbf{x}) = \frac{1}{n-1}\sum_{i=1}^n (x_i-\overline{\mathbf{x}})^2\)</span></p></li>
<li><p>gives an estimate for the population variance <span class="math notranslate nohighlight">\(\sigma^2\)</span></p></li>
<li><p>note the denominator is <span class="math notranslate nohighlight">\((n-1)\)</span> and not <span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">xbar</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">sumsqdevs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">xi</span><span class="o">-</span><span class="n">xbar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sumsqdevs</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># ALT. use .var() method on a Pandas series</span>
<span class="c1"># ALT. use np.var(sample, ddof=1)</span>
</pre></div>
</div>
</div>
</div>
<p>The standard deviation <span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2\)</span> is the square root of the sample variance:</p>
<div class="math notranslate nohighlight">
\[
  \sqrt{s_{\mathbf{x}}^2}
   =  s_{\mathbf{x}}
   = \Std(\mathbf{x})
   = \sqrt{ \frac{1}{n-1}\sum_{i=1}^n (x_i-\overline{\mathbf{x}})^2 }.
\]</div>
<p>We can now define a Python function <code class="docutils literal notranslate"><span class="pre">std</span></code> for computing the standard deviation by taking the square root of the variance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">std</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>

<span class="c1"># ALT. use .std() method on a Pandas series</span>
<span class="c1"># ALT. use np.std(sample, ddof=1)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-1-apple-weight-mean-and-variance">
<h3>Example 1: apple weight mean and variance<a class="headerlink" href="#example-1-apple-weight-mean-and-variance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/apples.csv&quot;</span><span class="p">)</span>
<span class="n">asample</span> <span class="o">=</span> <span class="n">apples</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="n">asample</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">asample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># asample</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">asample</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asample</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([205., 182., 192., 189., 217., 192., 210., 240., 225., 191., 193.,
       209., 167., 183., 210., 198., 239., 188., 179., 182., 200., 197.,
       245., 192., 201., 218., 198., 211., 208., 217.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">asample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/3cf5fc52923cf68035477f4a2571a3bdc2f5b9e9198e1e6f93ea689c91ee85bf.png"><img alt="../_images/3cf5fc52923cf68035477f4a2571a3bdc2f5b9e9198e1e6f93ea689c91ee85bf.png" src="../_images/3cf5fc52923cf68035477f4a2571a3bdc2f5b9e9198e1e6f93ea689c91ee85bf.png" style="width: 833px; height: 293px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">asample</span><span class="p">,</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/297a8618c034ba6b71b67bbb2d2221a35c60bce8489ea9651d185feae75632be.png"><img alt="../_images/297a8618c034ba6b71b67bbb2d2221a35c60bce8489ea9651d185feae75632be.png" src="../_images/297a8618c034ba6b71b67bbb2d2221a35c60bce8489ea9651d185feae75632be.png" style="width: 860px; height: 293px;" />
</a>
</div>
</div>
<p>Next let’s calculate the mean of the sample:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">asample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>202.6
</pre></div>
</div>
</div>
</div>
<p>Let’s also calculate the variance and the standard deviation of the sample of the apple weights:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="n">asample</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">asample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(345.9724137931035, 18.60033370112223)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ALT. call `.describe()` to get five-point summary</span>
<span class="n">asample</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     30.000000
mean     202.600000
std       18.600334
min      167.000000
25%      191.250000
50%      199.000000
75%      210.750000
max      245.000000
Name: weight, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-2-kombucha-volume-mean-and-variance">
<h3>Example 2: kombucha volume mean and variance<a class="headerlink" href="#example-2-kombucha-volume-mean-and-variance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="c1"># kombucha</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">batch01</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ksample01</span> <span class="o">=</span> <span class="n">batch01</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="n">ksample01</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ksample01</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1016.24,  993.88,  994.72,  989.27, 1008.65,  976.98, 1017.45,
        992.39, 1003.19,  997.51, 1014.62,  979.4 ,  996.78,  996.16,
       1011.34,  989.  ,  998.28,  991.22, 1000.42, 1005.83,  988.99,
       1011.45, 1009.02, 1005.02, 1009.01,  993.16,  998.77,  990.64,
        997.32, 1005.3 ,  993.08,  996.03,  993.13,  991.55,  993.29,
        999.87,  988.83, 1002.34, 1016.6 , 1007.42])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ksample01</span><span class="p">,</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/a3c9a5a2af7bf9255a325fcad1c3f3573cf2579f327c3011b42284a1988959a9.png"><img alt="../_images/a3c9a5a2af7bf9255a325fcad1c3f3573cf2579f327c3011b42284a1988959a9.png" src="../_images/a3c9a5a2af7bf9255a325fcad1c3f3573cf2579f327c3011b42284a1988959a9.png" style="width: 852px; height: 293px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">ksample01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>999.10375
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="n">ksample01</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">ksample01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(95.43654198717958, 9.769162808919686)
</pre></div>
</div>
</div>
</div>
</section>
<section id="difference-between-sample-means-estimator">
<h3>Difference between sample means estimator<a class="headerlink" href="#difference-between-sample-means-estimator" title="Link to this heading">#</a></h3>
<p>We’ll now discuss an estimators that is specific for the comparison of the two groups.</p>
<ul class="simple">
<li><p>estimator: <span class="math notranslate nohighlight">\(\hat{d} = \DMeans(\mathbf{x}_A, \mathbf{x}_B) = \Mean(\mathbf{x}_A) - \Mean(\mathbf{x}_B) = \overline{\mathbf{x}}_A - \overline{\mathbf{x}}_B\)</span></p></li>
<li><p>gives an estimate for the difference between population means: <span class="math notranslate nohighlight">\(\Delta =  \mu_A - \mu_B\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">dmeans</span><span class="p">(</span><span class="n">xsample</span><span class="p">,</span> <span class="n">ysample</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the difference between group means of the samples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dhat</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">xsample</span><span class="p">)</span> <span class="o">-</span> <span class="n">mean</span><span class="p">(</span><span class="n">ysample</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dhat</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-3-comparison-of-electricity-prices">
<h3>Example 3: comparison of electricity prices<a class="headerlink" href="#example-3-comparison-of-electricity-prices" title="Link to this heading">#</a></h3>
<p>Let’s compute the difference between means of the East and West electricity prices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eprices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/eprices.csv&quot;</span><span class="p">)</span>
<span class="c1"># eprices</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epricesW</span> <span class="o">=</span> <span class="n">eprices</span><span class="p">[</span><span class="n">eprices</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;West&quot;</span><span class="p">]</span>
<span class="n">pricesW</span> <span class="o">=</span> <span class="n">epricesW</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
<span class="n">pricesW</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([11.8, 10. , 11. ,  8.6,  8.3,  9.4,  8. ,  6.8,  8.5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">pricesW</span><span class="p">),</span> <span class="n">var</span><span class="p">(</span><span class="n">pricesW</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9.155555555555555, 2.440277777777778)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epricesE</span> <span class="o">=</span> <span class="n">eprices</span><span class="p">[</span><span class="n">eprices</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;East&quot;</span><span class="p">]</span>
<span class="n">pricesE</span> <span class="o">=</span> <span class="n">epricesE</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
<span class="n">pricesE</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([7.7, 5.9, 7. , 4.8, 6.3, 6.3, 5.5, 5.4, 6.5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">pricesE</span><span class="p">),</span> <span class="n">var</span><span class="p">(</span><span class="n">pricesE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6.155555555555555, 0.7702777777777777)
</pre></div>
</div>
</div>
</div>
<p>Let’s calculate the mean of the prices in the East and the West:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">pricesW</span><span class="p">),</span> <span class="n">mean</span><span class="p">(</span><span class="n">pricesE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9.155555555555555, 6.155555555555555)
</pre></div>
</div>
</div>
</div>
<p>To calculate the difference between means,
we can simply subtract these two numbers <span class="math notranslate nohighlight">\(\hat{d} = \overline{\mathbf{x}}_W - \overline{\mathbf{x}}_E\)</span>,
or simply call the function <code class="docutils literal notranslate"><span class="pre">dmeans</span></code>
which computes the estimate <span class="math notranslate nohighlight">\(\hat{d} = \textbf{DMeans}(\tt{pricesW}, \tt{pricesE})\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dmeans</span><span class="p">(</span><span class="n">pricesW</span><span class="p">,</span> <span class="n">pricesE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<p>According to this estimate,
the average price Rob can expect in the East end is three cents cheaper,
on average,
as compared to the average electricity price in the West.</p>
</section>
</section>
<section id="sampling-distributions">
<h2>Sampling distributions<a class="headerlink" href="#sampling-distributions" title="Link to this heading">#</a></h2>
<p>Let’s look at the same estimators that we described in the previous section,
but this time applied to <em>random</em> samples of size <span class="math notranslate nohighlight">\(n\)</span>:</p>
<ul class="simple">
<li><p>Sample mean: <span class="math notranslate nohighlight">\(\overline{\mathbf{X}} = \Mean(\mathbf{X}) = \tfrac{1}{n}\sum_{i=1}^n X_i\)</span></p></li>
<li><p>Sample variance: <span class="math notranslate nohighlight">\(S_{\mathbf{X}}^2 = \Var(\mathbf{X}) = \tfrac{1}{n-1}\sum_{i=1}^n \left(X_i - \overline{\mathbf{X}} \right)^2\)</span></p></li>
<li><p>Sample standard deviation: <span class="math notranslate nohighlight">\(S_{\mathbf{X}} = \sqrt{\Var(\mathbf{X})} = \sqrt{\tfrac{1}{n-1}\sum_{i=1}^n \left(X_i - \overline{\mathbf{X}} \right)^2}\)</span></p></li>
<li><p>Difference between sample means: <span class="math notranslate nohighlight">\(\hat{D} = \DMeans(\mathbf{X}, \mathbf{Y}) = \overline{\mathbf{X}} - \overline{\mathbf{Y}}\)</span></p></li>
</ul>
<p>Note these formulas is identical to the formulas we saw earlier.
The only difference is that we’re calculating the functions <span class="math notranslate nohighlight">\(g\)</span>, <span class="math notranslate nohighlight">\(h\)</span>, and <span class="math notranslate nohighlight">\(d\)</span> based on a random sample <span class="math notranslate nohighlight">\(\mathbf{X} = (X_1, X_2, \ldots, X_n)\)</span>,
instead of particular sample <span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \ldots, x_n)\)</span>.</p>
<section id="example-4">
<h3>Example 4<a class="headerlink" href="#example-4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_samples</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_samples</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_sampling_dist</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ministats</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_sampling_dist</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s generate <span class="math notranslate nohighlight">\(N=10\)</span> samples <span class="math notranslate nohighlight">\(\mathbf{z}_1, \mathbf{z}_2, \mathbf{z}_3, \ldots, \mathbf{z}_{10}\)</span>, and compute the mean, the variance, and the standard deviation in each sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
<span class="n">rvZ</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">zsamples_df</span> <span class="o">=</span> <span class="n">gen_samples</span><span class="p">(</span><span class="n">rvZ</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)}):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_samples</span><span class="p">(</span><span class="n">zsamples_df</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">],</span> <span class="n">showstd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/09fab670631dbbbe19cd66ab3de3b09f745b4fab46e18576cd62159e667db8d5.png"><img alt="../_images/09fab670631dbbbe19cd66ab3de3b09f745b4fab46e18576cd62159e667db8d5.png" src="../_images/09fab670631dbbbe19cd66ab3de3b09f745b4fab46e18576cd62159e667db8d5.png" style="width: 637px; height: 197px;" />
</a>
</div>
</div>
<p>Now imagine repeating this process for <span class="math notranslate nohighlight">\(N=1000\)</span> samples <span class="math notranslate nohighlight">\(\mathbf{z}_1, \mathbf{z}_2, \mathbf{z}_3, \ldots, \mathbf{z}_{1000}\)</span>.</p>
<p>We can obtain an approximation of the sampling distribution of the mean,
by plotting a histogram of the means we computed from the <span class="math notranslate nohighlight">\(1000\)</span> random samples:</p>
<div class="math notranslate nohighlight">
\[
  [\overline{\mathbf{z}}_1, \overline{\mathbf{z}}_2, \overline{\mathbf{z}}_3, \ldots, \overline{\mathbf{z}}_{1000}],
\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline{\mathbf{z}}_i\)</span> denotes the sample mean computed from the data in the <span class="math notranslate nohighlight">\(i\)</span>th sample: <span class="math notranslate nohighlight">\(\overline{\mathbf{z}}_i = \Mean(\mathbf{z}_i)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">zbars</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvZ</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_sampling_dist</span><span class="p">(</span><span class="n">zbars</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{z}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{Z}</span><span class="s2">}}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/d866e6a42a6c41b6f511520af36f1f6a4963865b35871b528a01d83622c2c0e3.png"><img alt="../_images/d866e6a42a6c41b6f511520af36f1f6a4963865b35871b528a01d83622c2c0e3.png" src="../_images/d866e6a42a6c41b6f511520af36f1f6a4963865b35871b528a01d83622c2c0e3.png" style="width: 845px; height: 293px;" />
</a>
</div>
</div>
<p>We can obtain an approximation of the sampling distribution
of the sample standard deviation,
by plotting a histogram of the standard deviations we computed from the <span class="math notranslate nohighlight">\(1000\)</span> random samples:</p>
<div class="math notranslate nohighlight">
\[
  [s_{\mathbf{z}_1}, s_{\mathbf{z}_2}, s_{\mathbf{z}_3}, \ldots, s_{\mathbf{z}_{1000}}],
\]</div>
<p>where <span class="math notranslate nohighlight">\(s_{\mathbf{z}_i}\)</span> denotes the standard deviation computed from the <span class="math notranslate nohighlight">\(i\)</span>th sample: <span class="math notranslate nohighlight">\(s_{\mathbf{z}_i} = \Mean(\mathbf{z}_i) = \sqrt{ \Var(\mathbf{z}_i) }\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="n">zstds</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvZ</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">std</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_sampling_dist</span><span class="p">(</span><span class="n">zstds</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s_{\mathbf</span><span class="si">{z}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{S_{\mathbf</span><span class="si">{Z}</span><span class="s2">}}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/7d6642e83fccfeb4e441cb72d8048e8843a2234142069b633369614d0eea5b09.png"><img alt="../_images/7d6642e83fccfeb4e441cb72d8048e8843a2234142069b633369614d0eea5b09.png" src="../_images/7d6642e83fccfeb4e441cb72d8048e8843a2234142069b633369614d0eea5b09.png" style="width: 847px; height: 296px;" />
</a>
</div>
</div>
<section id="illustration">
<h4>Illustration<a class="headerlink" href="#illustration" title="Link to this heading">#</a></h4>
<p>The <em>sampling distribution</em> of the estimator <span class="math notranslate nohighlight">\(g\)</span> is defined as the
random variable <span class="math notranslate nohighlight">\(\hat{\Theta} = g(\mathbf{X})\)</span>, which is the output of
the estimator <span class="math notranslate nohighlight">\(g\)</span> when the input is a random sample
<span class="math notranslate nohighlight">\(\mathbf{X} = (X_1, X_2, \ldots, X_n)\)</span>.</p>
<p><img alt="sampling distribution" src="../_images/Esimators_contexB1.png" /></p>
</section>
</section>
<section id="estimator-properties">
<h3>Estimator properties<a class="headerlink" href="#estimator-properties" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <em>bias</em> of the estimator <span class="math notranslate nohighlight">\(g\)</span> is defined as:
<span class="math notranslate nohighlight">\(\mathbf{bias}(g) = \mathbb{E}_{\mathbf{X}}[\hat{\Theta}] - \theta\)</span>.
The bias measures how much the estimates differ from the true
population parameter, on average.</p></li>
<li><p>The <em>variance</em> of an estimator is  
<span class="math notranslate nohighlight">\(\mathbf{var}\big(\hat{\Theta}\big) = \mathbb{E}_{\mathbf{X}}\big[(\hat{\Theta} - \mathbb{E}[\hat{\Theta}])^2\big]\)</span>,
and it measures the variability of the estimates around the average.</p></li>
<li><p>The <em>standard error</em> of the estimator <span class="math notranslate nohighlight">\(g\)</span> is the square root of its
variance and denoted
<span class="math notranslate nohighlight">\(\stderr{\hat{\theta}} = \sqrt{ \mathbf{var}(\hat{\Theta}) }\)</span>.</p></li>
</ul>
<section id="id1">
<h4>Illustration<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p><img alt="bias and variance" src="../_images/bias_and_variance_targets1.png" /></p>
<ul class="simple">
<li><p>a) all the arrow hits are on target (low bias) and close
together (low variance). This is the best-case scenario.</p></li>
<li><p>b) the arrow hits are still close to each other, which means the estimator
has low variance, but the hits are consistently “off” the centre (below
and to the right), which illustrates a biased estimator.</p></li>
<li><p>c) is an illustration of a high-variance estimator with no bias. The arrow hits
are spread out, but mostly centred on the target.</p></li>
<li><p>d) shows the worst case scenario: and estimator that has high bias
(consistently off) and high variance (spread out).</p></li>
</ul>
</section>
</section>
<section id="computational-approach-to-sampling-distributions">
<h3>Computational approach to sampling distributions<a class="headerlink" href="#computational-approach-to-sampling-distributions" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gen_sampling_dist</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">estfunc</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">estimates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">estimate</span> <span class="o">=</span> <span class="n">estfunc</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">estimates</span>

<span class="c1"># ALT.</span>
<span class="c1"># from ministats import gen_sampling_dist</span>
</pre></div>
</div>
</div>
</div>
<section id="example-5-sampling-distributions-of-the-kombucha-volume">
<h4>Example 5: sampling distributions of the kombucha volume<a class="headerlink" href="#example-5-sampling-distributions-of-the-kombucha-volume" title="Link to this heading">#</a></h4>
<p>The probability distribution of the kombucha volume is know to
be <span class="math notranslate nohighlight">\(K \sim \mathcal{N}(\mu_K=1000, \sigma_K=10)\)</span>. This is an usual case where we know the population parameters,
but we’ll investigate because it allows us to learn more about sampling distributions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
<span class="n">muK</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sigmaK</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">rvK</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">muK</span><span class="p">,</span> <span class="n">sigmaK</span><span class="p">)</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">960</span><span class="p">,</span><span class="mi">1040</span><span class="p">],</span> <span class="n">rv_name</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/4e799e84abc420a7ac6d63251eba8de055eb81782063f3ad7f607cfb739a98e2.png"><img alt="../_images/4e799e84abc420a7ac6d63251eba8de055eb81782063f3ad7f607cfb739a98e2.png" src="../_images/4e799e84abc420a7ac6d63251eba8de055eb81782063f3ad7f607cfb739a98e2.png" style="width: 861px; height: 293px;" />
</a>
</div>
</div>
<section id="sampling-distribution-of-the-mean">
<h5>Sampling distribution of the mean<a class="headerlink" href="#sampling-distribution-of-the-mean" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">kbars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">990</span><span class="p">,</span><span class="mi">1010</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/2cd65716874328ca62524f39ddcd30b0ac8cbea9ac1e548343aabca4b4a8a472.png"><img alt="../_images/2cd65716874328ca62524f39ddcd30b0ac8cbea9ac1e548343aabca4b4a8a472.png" src="../_images/2cd65716874328ca62524f39ddcd30b0ac8cbea9ac1e548343aabca4b4a8a472.png" style="width: 882px; height: 294px;" />
</a>
</div>
</div>
<p>We can verify the mean estimator is unbiased,
since the mean of the sampling distribution is very close to the population mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observed,         population mean</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kbars20</span><span class="p">),</span>   <span class="n">muK</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(999.9759718368696, 1000)
</pre></div>
</div>
</div>
</div>
<p>Let’s calculate the standard error of the estimator</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observed standard deviation</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.2080598530804387
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CLT prediction</span>
<span class="n">sigmaK</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.23606797749979
</pre></div>
</div>
</div>
</div>
</section>
<section id="sampling-distribution-of-the-variance">
<h5>Sampling distribution of the variance<a class="headerlink" href="#sampling-distribution-of-the-variance" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{S_{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s^2_{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/f36bd719fc41cf167d282c27ea2fdcce04e0902bafb74df3668589dec70d0124.png"><img alt="../_images/f36bd719fc41cf167d282c27ea2fdcce04e0902bafb74df3668589dec70d0124.png" src="../_images/f36bd719fc41cf167d282c27ea2fdcce04e0902bafb74df3668589dec70d0124.png" style="width: 862px; height: 297px;" />
</a>
</div>
</div>
<p>The sample variance estimator is unbiased</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observed          # population var    </span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kvars20</span><span class="p">),</span>   <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(99.39922540353122, 100)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="approximating-sampling-distribution">
<h2>Approximating sampling distribution<a class="headerlink" href="#approximating-sampling-distribution" title="Link to this heading">#</a></h2>
<p>Let’s look at a particular sample <code class="docutils literal notranslate"><span class="pre">ksample02</span></code> that comes from Batch 02 of the kombucha bottling plant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch02</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ksample02</span> <span class="o">=</span> <span class="n">batch02</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="c1"># ksample02</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ksample02</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ksample02</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 995.83,  999.44,  978.64, 1016.4 ,  982.07,  991.58, 1005.03,
        987.55,  989.42,  990.91, 1005.51, 1022.92, 1000.42,  988.82,
       1005.39,  994.04,  999.81, 1011.75,  992.52, 1000.09])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">960</span><span class="p">,</span><span class="mi">1040</span><span class="p">],</span> <span class="n">rv_name</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">ksample02</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">35</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/78dfc83f8e41ffae5c8fe189643a2cad89a3b9d8f9d9f7d689db8f2e2dda3abf.png"><img alt="../_images/78dfc83f8e41ffae5c8fe189643a2cad89a3b9d8f9d9f7d689db8f2e2dda3abf.png" src="../_images/78dfc83f8e41ffae5c8fe189643a2cad89a3b9d8f9d9f7d689db8f2e2dda3abf.png" style="width: 853px; height: 293px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">ksample02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>997.9069999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">(</span><span class="n">ksample02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.149780314097285
</pre></div>
</div>
</div>
</div>
<section id="bootstrap-estimation">
<h3>Bootstrap estimation<a class="headerlink" href="#bootstrap-estimation" title="Link to this heading">#</a></h3>
<section id="minimal-example">
<h4>Minimal example<a class="headerlink" href="#minimal-example" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># one sample of observations</span>
<span class="n">xsample</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># one bootstrap observation</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">bx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">xsample</span><span class="p">)</span>
<span class="n">bx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bootstrap sample</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># comment this line to generate new bootstrap samples</span>
<span class="n">bsample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">xsample</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xsample</span><span class="p">))</span>
<span class="n">bsample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 4, 1, 3])
</pre></div>
</div>
</div>
</div>
</section>
<section id="interactive-bootstrap-samples-example">
<h4>Interactive bootstrap samples example<a class="headerlink" href="#interactive-bootstrap-samples-example" title="Link to this heading">#</a></h4>
<p>Re-run the following code cell many times to see different bootstrap samples from <code class="docutils literal notranslate"><span class="pre">ksample02</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate new bootstrap sample</span>
<span class="n">bksample02</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ksample02</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ksample02</span><span class="p">))</span>

<span class="c1"># plot a histogram of bksample02</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)}):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">bksample02</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">purple</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">970</span><span class="p">,</span><span class="mi">1030</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\mathbf</span><span class="si">{k}</span><span class="s2">^*}$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/3c9d750bd51edeb8d6c85d3ec45749003a04f2ec820c79c5b3de1e8bce27f76f.png"><img alt="../_images/3c9d750bd51edeb8d6c85d3ec45749003a04f2ec820c79c5b3de1e8bce27f76f.png" src="../_images/3c9d750bd51edeb8d6c85d3ec45749003a04f2ec820c79c5b3de1e8bce27f76f.png" style="width: 404px; height: 197px;" />
</a>
</div>
</div>
</section>
<section id="general-purpose-bootstrap-estimation-function">
<h4>General-purpose bootstrap estimation function<a class="headerlink" href="#general-purpose-bootstrap-estimation-function" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gen_boot_dist</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">estfunc</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate estimates from the sampling distribiton of the estimator `estfunc`</span>
<span class="sd">    based on `B` bootstrap samples (sampling with replacement) from `sample`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">bestimates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
        <span class="n">bsample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">bestimate</span> <span class="o">=</span> <span class="n">estfunc</span><span class="p">(</span><span class="n">bsample</span><span class="p">)</span>
        <span class="n">bestimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bestimate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bestimates</span>

<span class="c1"># ALT.</span>
<span class="c1"># from ministats import gen_boot_dist</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-6">
<h4>Example 6<a class="headerlink" href="#example-6" title="Link to this heading">#</a></h4>
<p>Let’s use the function <code class="docutils literal notranslate"><span class="pre">gen_boot_dist</span></code> to obtain the sampling distribution of the mean from the sample <code class="docutils literal notranslate"><span class="pre">ksample02</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">kbars_boot</span> <span class="o">=</span> <span class="n">gen_boot_dist</span><span class="p">(</span><span class="n">ksample02</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars_boot</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}^*}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}^*$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/cad0f40637458c79ff83f018ab6c14be8926282d44c6494897cfbba6d2144024.png"><img alt="../_images/cad0f40637458c79ff83f018ab6c14be8926282d44c6494897cfbba6d2144024.png" src="../_images/cad0f40637458c79ff83f018ab6c14be8926282d44c6494897cfbba6d2144024.png" style="width: 860px; height: 294px;" />
</a>
</div>
</div>
<p>We can obtain an bootstrap estimate of standard error of the mean by computing the
standard deviation of the bootstrap distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bootstrap est.    # simulation</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars_boot</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.415083743362255, 2.2080598530804387)
</pre></div>
</div>
</div>
</div>
<p>The expected value of the bootstrap distribution matches the sample mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># E[bootstrap means]  # sample mean    # population </span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kbars_boot</span><span class="p">),</span>  <span class="n">mean</span><span class="p">(</span><span class="n">ksample02</span><span class="p">),</span> <span class="n">muK</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(997.9296855999999, 997.9069999999999, 1000)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analytical-approximation-formulas">
<h3>Analytical approximation formulas<a class="headerlink" href="#analytical-approximation-formulas" title="Link to this heading">#</a></h3>
<p>We can use probability theory formulas to come up with approximations
for certain sampling distributions.</p>
<p>Indeed many of the probability distributions we learned about in the probability chapter are used to describe sampling distributions of various estimators:</p>
<ul class="simple">
<li><p>The normal distribution</p></li>
<li><p>Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution: sample mean from a normally distributed population with unknown variance</p></li>
<li><p>Chi-square distribution: variance of samples from a normal population</p></li>
<li><p>Fisher–Snedecor <span class="math notranslate nohighlight">\(F\)</span>-distribution: ratios of variances (only discussed later in the book)</p></li>
</ul>
<p>The best example of the analytical approximation formula is the central limit theorem.</p>
<section id="central-limit-theorem">
<h4>Central limit theorem<a class="headerlink" href="#central-limit-theorem" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># standard error of the mean</span>
<span class="n">seKbar</span> <span class="o">=</span> <span class="n">sigmaK</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># CLT prediction   # simulation</span>
<span class="n">seKbar</span><span class="p">,</span>            <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.23606797749979, 2.2080598530804387)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CLT approx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
<span class="n">rvKbarCLT</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">muK</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">seKbar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># kbars20 (repeat)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">kbars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># plot hist and pdf superimposed</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvKbarCLT</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">990</span><span class="p">,</span><span class="mi">1010</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/9f55361191e6fe0d187ce2f55486f5687516fbbb38df43d76a9304aef05e6f85.png"><img alt="../_images/9f55361191e6fe0d187ce2f55486f5687516fbbb38df43d76a9304aef05e6f85.png" src="../_images/9f55361191e6fe0d187ce2f55486f5687516fbbb38df43d76a9304aef05e6f85.png" style="width: 860px; height: 294px;" />
</a>
</div>
</div>
</section>
</section>
</section>
<section id="id2">
<h2>Sampling distribution of the mean<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>The central limit theorem tells us everything we need to know about the sampling distribution of the sample mean estimator <span class="math notranslate nohighlight">\(\Mean\)</span>,
which corresponds to the random variable <span class="math notranslate nohighlight">\(\overline{\mathbf{X}} = \Mean(\mathbf{X})\)</span>.</p>
<p>The central limit theorem states that the sampling distribution of the mean
converges to a normal distribution as <span class="math notranslate nohighlight">\(n\)</span> goes to infinity:</p>
<div class="math notranslate nohighlight">
\[
    \overline{\mathbf{X}}
    \quad \sim \quad
    \mathcal{N}\big(\mu_X, \tfrac{\sigma_X}{\sqrt{n}} \big).
\]</div>
<p>Note the central limit theorem gives a sampling distribution of the sample mean
computed from samples taken from <strong>any</strong> population <span class="math notranslate nohighlight">\(X \sim \mathcal{M}(\theta)\)</span>.</p>
<section id="true-sampling-distribution">
<h3>True sampling distribution<a class="headerlink" href="#true-sampling-distribution" title="Link to this heading">#</a></h3>
<p>We start by running a simulation to obtain the true sampling distribution of the sample mean
for samples of size <span class="math notranslate nohighlight">\(n=7\)</span> from the population <span class="math notranslate nohighlight">\(K \sim \mathcal{N}(\mu_K=1000,\sigma_K=10)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="n">kbars7</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars7</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/dfad08d526988f8039f85eb0913a91a753e73bc8661cc3c044768c6808cb1130.png"><img alt="../_images/dfad08d526988f8039f85eb0913a91a753e73bc8661cc3c044768c6808cb1130.png" src="../_images/dfad08d526988f8039f85eb0913a91a753e73bc8661cc3c044768c6808cb1130.png" style="width: 853px; height: 299px;" />
</a>
</div>
</div>
<p>This is the true sampling distribution of the sample mean generated using simulation
from <span class="math notranslate nohighlight">\(N=10000\)</span> samples of size <span class="math notranslate nohighlight">\(n=7\)</span>. We can use this graph as the “ground truth” for the approximations techniques we’ll learn next.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.8051688517483897
</pre></div>
</div>
</div>
</div>
</section>
<section id="prediction-of-the-central-limit-theorem">
<h3>Prediction of the central limit theorem<a class="headerlink" href="#prediction-of-the-central-limit-theorem" title="Link to this heading">#</a></h3>
<p>Compute the standard error using according to the central limit theorem
<span class="math notranslate nohighlight">\(\stderr{\overline{\mathbf{k}}} = \frac{\sigma_K}{\sqrt{n}}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seKbar</span> <span class="o">=</span> <span class="n">rvK</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">seKbar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.779644730092272
</pre></div>
</div>
</div>
</div>
<p>Sampling distribution of the mean according to CLT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvKbarCLT</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">muK</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">seKbar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now superimpose a lineplot of the analytical approximation formula
we obtain from the central limit theorem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot hist and pdf superimposed</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars7</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvKbarCLT</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">985</span><span class="p">,</span><span class="mi">1015</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/ec66f50a1aab9b530ccb6d8e0ae070ce05c90fd6d75f3f4da8f0babbe0cdc95a.png"><img alt="../_images/ec66f50a1aab9b530ccb6d8e0ae070ce05c90fd6d75f3f4da8f0babbe0cdc95a.png" src="../_images/ec66f50a1aab9b530ccb6d8e0ae070ce05c90fd6d75f3f4da8f0babbe0cdc95a.png" style="width: 853px; height: 299px;" />
</a>
</div>
</div>
</section>
<section id="the-plug-in-principle">
<h3>The plug-in principle<a class="headerlink" href="#the-plug-in-principle" title="Link to this heading">#</a></h3>
<p>Next we consider real-world statistical analysis scenario
when we don’t know the population variance,
but instead have to estimate it from a particular sample of observations.
Specifically,
we’ll load the sample form Batch 03.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch03</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
<span class="n">ksample03</span> <span class="o">=</span> <span class="n">batch03</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="n">ksample03</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1005.19,  987.31, 1002.4 ,  991.96, 1000.17, 1003.94, 1012.79])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ksample03</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
<p>The estimated standard deviation <span class="math notranslate nohighlight">\(s_{\mathbf{k}}\)</span> computed from <code class="docutils literal notranslate"><span class="pre">ksample03</span></code> is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="p">(</span><span class="n">ksample03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.519494731273129
</pre></div>
</div>
</div>
</div>
<p>This estimate is pretty close to the true population standard deviation
<code class="docutils literal notranslate"><span class="pre">sigmaK</span></code> <span class="math notranslate nohighlight">\(= \sigma_K = 10\)</span>.</p>
<p>Let’s now compute the estimated standard error using the plug-in formula:
<span class="math notranslate nohighlight">\(\stderrhat{\overline{\mathbf{k}}} = \frac{s_{\mathbf{k}}}{\sqrt{n}}\)</span>,
where <span class="math notranslate nohighlight">\(s_{\mathbf{k}}\)</span> is the estimated standard deviation computed from <code class="docutils literal notranslate"><span class="pre">ksample03</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sehat03</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">ksample03</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sehat03</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.220066336410536
</pre></div>
</div>
</div>
</div>
<p>This is pretty close to the standard error
we would obtain if we knew the population standard deviation:
<span class="math notranslate nohighlight">\(\stderr{\overline{\mathbf{k}}} = \frac{\sigma_K}{\sqrt{n}} = \)</span> <code class="docutils literal notranslate"><span class="pre">sigmaK/np.sqrt(7)</span></code> = 3.78.</p>
</section>
<section id="normal-approximation-to-the-sampling-distribution">
<h3>Normal approximation to the sampling distribution<a class="headerlink" href="#normal-approximation-to-the-sampling-distribution" title="Link to this heading">#</a></h3>
<p>We now obtain the best normal approximation based on the estimated standard error <code class="docutils literal notranslate"><span class="pre">sehat03</span></code>
that we computed from the data in <code class="docutils literal notranslate"><span class="pre">ksample03</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvNKbar</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">muK</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sehat03</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars7</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvNKbar</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">985</span><span class="p">,</span><span class="mi">1015</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;normal approx.&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/784fc1ea97c9b6a6ff5284e9185f93fdc87ad7c7ed67da932bf8ca3bab6b8467.png"><img alt="../_images/784fc1ea97c9b6a6ff5284e9185f93fdc87ad7c7ed67da932bf8ca3bab6b8467.png" src="../_images/784fc1ea97c9b6a6ff5284e9185f93fdc87ad7c7ed67da932bf8ca3bab6b8467.png" style="width: 853px; height: 294px;" />
</a>
</div>
</div>
</section>
<section id="a-better-approximation">
<h3>A better approximation<a class="headerlink" href="#a-better-approximation" title="Link to this heading">#</a></h3>
<p>Student’s t-distribution (used whenever working with normally needed in context where using <span class="math notranslate nohighlight">\(s\)</span> as plug-in estimate for σ).</p>
<p>Obtain Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution based on the estimated standard error <code class="docutils literal notranslate"><span class="pre">sehat03</span></code>
that we computed from the data in <code class="docutils literal notranslate"><span class="pre">ksample03</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span> <span class="k">as</span> <span class="n">tdist</span>

<span class="n">df03</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># degrees of freedom</span>
<span class="n">rvTKbar</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df03</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">muK</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sehat03</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars7</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvTKbar</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">985</span><span class="p">,</span><span class="mi">1015</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Student&#39;s t approx.&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/be34c27ab6a5f71a757223490ff61e916a28520dd6c9a8fd5f48fc79feb38b43.png"><img alt="../_images/be34c27ab6a5f71a757223490ff61e916a28520dd6c9a8fd5f48fc79feb38b43.png" src="../_images/be34c27ab6a5f71a757223490ff61e916a28520dd6c9a8fd5f48fc79feb38b43.png" style="width: 853px; height: 294px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Student&#39;s t       # simulation</span>
<span class="n">rvTKbar</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>      <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3.943759731059507, 3.8051688517483897)
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrapped-sampling-distribution-of-the-sample-mean">
<h3>Bootstrapped sampling distribution of the sample mean<a class="headerlink" href="#bootstrapped-sampling-distribution-of-the-sample-mean" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ground truth (in orange)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars7</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">)</span>

<span class="c1"># bootstrap estimate (in blue)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
<span class="n">kbars_boot03</span> <span class="o">=</span> <span class="n">gen_boot_dist</span><span class="p">(</span><span class="n">ksample03</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kbars_boot03</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bootstrap estimates&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/bbc9077081ecc5fe2274273b1de4fae5b073ce36139c75143cc4a889132af02c.png"><img alt="../_images/bbc9077081ecc5fe2274273b1de4fae5b073ce36139c75143cc4a889132af02c.png" src="../_images/bbc9077081ecc5fe2274273b1de4fae5b073ce36139c75143cc4a889132af02c.png" style="width: 853px; height: 294px;" />
</a>
</div>
</div>
<p>The expected value of the sampling distribution
we obtained using bootstrap estimation is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># E[bootstrap dist.]   # sample mean     # population mean</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kbars_boot03</span><span class="p">),</span> <span class="n">mean</span><span class="p">(</span><span class="n">ksample03</span><span class="p">),</span>  <span class="n">muK</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000.5607797142856, 1000.5371428571427, 1000)
</pre></div>
</div>
</div>
</div>
<p>The standard error of the sampling distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bootstrap est.      # simulation</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars_boot03</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kbars7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.9673068567038365, 3.8051688517483897)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample std        # population std</span>
<span class="n">std</span><span class="p">(</span><span class="n">ksample03</span><span class="p">),</span>     <span class="n">sigmaK</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8.519494731273129, 10)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id3">
<h2>Sampling distribution of the variance<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>When the population is normally distributed <span class="math notranslate nohighlight">\(X \sim \mathcal{N}(\mu,\sigma)\)</span>,
the sampling distribution of the sample variance <span class="math notranslate nohighlight">\(S_{\mathbf{x}}^2\)</span>
is described by a scaled version of the chi-square distribution:</p>
<div class="math notranslate nohighlight">
\[
    S_{\mathbf{x}}^2
    \;\; \sim \;\;
    \underbrace{\frac{ \sigma^2 }{ (n-1) } }_{\tt{scale}} \; \cdot \; \chi^2_{(n-1)},
\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the sample size and <span class="math notranslate nohighlight">\(\chi^2_{(n-1)}\)</span> is the chi-square distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom.</p>
<section id="id4">
<h3>Sampling distribution of the variance<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Let’s start by plotting a histogram of the sampling distribution of the variance
computed from samples of size <span class="math notranslate nohighlight">\(n=20\)</span> from the random variable <code class="docutils literal notranslate"><span class="pre">rvK</span></code> = <span class="math notranslate nohighlight">\(K \sim \mathcal{N}(\mu_K=1000,\sigma_K=10)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{S^2_{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s^2_{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/95e7d15cc06c782be43408258b671fc57b7d2b91772058c514eedc6ace6d3dbd.png"><img alt="../_images/95e7d15cc06c782be43408258b671fc57b7d2b91772058c514eedc6ace6d3dbd.png" src="../_images/95e7d15cc06c782be43408258b671fc57b7d2b91772058c514eedc6ace6d3dbd.png" style="width: 863px; height: 297px;" />
</a>
</div>
</div>
<p>Let’s now superimpose the chi-square distribution with <span class="math notranslate nohighlight">\(20-1=19\)</span> degrees of freedom,
with scale parameter set to <span class="math notranslate nohighlight">\(\sigma_N^2/(n-1)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2</span>

<span class="n">scale</span> <span class="o">=</span> <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">20</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rvS2</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">20</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvS2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{S^2_{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s^2_{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/c00b76a550fd2eeb11caafcfc5894bf674a9cd783ec83e412540a75be86875ea.png"><img alt="../_images/c00b76a550fd2eeb11caafcfc5894bf674a9cd783ec83e412540a75be86875ea.png" src="../_images/c00b76a550fd2eeb11caafcfc5894bf674a9cd783ec83e412540a75be86875ea.png" style="width: 863px; height: 297px;" />
</a>
</div>
</div>
</section>
<section id="bootstrapped-sampling-distribution-of-the-sample-variance">
<h3>Bootstrapped sampling distribution of the sample variance<a class="headerlink" href="#bootstrapped-sampling-distribution-of-the-sample-variance" title="Link to this heading">#</a></h3>
<p>Let’s look again at the sample <code class="docutils literal notranslate"><span class="pre">ksample02</span></code> that comes from Batch 02 of the kombucha bottling plant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">batch02</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ksample02</span> <span class="o">=</span> <span class="n">batch02</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="n">ksample02</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<p>The sample variance we find from <code class="docutils literal notranslate"><span class="pre">ksample02</span></code> is an over-estimate
of the population variance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample var         # population var</span>
<span class="n">var</span><span class="p">(</span><span class="n">ksample02</span><span class="p">),</span>      <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(124.31760105263136, 100)
</pre></div>
</div>
</div>
</div>
<p>So we should expect the bootstrap estimate we obtain
by resampling from <code class="docutils literal notranslate"><span class="pre">ksample02</span></code> will also be an overestimate of the population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ground truth (in orange)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars20</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;simulation&quot;</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span>
<span class="n">kvars_boot02</span> <span class="o">=</span> <span class="n">gen_boot_dist</span><span class="p">(</span><span class="n">ksample02</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>

<span class="c1"># bootstrap estimate (in blue)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">kvars_boot02</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bootstrap estimate&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{S^2_{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$s^2_{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/23d3090f692f80f761589642b50e3a3084faf9174d3eba63575f0c0cae7d1ca6.png"><img alt="../_images/23d3090f692f80f761589642b50e3a3084faf9174d3eba63575f0c0cae7d1ca6.png" src="../_images/23d3090f692f80f761589642b50e3a3084faf9174d3eba63575f0c0cae7d1ca6.png" style="width: 863px; height: 297px;" />
</a>
</div>
</div>
<p>The expected value the sampling distribution we obtained using bootstrap estimation is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># E[bootstrap vars]     # population variance</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kvars_boot02</span><span class="p">),</span>  <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(118.6780201503156, 100)
</pre></div>
</div>
</div>
</div>
<p>The expected value bootstrap variances overestimates the true population variance.</p>
<p>We can also compute standard error of the sampling distribution of the variance, denoted <span class="math notranslate nohighlight">\(\stderrhat{s_{\mathbf{k}}^2}^*\)</span>,
and compare it to the true standard error <span class="math notranslate nohighlight">\(\stderr{s_{\mathbf{k}}^2}\)</span> computed through simulation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># bootstrap est.        # simulated</span>
<span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kvars_boot02</span><span class="p">),</span>   <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">kvars20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(35.96396081594617, 32.27334227853393)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="difference-between-means-estimator">
<h2>Difference between means estimator<a class="headerlink" href="#difference-between-means-estimator" title="Link to this heading">#</a></h2>
<p>We assume the two groups are normally distributed random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[ 
X \sim \mathcal{N}\!\left(\mu_X, \sigma_X \right)
\qquad
\textrm{and}
\qquad
Y \sim \mathcal{N}\!\left(\mu_Y, \sigma_Y \right).
\]</div>
<p>Definitions:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \ldots, x_{n})\)</span>=<code class="docutils literal notranslate"><span class="pre">xsample</span></code>: a sample of size <span class="math notranslate nohighlight">\(n\)</span> from <span class="math notranslate nohighlight">\(X\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{y} = (y_1, y_2, \ldots, y_{m})\)</span>=<code class="docutils literal notranslate"><span class="pre">ysample</span></code>: a sample of size <span class="math notranslate nohighlight">\(m\)</span> from <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\overline{\mathbf{x}} = \Mean(\mathbf{x})\)</span>: the observed mean in the first group</p></li>
<li><p><span class="math notranslate nohighlight">\(\overline{\mathbf{y}} = \Mean(\mathbf{y})\)</span>: the observed mean in the second group</p></li>
<li><p><span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2 = \Var(\mathbf{x})\)</span>: the sample variance from the first group</p></li>
<li><p><span class="math notranslate nohighlight">\(s_{\mathbf{y}}^2 = \Var(\mathbf{y})\)</span>: the sample variance from the second group</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{d} = \DMeans(\mathbf{x}, \mathbf{y}) = \overline{\mathbf{x}} - \overline{\mathbf{y}}\)</span>:
the difference between means estimate,
which is an estimate of the true different between
population means <span class="math notranslate nohighlight">\(\Delta = \mu_X - \mu_Y\)</span>.</p></li>
</ul>
<p>The sampling distribution of the estimator <code class="docutils literal notranslate"><span class="pre">dmeans</span></code> is defined as:</p>
<div class="math notranslate nohighlight">
\[
  \hat{D}
   = \texttt{dmeans}(\mathbf{X}, \mathbf{Y})
   = \overline{\mathbf{X}} - \overline{\mathbf{Y}},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{X} = (X_1, X_2, \ldots, X_{n})\)</span>
and <span class="math notranslate nohighlight">\(\mathbf{Y} = (Y_1, Y_2, \ldots, Y_{m})\)</span>
are random samples.</p>
<!--
If we know the population distributions for the two groups $X$ and $Y$,
we can obtain the sampling distribution
by repeatedly generating samples `xsample` and `ysample` from the two distributions,
and computing `dmeans` on the random samples. --><section id="analytical-formula-for-the-sampling-distribution">
<h3>Analytical formula for the sampling distribution<a class="headerlink" href="#analytical-formula-for-the-sampling-distribution" title="Link to this heading">#</a></h3>
<p>Let’s now use probability theory to build a theoretical model for the sampling distribution of the difference-between-means estimator <code class="docutils literal notranslate"><span class="pre">dmeans</span></code>.</p>
<ul>
<li><p>The central limit theorem tells us the sample mean within the two group are</p>
<div class="math notranslate nohighlight">
\[
  \overline{\mathbf{X}} \sim \mathcal{N}\!\left(\mu_X, \tfrac{\sigma_X}{\sqrt{n}} \right)
  \qquad \textrm{and} \qquad
  \overline{\mathbf{Y}} \sim \mathcal{N}\!\left(\mu_Y, \tfrac{\sigma_Y}{\sqrt{m}} \right).
  \]</div>
</li>
<li><p>The rules of probability theory tells us that the <a class="reference external" href="https://en.wikipedia.org/wiki/Sum_of_normally_distributed_random_variables#Independent_random_variables">difference of two normal random variables</a> requires subtracting their means and adding their variance, so we get:
$<span class="math notranslate nohighlight">\(
\hat{D}
  \sim
  \mathcal{N}\!\left(
      \mu_X - \mu_Y, \;
      \stderr{\hat{D}}
  \right),
\)</span>$</p>
<p>where the standard error of the estimator <span class="math notranslate nohighlight">\(\hat{D}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[ 
    \stderr{\hat{D}} = \sqrt{ \tfrac{\sigma^2_X}{n} + \tfrac{\sigma^2_Y}{m}  }.
  \]</div>
</li>
</ul>
<section id="approximation-using-student-s-t-distribution">
<h4>Approximation using Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution<a class="headerlink" href="#approximation-using-student-s-t-distribution" title="Link to this heading">#</a></h4>
<p>Recall the plug-in principle allows us to obtain approximate statistical
formulas by replacing population parameters with estimates computed from
samples. Applying the plug-in principle to the formula
<span class="math notranslate nohighlight">\(\stderr{\hat{d}}\)</span>, we obtain a formula for the estimated standard error
of the difference between means estimator:
$<span class="math notranslate nohighlight">\(
\stderrhat{\hat{d}} = \sqrt{ \frac{s_{\mathbf{x}}^2}{n} + \frac{s_{\mathbf{y}}^2}{m} }
                = \sqrt{  \stderrhat{\overline{\mathbf{x}}}^2 + \stderrhat{\overline{\mathbf{y}}}^2 }\;.
\)</span>$</p>
<p>We can now build a model for the sampling distribution of the difference
between means estimator based on Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution:</p>
<div class="math notranslate nohighlight">
\[
T_{\widehat{D}}
 \;\; \sim \;\;
 \mathcal{T}(\nu_d, \; \tt{loc}\!=\!\Delta, \; \tt{scale}\!=\!\stderrhat{\hat{d}})
 \; = \;
 \stderrhat{\hat{d}} \cdot \mathcal{T}(\nu_d) \; + \; \Delta,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{T}(\nu_d)\)</span> is Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution with
<span class="math notranslate nohighlight">\(\nu_d\)</span> degrees of freedom.</p>
<p>The degrees of freedom of is obtained by the following formula
$<span class="math notranslate nohighlight">\(
  \nu_d
    \;\; = \;\;
    \frac{ (\stderrhat{\overline{\mathbf{x}}}^2 + \stderrhat{\overline{\mathbf{y}}}^2)^2 }
        { \frac{\stderrhat{\overline{\mathbf{x}}}^4}{n-1}
        +   \frac{\stderrhat{\overline{\mathbf{y}}}^4}{m-1}	}\;.
  \)</span>$</p>
<p>Let’s write a Python function that calculates the degrees of freedom parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calcdf</span><span class="p">(</span><span class="n">stdX</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">stdY</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">vX</span> <span class="o">=</span> <span class="n">stdX</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">vY</span> <span class="o">=</span> <span class="n">stdY</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">m</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">vX</span> <span class="o">+</span> <span class="n">vY</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">vX</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vY</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># ALT.</span>
<span class="c1"># from ministats import calcdf</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="example-7-difference-between-electricity-prices">
<h3>Example 7: difference between electricity prices<a class="headerlink" href="#example-7-difference-between-electricity-prices" title="Link to this heading">#</a></h3>
<p>Let’s return to Bob’s dataset of electricity prices collected from
charging stations in the East and West parts of his city. We’ll assume
the prices in the two parts of the city are normally distributed and
described by the models <span class="math notranslate nohighlight">\(X_W \sim \mathcal{N}(\mu_W, \sigma_W)\)</span> and
<span class="math notranslate nohighlight">\(X_E \sim \mathcal{N}(\mu_E, \sigma_E)\)</span>.</p>
<p>We have two samples <span class="math notranslate nohighlight">\(\tt{pricesW} = \mathbf{x}_W\)</span> and
<span class="math notranslate nohighlight">\(\tt{pricesE} = \mathbf{x}_E\)</span> from these prices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eprices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/eprices.csv&quot;</span><span class="p">)</span>
<span class="n">pricesW</span> <span class="o">=</span> <span class="n">eprices</span><span class="p">[</span><span class="n">eprices</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;West&quot;</span><span class="p">][</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
<span class="n">pricesE</span> <span class="o">=</span> <span class="n">eprices</span><span class="p">[</span><span class="n">eprices</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;East&quot;</span><span class="p">][</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">(</span><span class="n">pricesW</span><span class="p">),</span> <span class="n">mean</span><span class="p">(</span><span class="n">pricesE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9.155555555555555, 6.155555555555555)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dhat</span> <span class="o">=</span> <span class="n">dmeans</span><span class="p">(</span><span class="n">pricesW</span><span class="p">,</span> <span class="n">pricesE</span><span class="p">)</span>
<span class="n">dhat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># std and sample size in the East</span>
<span class="n">stdW</span><span class="p">,</span> <span class="n">nW</span> <span class="o">=</span> <span class="n">pricesW</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">pricesW</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># std and sample size in the West</span>
<span class="n">stdE</span><span class="p">,</span> <span class="n">nE</span> <span class="o">=</span> <span class="n">pricesE</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">pricesE</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">stdW</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">stdE</span><span class="p">,</span> <span class="n">nE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.5621388471508475, 9, 0.8776547030454391, 9)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stdW</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">nW</span> <span class="o">+</span> <span class="n">stdE</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">nE</span><span class="p">)</span>
<span class="n">seD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5972674401486562
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfD</span> <span class="o">=</span> <span class="n">calcdf</span><span class="p">(</span><span class="n">stdW</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">stdE</span><span class="p">,</span> <span class="n">nE</span><span class="p">)</span>
<span class="n">dfD</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.59281702723103
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span> <span class="k">as</span> <span class="n">tdist</span>
<span class="n">rvTDhat</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">dfD</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">dhat</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">seD</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvTDhat</span><span class="p">,</span> <span class="n">rv_name</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{T_{\widehat</span><span class="si">{D}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="kc">None</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/0001b11f68162a9de2883a6202aaebbf8a7bdf6c458e1ecd4895a93015f57172.png"><img alt="../_images/0001b11f68162a9de2883a6202aaebbf8a7bdf6c458e1ecd4895a93015f57172.png" src="../_images/0001b11f68162a9de2883a6202aaebbf8a7bdf6c458e1ecd4895a93015f57172.png" style="width: 847px; height: 274px;" />
</a>
</div>
</div>
<section id="bootstrapped-sampling-distribution-of-the-difference-between-means">
<h4>Bootstrapped sampling distribution of the difference between means<a class="headerlink" href="#bootstrapped-sampling-distribution-of-the-difference-between-means" title="Link to this heading">#</a></h4>
<p>First compute bootstrap estimates for mean in each group</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbarsW_boot</span> <span class="o">=</span> <span class="n">gen_boot_dist</span><span class="p">(</span><span class="n">pricesW</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="n">xbarsE_boot</span> <span class="o">=</span> <span class="n">gen_boot_dist</span><span class="p">(</span><span class="n">pricesE</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we compute the difference between means from bootstrap samples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dhats_boot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">xbarsW_boot</span><span class="p">,</span> <span class="n">xbarsE_boot</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">dhats_boot</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="c1"># ax.set_xlabel(&quot;$\hat{d}$&quot;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\widehat</span><span class="si">{D}</span><span class="s2">^*}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/cec800568ded4a1fabba86997a2a7a787ae5a9bd868e31d8ec007138793187f6.png"><img alt="../_images/cec800568ded4a1fabba86997a2a7a787ae5a9bd868e31d8ec007138793187f6.png" src="../_images/cec800568ded4a1fabba86997a2a7a787ae5a9bd868e31d8ec007138793187f6.png" style="width: 849px; height: 274px;" />
</a>
</div>
</div>
<p>We can obtain the bootstrap estimate of the standard error <span class="math notranslate nohighlight">\(\stderrhat{\hat{d}}^*\)</span>
by calculating the standard deviation of the bootstrap distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dhats_boot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5629952099614226
</pre></div>
</div>
</div>
</div>
<p>Note this value is very similar to the value <span class="math notranslate nohighlight">\(\stderrhat{\hat{d}}=0.598\)</span> that we obtained
from the analytical approximation formula.
This shows that the bootstrap procedure is a viable alternative to the calculation based on analytical approximations.</p>
</section>
</section>
</section>
<section id="alternative-calculation-methods">
<h2>Alternative calculation methods<a class="headerlink" href="#alternative-calculation-methods" title="Link to this heading">#</a></h2>
<section id="using-statsmodels-for-bootstrap-estimation">
<h3>Using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> for bootstrap estimation<a class="headerlink" href="#using-statsmodels-for-bootstrap-estimation" title="Link to this heading">#</a></h3>
<section id="bootstrap-mean">
<h4>Bootstrap mean<a class="headerlink" href="#bootstrap-mean" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">([</span><span class="n">ksample02</span><span class="p">],</span> <span class="n">statistic</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span>
                <span class="n">n_resamples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">bootstrap_distribution</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">bootstrap_distribution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5000
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/136235343f699e92a4694f198399e93e93903f46487e6a605baa0c32b6f5d08f.png"><img alt="../_images/136235343f699e92a4694f198399e93e93903f46487e6a605baa0c32b6f5d08f.png" src="../_images/136235343f699e92a4694f198399e93e93903f46487e6a605baa0c32b6f5d08f.png" style="width: 848px; height: 274px;" />
</a>
</div>
</div>
<p>We can obtain bootstrap distribution of the variance
by simply changing the argument <code class="docutils literal notranslate"><span class="pre">statistic=var</span></code>.
See Exercise E3.16.</p>
</section>
<section id="bootstrap-difference-between-mean">
<h4>Bootstrap difference between mean<a class="headerlink" href="#bootstrap-difference-between-mean" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># two-sample test `scipy.stats`</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">([</span><span class="n">pricesW</span><span class="p">,</span> <span class="n">pricesE</span><span class="p">],</span> <span class="n">statistic</span><span class="o">=</span><span class="n">dmeans</span><span class="p">,</span>
                <span class="n">n_resamples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">bootstrap_distribution</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">bootstrap_distribution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5000
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/576292fa8566a7991503449e0d782097e9fb2778a45c6e74160fd719d0b896c1.png"><img alt="../_images/576292fa8566a7991503449e0d782097e9fb2778a45c6e74160fd719d0b896c1.png" src="../_images/576292fa8566a7991503449e0d782097e9fb2778a45c6e74160fd719d0b896c1.png" style="width: 848px; height: 274px;" />
</a>
</div>
</div>
</section>
</section>
</section>
<section id="explanations">
<h2>Explanations<a class="headerlink" href="#explanations" title="Link to this heading">#</a></h2>
<section id="biased-and-unbiased-estimators-for-the-population-variance">
<h3>Biased and unbiased estimators for the population variance<a class="headerlink" href="#biased-and-unbiased-estimators-for-the-population-variance" title="Link to this heading">#</a></h3>
<p>The sample variance estimator
<span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \overline{\mathbf{x}})^2\)</span>
is an <em>unbiased</em> estimator of the population variance.</p>
<p>Let’s see what happens if we the estimator
<span class="math notranslate nohighlight">\(\tilde{s}_{\mathbf{x}}^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \overline{x})^2\)</span>,
which has denominator <span class="math notranslate nohighlight">\(n\)</span> instead of <span class="math notranslate nohighlight">\((n-1)\)</span>.</p>
<p>First, let’s define the Python function <code class="docutils literal notranslate"><span class="pre">altvar</span></code> that performs this calculation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">altvar</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="n">xbar</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">sumsqdevs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">xi</span><span class="o">-</span><span class="n">xbar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">sumsqdevs</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
<span class="n">muK</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sigmaK</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">rvK</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">muK</span><span class="p">,</span> <span class="n">sigmaK</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">altvars</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">altvar</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">altvars</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\tilde</span><span class="si">{s}</span><span class="s2">^2_{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/4b134b16e46cdad331adbb9f84b77c1e8e2b3c7692d4eafbd4f8ff5333dda517.png"><img alt="../_images/4b134b16e46cdad331adbb9f84b77c1e8e2b3c7692d4eafbd4f8ff5333dda517.png" src="../_images/4b134b16e46cdad331adbb9f84b77c1e8e2b3c7692d4eafbd4f8ff5333dda517.png" style="width: 860px; height: 297px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># E[simulated]     # population var    </span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">altvars</span><span class="p">),</span>  <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(95.28131350335453, 100)
</pre></div>
</div>
</div>
</div>
<p>The expected value of the sampling distribution for this estimator does not equal the population variance, <span class="math notranslate nohighlight">\(\mathbb{E}[\tilde{S}^2] \neq \sigma_K^2 = 100\)</span>.
The expected value <span class="math notranslate nohighlight">\(\mathbb{E}[\tilde{S}^2]\)</span> will consistently underestimate <span class="math notranslate nohighlight">\(\sigma_K^2\)</span>.</p>
<p>We can correct the bias in this estimator by simply using the normalization factor
<span class="math notranslate nohighlight">\((n-1)\)</span> in the formula instead of <span class="math notranslate nohighlight">\(n\)</span>. This is how we end up with the unbiased estimator
formula <span class="math notranslate nohighlight">\(s_{\mathbf{x}}^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \overline{\mathbf{x}})^2\)</span>,
for which <span class="math notranslate nohighlight">\(\mathbb{E}[S_{\mathbf{K}}^2] \approx \sigma_K^2 = 100\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>
<span class="n">kvars20</span> <span class="o">=</span> <span class="n">gen_sampling_dist</span><span class="p">(</span><span class="n">rvK</span><span class="p">,</span> <span class="n">estfunc</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># E[simulated]      # population var</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">kvars20</span><span class="p">),</span>   <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(99.91922831464034, 100)
</pre></div>
</div>
</div>
</div>
</section>
<section id="pivotal-quantities">
<h3>Pivotal quantities<a class="headerlink" href="#pivotal-quantities" title="Link to this heading">#</a></h3>
<p>Rephrase analytical approximations in terms of standard reference distributions, thanks to pivot transformation</p>
<div class="math notranslate nohighlight">
\[
  Y \;\; = \;\; \texttt{scale} \cdot X \; + \; \texttt{loc}.
\]</div>
<div class="math notranslate nohighlight">
\[
  X \;\; = \;\; \frac{ Y - \texttt{loc} }{ \texttt{scale} }
\]</div>
<p>We say <span class="math notranslate nohighlight">\(X\)</span> is a pivotal quantity.</p>
<div class="math notranslate nohighlight">
\[
 F_Y(y) = F_X\left(  \frac{ y - \texttt{loc} }{ \texttt{scale} }  \right)
 \quad \text{and} \quad
 f_Y(y) = \frac{1}{\texttt{scale}} \cdot f_X\left(\frac{y-\texttt{loc}}{\texttt{scale}} \right).
\]</div>
<p>Recall the distribution for mean of kombucha volume modelled as <code class="docutils literal notranslate"><span class="pre">rvTKbar</span></code>,
and corresponds to the custom <span class="math notranslate nohighlight">\(t\)</span>-distribution:
<span class="math notranslate nohighlight">\(T_{\overline{\mathbf{K}}}
  \;\;\; = \;\;\;
  \stderrhat{\overline{\mathbf{k}}} \cdot \mathcal{T}(6)  \; + \; \mu_K\)</span>.</p>
<p>We can also get the same results using the standard <span class="math notranslate nohighlight">\(t\)</span>-distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span> <span class="k">as</span> <span class="n">tdist</span>
<span class="n">rvT</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">7</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvTKbar</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">rvT</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">*</span><span class="n">sehat03</span> <span class="o">+</span> <span class="n">muK</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1006.2571694068641, 1006.2571694068641)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvTKbar</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1003</span><span class="p">),</span> <span class="n">rvT</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span> <span class="p">(</span><span class="mi">1003</span><span class="o">-</span><span class="n">muK</span><span class="p">)</span><span class="o">/</span><span class="n">sehat03</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.8062670118096588, 0.8062670118096588)
</pre></div>
</div>
</div>
</div>
<p>Recall the sampling distribution of the variance <code class="docutils literal notranslate"><span class="pre">rvS2</span></code>
with custom scale parameter.
Here are some examples of how we can do calculations using the un-scaled standard chi-square distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2</span>
<span class="n">rvX2</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">20</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale</span> <span class="o">=</span> <span class="n">sigmaK</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">20</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rvS2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">rvX2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">*</span><span class="n">scale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(158.65014318761138, 158.65014318761138)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvS2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">rvX2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">150</span><span class="o">/</span><span class="n">scale</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.9257325359937036, 0.9257325359937036)
</pre></div>
</div>
</div>
</div>
<p>Recall the sampling distribution of the difference between means <code class="docutils literal notranslate"><span class="pre">rvTDhat</span></code>.
Here are some examples of equivalent calculations using standard <span class="math notranslate nohighlight">\(t\)</span>-distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfD</span> <span class="o">=</span> <span class="n">calcdf</span><span class="p">(</span><span class="n">stdW</span><span class="p">,</span> <span class="n">nW</span><span class="p">,</span> <span class="n">stdE</span><span class="p">,</span> <span class="n">nE</span><span class="p">)</span>
<span class="n">rvT</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">dfD</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvTDhat</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">rvT</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">*</span><span class="n">seD</span> <span class="o">+</span> <span class="n">dhat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4.060342411631854, 4.060342411631854)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvTDhat</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">rvT</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span> <span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">dhat</span><span class="p">)</span><span class="o">/</span><span class="n">seD</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.9406438830093705, 0.9406438830093705)
</pre></div>
</div>
</div>
</div>
</section>
<section id="shifted-sampling-distributions">
<h3>Shifted sampling distributions<a class="headerlink" href="#shifted-sampling-distributions" title="Link to this heading">#</a></h3>
<p>Two contexts for using sampling distribution:</p>
<ul class="simple">
<li><p><strong>Case 1</strong>: the population mean <span class="math notranslate nohighlight">\(\mu_X\)</span> is known. We draw the
sampling distribution centred on the population mean <span class="math notranslate nohighlight">\(\mu_X\)</span>:
$<span class="math notranslate nohighlight">\(T_B
   \;\; \sim \;\;
   \mathcal{T}(n-1, \;
               \tt{loc}\!=\mu_X, \;
               \tt{scale}\!=\!\stderrhat{\overline{\mathbf{x}}}).
\)</span>$</p></li>
<li><p><strong>Case 2</strong>: the population mean <span class="math notranslate nohighlight">\(\mu_X\)</span> is unknown. We can draw the
sampling distribution centred on the sample mean
<span class="math notranslate nohighlight">\(\overline{\mathbf{x}}\)</span>:
$<span class="math notranslate nohighlight">\( T_A
   \;\; \sim \;\;
   \mathcal{T}(n-1, \;
               \tt{loc}\!=\overline{\mathbf{x}}, \;
               \tt{scale}\!=\!\stderrhat{\overline{\mathbf{x}}}).
\)</span>$</p></li>
</ul>
<p>Essentially, the sampling distribution formula we obtained describes the
distribution of the deviations of the sample mean from the population
mean: <span class="math notranslate nohighlight">\(\overline{\mathbf{x}} - \mu_X\)</span>, so this is why we can use the
same distribution in both contexts.</p>
<section id="estimation-of-the-apples-weights">
<h4>Estimation of the apples weights<a class="headerlink" href="#estimation-of-the-apples-weights" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/apples.csv&quot;</span><span class="p">)</span>
<span class="n">asmpale</span> <span class="o">=</span> <span class="n">apples</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">asample</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">abar</span> <span class="o">=</span>  <span class="n">mean</span><span class="p">(</span><span class="n">asample</span><span class="p">)</span>
<span class="n">asehat</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asample</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># analytical approx.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span> <span class="k">as</span> <span class="n">tdist</span>
<span class="n">rvTAbar</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">abar</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">asehat</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvTAbar</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">190</span><span class="p">,</span><span class="mi">215</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu_A$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{A}</span><span class="s2">}}$&quot;</span><span class="p">)</span>

<span class="c1"># sample mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">abar</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>

<span class="c1"># sample mean +/- se</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">abar</span><span class="o">+</span><span class="n">asehat</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">abar</span><span class="o">-</span><span class="n">asehat</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/037835dc274182d5eefd274dfae1049df2ba9c84d0e440a21c21d130857adb58.png"><img alt="../_images/037835dc274182d5eefd274dfae1049df2ba9c84d0e440a21c21d130857adb58.png" src="../_images/037835dc274182d5eefd274dfae1049df2ba9c84d0e440a21c21d130857adb58.png" style="width: 853px; height: 293px;" />
</a>
</div>
</div>
</section>
<section id="kombucha-volume-probabilities">
<h4>Kombucha volume probabilities<a class="headerlink" href="#kombucha-volume-probabilities" title="Link to this heading">#</a></h4>
<p>In <strong>Case P</strong> we know the population mean, and the random variable <span class="math notranslate nohighlight">\(T_B\)</span>
describes what kind of sample means we can expect to observe.
We’ll use this type of reasoning for hypothesis testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kombucha</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/kombucha.csv&quot;</span><span class="p">)</span>
<span class="n">ksample01</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
<span class="n">ksample06</span> <span class="o">=</span> <span class="n">kombucha</span><span class="p">[</span><span class="n">kombucha</span><span class="p">[</span><span class="s2">&quot;batch&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">][</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>

<span class="n">kbar01</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ksample01</span><span class="p">)</span>
<span class="n">kbar06</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ksample06</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ksample01</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># analytical approx.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span> <span class="k">as</span> <span class="n">tdist</span>
<span class="n">rvTKbar</span> <span class="o">=</span> <span class="n">tdist</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">muK</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigmaK</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">rvTKbar</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">993</span><span class="p">,</span><span class="mi">1007</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">blue</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f_{\overline{\mathbf</span><span class="si">{K}</span><span class="s2">}}$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}$&quot;</span><span class="p">)</span>

<span class="c1"># sample mean ksample01</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">kbar01</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">kbar01</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}_</span><span class="si">{01}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="c1"># sample mean ksample06</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">kbar06</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">kbar06</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.31</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\overline{\mathbf</span><span class="si">{k}</span><span class="s2">}_</span><span class="si">{06}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/4d34f7b1419a1b1e7aeb4e98950af7a6580b22422252da2152901c88b2bd437e.png"><img alt="../_images/4d34f7b1419a1b1e7aeb4e98950af7a6580b22422252da2152901c88b2bd437e.png" src="../_images/4d34f7b1419a1b1e7aeb4e98950af7a6580b22422252da2152901c88b2bd437e.png" style="width: 853px; height: 348px;" />
</a>
</div>
</div>
</section>
</section>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h2>
<p>Congratulations on surviving until the end this notebook!
In the remainder of this chapter and the next, we’ll learn
about various applications of the formulas we introduces in this section.
Basically, it’s all downhill from here.</p>
<p>In the next notebook, we’ll learn how to use everything we learned about
sampling distributions to calculate <a class="reference internal" href="32_confidence_intervals.html"><span class="std std-doc">confidence intervals</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstats",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="30_STATS.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 3 — Classical statistics</p>
      </div>
    </a>
    <a class="right-next"
       href="../exercises/exercises_31_estimtors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercises for Section 3.1 Estimates and estimators</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-setup">Notebook setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-sampling-distributions">Applications of sampling distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">Definitions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-data-concepts">Review of data concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-probability-concepts">Review of probability concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-concepts">New concepts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimators">Estimators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-mean-estimator">Sample mean estimator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-variance-and-standard-deviation">Sample variance and standard deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-apple-weight-mean-and-variance">Example 1: apple weight mean and variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-kombucha-volume-mean-and-variance">Example 2: kombucha volume mean and variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-sample-means-estimator">Difference between sample means estimator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-comparison-of-electricity-prices">Example 3: comparison of electricity prices</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distributions">Sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4">Example 4</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration">Illustration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimator-properties">Estimator properties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Illustration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-approach-to-sampling-distributions">Computational approach to sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5-sampling-distributions-of-the-kombucha-volume">Example 5: sampling distributions of the kombucha volume</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-mean">Sampling distribution of the mean</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-distribution-of-the-variance">Sampling distribution of the variance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approximating-sampling-distribution">Approximating sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-estimation">Bootstrap estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#minimal-example">Minimal example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interactive-bootstrap-samples-example">Interactive bootstrap samples example</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-purpose-bootstrap-estimation-function">General-purpose bootstrap estimation function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-6">Example 6</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-approximation-formulas">Analytical approximation formulas</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#central-limit-theorem">Central limit theorem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Sampling distribution of the mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#true-sampling-distribution">True sampling distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-of-the-central-limit-theorem">Prediction of the central limit theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-plug-in-principle">The plug-in principle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-approximation-to-the-sampling-distribution">Normal approximation to the sampling distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-better-approximation">A better approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-sample-mean">Bootstrapped sampling distribution of the sample mean</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Sampling distribution of the variance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Sampling distribution of the variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-sample-variance">Bootstrapped sampling distribution of the sample variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-between-means-estimator">Difference between means estimator</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-formula-for-the-sampling-distribution">Analytical formula for the sampling distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#approximation-using-student-s-t-distribution">Approximation using Student’s <span class="math notranslate nohighlight">\(t\)</span>-distribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-7-difference-between-electricity-prices">Example 7: difference between electricity prices</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-sampling-distribution-of-the-difference-between-means">Bootstrapped sampling distribution of the difference between means</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-calculation-methods">Alternative calculation methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-statsmodels-for-bootstrap-estimation">Using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> for bootstrap estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-mean">Bootstrap mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-difference-between-mean">Bootstrap difference between mean</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanations">Explanations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#biased-and-unbiased-estimators-for-the-population-variance">Biased and unbiased estimators for the population variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pivotal-quantities">Pivotal quantities</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shifted-sampling-distributions">Shifted sampling distributions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimation-of-the-apples-weights">Estimation of the apples weights</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kombucha-volume-probabilities">Kombucha volume probabilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ivan Savov
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>